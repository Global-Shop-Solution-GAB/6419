Program.Sub.ScreenSU.Start
Gui.FormQuote..Create
Gui.FormQuote..Caption("Custom Customer Quote ")
Gui.FormQuote..Size(15360,10770)
Gui.FormQuote..MinX(0)
Gui.FormQuote..MinY(0)
Gui.FormQuote..Position(0,0)
Gui.FormQuote..BackColor(-2147483633)
Gui.FormQuote..MousePointer(0)
Gui.FormQuote..Event(UnLoad,FormQuote_UnLoad)
Gui.FormQuote.txtCust.Create(TextBox,"",True,1650,300,0,210,300,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtCust.Event(GotFocus,txtCust_GotFocus)
Gui.FormQuote.txtCust.Event(LostFocus,txtCust_LostFocus)
Gui.FormQuote.txtCust.Event(KeyPressEnter,txtCust_KeyPressEnter)
Gui.FormQuote.txtCust.MaxLength(6)
Gui.FormQuote.cmdCust.Create(Button)
Gui.FormQuote.cmdCust.Size(405,375)
Gui.FormQuote.cmdCust.Position(1950,270)
Gui.FormQuote.cmdCust.Caption("^")
Gui.FormQuote.cmdCust.Event(Click,cmdCust_Click)
Gui.FormQuote.lblCust.Create(Label,"Customer",True,1935,255,0,210,90,True,0,"Arial",8,-2147483633,0)
Gui.FormQuote.ddlState.Create(ComboBox)
Gui.FormQuote.ddlState.Size(690,330)
Gui.FormQuote.ddlState.Position(2445,300)
Gui.FormQuote.ddlState.Event(LostFocus,ddlState_Change)
Gui.FormQuote.cmdGen.Create(Button)
Gui.FormQuote.cmdGen.Size(2220,375)
Gui.FormQuote.cmdGen.Position(3210,270)
Gui.FormQuote.cmdGen.Caption("Generate Custom Quote #")
Gui.FormQuote.cmdGen.Event(Click,cmdGen_Click)
Gui.FormQuote.lblState.Create(Label,"State",True,885,255,0,2415,75,True,0,"Arial",8,-2147483633,0)
Gui.FormQuote.txtCustQuote.Create(TextBox,"",True,1500,300,0,5550,330,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtCustQuote.Event(GotFocus,txtCustQuote_GotFocus)
Gui.FormQuote.txtCustQuote.Event(LostFocus,txtCustQuote_LostFocus)
Gui.FormQuote.txtCustQuote.Event(KeyPressEnter,txtCustQuote_KeyPressEnter)
Gui.FormQuote.txtCustQuote.MaxLength(7)
Gui.FormQuote.cmdQuote.Create(Button)
Gui.FormQuote.cmdQuote.Size(405,375)
Gui.FormQuote.cmdQuote.Position(7110,285)
Gui.FormQuote.cmdQuote.Caption("^")
Gui.FormQuote.cmdQuote.Event(Click,cmdQuote_Click)
Gui.FormQuote.lblQuote.Create(Label,"Custom Quote #",True,1935,255,0,5520,105,True,0,"Arial",8,-2147483633,0)
Gui.FormQuote.ddlRouter.Create(DropDownList)
Gui.FormQuote.ddlRouter.Size(2235,330)
Gui.FormQuote.ddlRouter.Position(7590,330)
Gui.FormQuote.ddlRouter.Event(Change,ddlRouter_Change)
Gui.FormQuote.lblRouter.Create(Label,"Router",True,1935,255,0,7590,105,True,0,"Arial",8,-2147483633,0)
Gui.FormQuote.lblLines.Create(Label,"Number of Lines",True,1305,255,0,10320,75,True,0,"Arial",8,-2147483633,0)
Gui.FormQuote.txtLines.Create(TextBox,"",True,750,300,0,10395,345,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtLines.NumericOnly(2)
Gui.FormQuote.txtLines.Event(GotFocus,txtLines_GotFocus)
Gui.FormQuote.txtLines.DefaultValue("0")
Gui.FormQuote.cmdAdd.Create(Button)
Gui.FormQuote.cmdAdd.Size(1095,375)
Gui.FormQuote.cmdAdd.Position(11280,285)
Gui.FormQuote.cmdAdd.Caption("Add Lines")
Gui.FormQuote.cmdAdd.Event(Click,cmdAdd_Click)
Gui.FormQuote.optV.Create(Option)
Gui.FormQuote.optV.Size(780,255)
Gui.FormQuote.optV.Position(11640,15)
Gui.FormQuote.optV.Caption("View")
Gui.FormQuote.optE.Create(Option)
Gui.FormQuote.optE.Size(690,255)
Gui.FormQuote.optE.Position(12465,15)
Gui.FormQuote.optE.Caption("Edit")
Gui.FormQuote.optC.Create(Option)
Gui.FormQuote.optC.Size(780,255)
Gui.FormQuote.optC.Position(13185,15)
Gui.FormQuote.optC.Caption("Copy")
Gui.FormQuote.cmdLRout.Create(Button)
Gui.FormQuote.cmdLRout.Size(1320,375)
Gui.FormQuote.cmdLRout.Position(12465,285)
Gui.FormQuote.cmdLRout.Caption("Luanch Router")
Gui.FormQuote.cmdLRout.Event(Click,cmdLRout_Click)
Gui.FormQuote.GsGridQuote.Create(GsGridControl)
Gui.FormQuote.GsGridQuote.Size(14835,8115)
Gui.FormQuote.GsGridQuote.Position(210,1110)
Gui.FormQuote.GsGridQuote.Anchor(15)
Gui.FormQuote.GsGridQuote.Event(RowCellClick,GsGridQuote_RowCellClick)
Gui.FormQuote.GsGridQuote.Event(CellValueChanged,GsGridQuote_CellValueChanged)
Gui.FormQuote.lblUser1.Create(Label,"User 1:",True,1050,255,0,45,9480,True,1,"Arial",8,-2147483633,0)
Gui.FormQuote.lblUser1.Anchor(6)
Gui.FormQuote.txtUser1.Create(TextBox,"",True,2445,300,0,1095,9390,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtUser1.Anchor(6)
Gui.FormQuote.txtUser1.Event(GotFocus,txtUser1_GotFocus)
Gui.FormQuote.txtUser1.MaxLength(30)
Gui.FormQuote.cmdUser1.Create(Button)
Gui.FormQuote.cmdUser1.Size(405,375)
Gui.FormQuote.cmdUser1.Position(3600,9360)
Gui.FormQuote.cmdUser1.Anchor(6)
Gui.FormQuote.cmdUser1.Caption("^")
Gui.FormQuote.cmdUser1.Event(Click,cmdUser1_Click)
Gui.FormQuote.lblUser3.Create(Label,"User 3:",True,1110,255,0,4050,9480,True,1,"Arial",8,-2147483633,0)
Gui.FormQuote.lblUser3.Anchor(6)
Gui.FormQuote.txtUser3.Create(TextBox,"",True,2445,300,0,5175,9390,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtUser3.Anchor(6)
Gui.FormQuote.txtUser3.Event(GotFocus,txtUser3_GotFocus)
Gui.FormQuote.txtUser3.MaxLength(30)
Gui.FormQuote.cmdUser3.Create(Button)
Gui.FormQuote.cmdUser3.Size(405,375)
Gui.FormQuote.cmdUser3.Position(7650,9360)
Gui.FormQuote.cmdUser3.Caption("^")
Gui.FormQuote.cmdUser3.Event(Click,cmdUser3_Click)
Gui.FormQuote.cmdUser3.Anchor(6)
Gui.FormQuote.lblUser4.Create(Label,"User 4:",True,1110,255,0,8130,9480,True,1,"Arial",8,-2147483633,0)
Gui.FormQuote.lblUser4.Anchor(6)
Gui.FormQuote.txtUser4.Create(TextBox,"",True,2445,300,0,9270,9390,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtUser4.Anchor(6)
Gui.FormQuote.txtUser4.Event(GotFocus,txtUser4_GotFocus)
Gui.FormQuote.txtUser4.MaxLength(30)
Gui.FormQuote.cmdUser4.Create(Button)
Gui.FormQuote.cmdUser4.Size(405,375)
Gui.FormQuote.cmdUser4.Position(11745,9360)
Gui.FormQuote.cmdUser4.Caption("^")
Gui.FormQuote.cmdUser4.Event(Click,cmdUser4_Click)
Gui.FormQuote.cmdUser4.Anchor(6)
Gui.FormQuote.lblUser5.Create(Label,"User 5:",True,1110,255,0,2205,9900,True,1,"Arial",8,-2147483633,0)
Gui.FormQuote.lblUser5.Anchor(6)
Gui.FormQuote.txtUser5.Create(TextBox,"",True,2445,300,0,3360,9810,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtUser5.Anchor(6)
Gui.FormQuote.txtUser5.Event(GotFocus,txtUser5_GotFocus)
Gui.FormQuote.txtUser5.MaxLength(30)
Gui.FormQuote.cmdUser5.Create(Button)
Gui.FormQuote.cmdUser5.Size(405,375)
Gui.FormQuote.cmdUser5.Position(5850,9780)
Gui.FormQuote.cmdUser5.Caption("^")
Gui.FormQuote.cmdUser5.Event(Click,cmdUser5_Click)
Gui.FormQuote.cmdUser5.Anchor(6)
Gui.FormQuote.cmdSave.Create(Button)
Gui.FormQuote.cmdSave.Size(855,375)
Gui.FormQuote.cmdSave.Position(135,9780)
Gui.FormQuote.cmdSave.Anchor(6)
Gui.FormQuote.cmdSave.Caption("Save")
Gui.FormQuote.cmdSave.Event(Click,cmdSave_Click)
Gui.FormQuote.cmdExport.Create(Button)
Gui.FormQuote.cmdExport.Size(855,375)
Gui.FormQuote.cmdExport.Position(1080,9780)
Gui.FormQuote.cmdExport.Anchor(6)
Gui.FormQuote.cmdExport.Caption("Export")
Gui.FormQuote.cmdExport.Event(Click,cmdExport_Click)
Gui.FormQuote.lblCustPO.Create(Label,"Customer PO/Reference:",True,2010,255,0,7245,9900,True,1,"Arial",8,-2147483633,0)
Gui.FormQuote.lblCustPO.Anchor(6)
Gui.FormQuote.txtCustPO.Create(TextBox,"",True,2865,300,0,9285,9810,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtCustPO.Anchor(6)
Gui.FormQuote.txtCustPO.MaxLength(15)
Gui.FormQuote.dtpDueDate.Create(DatePicker)
Gui.FormQuote.dtpDueDate.Size(1935,285)
Gui.FormQuote.dtpDueDate.Position(13095,9375)
Gui.FormQuote.dtpDueDate.Anchor(6)
Gui.FormQuote.cmdCreate.Create(Button)
Gui.FormQuote.cmdCreate.Size(2595,375)
Gui.FormQuote.cmdCreate.Position(12390,9780)
Gui.FormQuote.cmdCreate.Caption("Create Sales Order/Work Order")
Gui.FormQuote.cmdCreate.Event(Click,cmdCreate_Click)
Gui.FormQuote.cmdCreate.Anchor(6)
Gui.FormQuote.lbl1.Create(Label,"Due Date",True,855,255,0,12180,9465,True,1,"Arial",8,-2147483633,0)
Gui.FormQuote.lbl1.Anchor(6)
Gui.FormQuote.cmdGenQuote.Create(Button)
Gui.FormQuote.cmdGenQuote.Size(1200,375)
Gui.FormQuote.cmdGenQuote.Position(13845,285)
Gui.FormQuote.cmdGenQuote.Caption("Quick Quote")
Gui.FormQuote.cmdGenQuote.Event(Click,cmdGenQuote_Click)
Gui.FormQuote.lblQQ.Create(Label,"QQ",True,1035,255,0,14010,75,True,1,"Arial",8,-2147483633,0)
Gui.FormQuote.cmdRout.Create(Button)
Gui.FormQuote.cmdRout.Size(405,375)
Gui.FormQuote.cmdRout.Position(9900,300)
Gui.FormQuote.cmdRout.Caption("^")
Gui.FormQuote.cmdRout.Event(Click,cmdRout_Click)
Gui.FormQuote.txtOldMat.Create(TextBox,"",True,2340,300,0,4515,750,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtOldMat.Anchor(9)
Gui.FormQuote.lblOldMat.Create(Label,"Material",True,810,255,0,3705,840,True,0,"Arial",8,-2147483633,0)
Gui.FormQuote.lblOldMat.Anchor(9)
Gui.FormQuote.cmdOldMat.Create(Button)
Gui.FormQuote.cmdOldMat.Size(405,375)
Gui.FormQuote.cmdOldMat.Position(6900,720)
Gui.FormQuote.cmdOldMat.Anchor(9)
Gui.FormQuote.cmdOldMat.Caption("^")
Gui.FormQuote.cmdOldMat.Event(Click,cmdOldMat_Click)
Gui.FormQuote.lblNewMat.Create(Label,"New Material",True,1125,255,0,7425,840,True,0,"Arial",8,-2147483633,0)
Gui.FormQuote.lblNewMat.Anchor(9)
Gui.FormQuote.txtNewMat.Create(TextBox,"",True,2340,300,0,8580,750,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtNewMat.Anchor(9)
Gui.FormQuote.txtNewMat.Locked(True)
Gui.FormQuote.cmdNewMat.Create(Button)
Gui.FormQuote.cmdNewMat.Size(405,375)
Gui.FormQuote.cmdNewMat.Position(10980,720)
Gui.FormQuote.cmdNewMat.Anchor(9)
Gui.FormQuote.cmdNewMat.Caption("^")
Gui.FormQuote.cmdNewMat.Event(Click,cmdNewMat_Click)
Gui.FormQuote.lblSF.Create(Label,"Sq Ft",False,585,255,0,11460,840,True,0,"Arial",8,-2147483633,0)
Gui.FormQuote.lblSF.Anchor(9)
Gui.FormQuote.txtSF.Create(TextBox,"",False,1320,300,0,12075,750,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtSF.Anchor(9)
Gui.FormQuote.txtSF.NumericOnly(1)
Gui.FormQuote.txtSF.Event(GotFocus,txtSF_GotFocus)
Gui.FormQuote.cmdUpMat.Create(Button)
Gui.FormQuote.cmdUpMat.Size(1590,375)
Gui.FormQuote.cmdUpMat.Position(13455,720)
Gui.FormQuote.cmdUpMat.Anchor(9)
Gui.FormQuote.cmdUpMat.Caption("Update Material")
Gui.FormQuote.cmdUpMat.Event(Click,cmdUpMat_Click)
Gui.FormRouter..Create
Gui.FormRouter..Caption("Commit User Fields to Other Routers")
Gui.FormRouter..Size(15360,10695)
Gui.FormRouter..MinX(0)
Gui.FormRouter..MinY(0)
Gui.FormRouter..Position(0,0)
Gui.FormRouter..BackColor(-2147483633)
Gui.FormRouter..MousePointer(0)
Gui.FormRouter..Event(UnLoad,FormRouter_UnLoad)
Gui.FormRouter.GsGridUserFields.Create(GsGridControl)
Gui.FormRouter.GsGridUserFields.Size(8775,9195)
Gui.FormRouter.GsGridUserFields.Position(90,450)
Gui.FormRouter.GsGridUserFields.Anchor(15)
Gui.FormRouter.GsGridRouter.Create(GsGridControl)
Gui.FormRouter.GsGridRouter.Size(5835,9195)
Gui.FormRouter.GsGridRouter.Position(9135,450)
Gui.FormRouter.GsGridRouter.Anchor(11)
Gui.FormRouter.lblUserFields.Create(Label,"Router User Fields ",True,2220,255,0,120,150,True,0,"Arial",10,-2147483633,0)
Gui.FormRouter.lblRouters.Create(Label,"Routers",True,2220,255,0,9135,135,True,0,"Arial",10,-2147483633,0)
Gui.FormRouter.cmdCommit.Create(Button)
Gui.FormRouter.cmdCommit.Size(1590,375)
Gui.FormRouter.cmdCommit.Position(105,9720)
Gui.FormRouter.cmdCommit.Caption("Commit Changes")
Gui.FormRouter.cmdCommit.Event(Click,cmdCommit_Click)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
Program.External.Include.Library("ORDUPL.lib")
Program.External.Include.Library("400000.lib")
Program.External.Include.Library("251000.lib")
Program.External.Include.Library("200000.lib")
V.Global.bEditable.Declare(Boolean,True)
V.Global.sPrevQuote.Declare(String,"-1")
V.Global.bSave.Declare(Boolean,False)
V.Global.bError.Declare(Boolean,False)
V.Global.iCopyIndex.Declare(Long,-1)
Program.Sub.Preflight.End

Program.Sub.Main.Start
F.Intrinsic.Control.SetErrorHandler("Main_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.lblQQ.Caption(" ")
Gui.FormQuote.optV.Value(1)

Gui.FormQuote.txtLines.Text("0")

'creating context menu
F.Intrinsic.Control.CallSub(Create_ContextMenu)
'getting data
F.Intrinsic.Control.CallSub(Get_Data)
'setting grid properties
F.Intrinsic.Control.CallSub(Set_Properties)

Gui.FormQuote..Show

Gui.FormQuote..AlwaysOnTop(True)
Gui.FormQuote..AlwaysOnTop(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Main_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Main.End

Program.Sub.FormQuote_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("FormQuote_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")

'clearing lock for user
F.Intrinsic.Control.If(V.Global.sPrevQuote.Trim,<>,"")
	F.Intrinsic.Control.Try
		F.ODBC.Connection!Con.OpenCompanyConnection
	F.Intrinsic.Control.Catch
	F.Intrinsic.Control.EndTry
	F.Intrinsic.String.Build("Delete From GCG_6419_C_Qte_Lock Where Cust_Quote = '{0}' and User_ID = '{1}'",V.Global.sPrevQuote.Trim,V.Caller.User,V.Local.sSql)
	F.ODBC.Connection!con.Execute(V.Local.sSql)
	F.ODBC.Connection!Con.Close
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.CallSub(Serialize, "FORM", "FormQuote", "GRIDCONTROL", "GsGridQuote", "GRIDVIEW", "GQuote", "REGID", 6419)

F.Intrinsic.Control.If(V.Global.bError)
	F.Intrinsic.Control.If(V.DataTable.Quote.Exists)
		F.Intrinsic.Control.If(V.DataTable.Quote.RowCount--,<>,-1)
			F.Intrinsic.Control.CallSub(cmdSave_Click)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.End

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormQuote_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.End
Function.Intrinsic.Control.EndIf
Program.Sub.FormQuote_UnLoad.End

Program.Sub.cmdCreate_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdCreate_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sDueDate.Declare(String,"")
V.Local.sOrderDate.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.sWOFile.Declare(String,"")
V.Local.sDate.Declare(String,"")
V.Local.sFile.Declare(String,"")
V.Local.sLocal.Declare(String,"")
V.Local.sData.Declare(String,"")
V.Local.iC.Declare(Long,0)
V.Local.sFilter.Declare(String,"")
V.Local.fSF.Declare(Float,0)
V.Local.fTSF.Declare(Float,0)
V.Local.fSFExt.Declare(Float,0)
V.Local.fTemp.Declare(Float,0)
V.Local.sQty.Declare(String,"")
V.Local.sCost.Declare(String,"")
V.Local.fUnit.Declare(Float,0)
V.Local.sUser1.Declare(String,"")
V.Local.sUser3.Declare(String,"")
V.Local.sUser4.Declare(String,"")
V.Local.sUser5.Declare(String,"")
V.Local.sMsg.Declare(String,"")
V.Local.sTemp.Declare(STring,"")
V.Local.fEachQty.Declare(Float,0)
V.Local.sPart.Declare(String,"")
V.Local.sRev.Declare(String,"")
V.Local.iRem.Declare(Long,0)
V.Local.bSave.Declare(Boolean,False)
V.Local.sDescription.Declare(String,"")
V.Local.sLine.Declare(String,"")
V.Local.fASQty.Declare(Float,0)
V.Local.sStiff3.Declare(String,"")
V.Local.bSkip.Declare(Boolean,False)
V.Local.fEst.Declare(Float,0)

'making sure users fields are filled out before creating so and wo's
V.Local.sUser1.Set(V.Screen.FormQuote!txtUser1.Text)
V.Local.sUser3.Set(V.Screen.FormQuote!txtUser3.Text)
V.Local.sUser4.Set(V.Screen.FormQuote!txtUser4.Text)
V.Local.sUser5.Set(V.Screen.FormQuote!txtUser5.Text)

F.Data.DataView.Create("Quote","GCheck",22,"trim(GROUP_DESC) = '' or trim(Group_Name) = ''","")

F.Intrinsic.Control.If(V.Local.sUser1.Trim,=,"")
	F.Intrinsic.String.Build("{0} must be filled in.",V.Screen.FormQuote!lblUser1.Caption,V.Local.sTemp)
	V.Local.sMsg.Set(V.Local.sTemp)
F.Intrinsic.Control.ElseIf(V.Local.sUser3.Trim,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		F.Intrinsic.String.Build("{0} must be filled in.",V.Screen.FormQuote!lblUser3.Caption,V.Local.sTemp)
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}{1}{2} must be filled in.",V.Local.sMsg,V.Ambient.NewLine,V.Screen.FormQuote!lblUser3.Caption,V.Local.sTemp)
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.ElseIf(V.Local.sUser4.Trim,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		F.Intrinsic.String.Build("{0} must be filled in.",V.Screen.FormQuote!lblUser4.Caption,V.Local.sTemp)
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}{1}{2} must be filled in.",V.Local.sMsg,V.Ambient.NewLine,V.Screen.FormQuote!lblUser4.Caption,V.Local.sTemp)
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.ElseIf(V.Local.sUser5.Trim,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		F.Intrinsic.String.Build("{0} must be filled in.",V.Screen.FormQuote!lblUser5.Caption,V.Local.sTemp)
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}{1}{2} must be filled in.",V.Local.sMsg,V.Ambient.NewLine,V.Screen.FormQuote!lblUser5.Caption,V.Local.sTemp)
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.ElseIf(V.DataView.Quote!GCheck.RowCount--,<>,-1)
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sTemp.Set("Group Name and Group Description must be filled in for all lines.")
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}{1}Group and Group Description must be filled in for all lines.",V.Local.sMsg,V.Ambient.NewLine,V.Local.sTemp)
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("Quote","GCheck")

F.Data.DataView.Create("Quote","MCheck",22,"(trim(User48) <> '' and (trim(User49) = '' or User49 is null)) Or (trim(User50) <> '' and (trim(User51) = '' or User51 is null)) Or (trim(User52) <> '' and (trim(User53) = '' or User53 is null)) Or (trim(User54) <> '' and (trim(User55) = '' or User55 is null)) Or (trim(User56) <> '' and (trim(User57) = '' or User57 is null)) Or (trim(User58) <> '' and (trim(User59) = '' or User59 is null))","")
F.Intrinsic.Control.If(V.DataView.Quote!MCheck.RowCount--,<>,-1)
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sMsg.Set("There are Material Qty Missing")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}{1}There are Material Qty Missing",V.Local.sMsg,V.Ambient.NewLine,V.Local.sTemp)
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf
F.Data.DataView.Close("Quote","MCheck")

F.Intrinsic.Control.If(V.Local.sMsg.Trim,<>,"")
	F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Attention")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

'formating dates for so creating
F.Intrinsic.String.Format(V.Screen.FormQuote!dtpDueDate.Value,"YYYYMMDD",V.Local.sDueDate)
F.Intrinsic.String.Format(V.Ambient.Date,"YYYYMMDD",V.Local.sOrderDate)

Gui.FormQuote..Enabled(False)

F.ODBC.Connection!Con.OpenCompanyConnection

F.Intrinsic.UI.InvokeWaitDialog("Creating Sales Order.........................")

'getting custom ship to 
F.Intrinsic.String.Build("Select Name_Customer_Ship, Address1_Ship, Address2_Ship, City_Ship, State_Ship, Code_Zip_Ship From V_Customer_ShipTo Where Customer = '{0}'",V.Screen.FormQuote!txtCust.Text,V.Local.sSql)
F.Intrinsic.Control.If(V.DataTable.Cust.Exists)
	F.Data.DataTable.Close("Cust")
F.Intrinsic.Control.EndIf

F.Data.DataTable.CreateFromSQL("Cust","con",V.Local.sSql,True)
F.Data.DataTable.AddRow("ORDUPL","Transaction","O","CustomerNO",V.Screen.FormQuote!txtCust.Text,"OrderDueDate",V.Local.sDueDate,"OrderDate",V.Local.sOrderDate,"CustomerPO",V.Screen.FormQuote!txtCustPO.Text,"SHIPToName",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Name_Customer_Ship!FieldValTrim,"ShipToAddress1",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Address1_Ship!FieldValTrim,"ShipToAddress2",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Address2_Ship!FieldValTrim,"ShipToCity",V.DataTable.Cust(V.DataTable.Cust.RowCount--).City_Ship!FieldValTrim,"ShipToState",V.DataTable.Cust(V.DataTable.Cust.RowCount--).State_Ship!FieldValTrim,"ShipToZip",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Code_Zip_Ship!FieldValTrim,"UserField1Head",V.Local.sUser1.Trim,"UserField3Head",V.Local.sUser3.Trim,"UserField4Head",V.Local.sUser4.Trim,"UserField5Head",V.Local.sUser5.Trim)

'making sure sf is entered 
F.Data.DataView.Create("Quote","TempSF",22,"TOTL_SF is null or TOTL_SF <= 0","")
F.Intrinsic.Control.If(V.DataView.Quote!TempSF.RowCount--,<>,-1)
	F.Intrinsic.UI.Msgbox("Total SF needs to be filled out for each sign and be > 0","Attention")
	F.Data.DataView.Close("Quote","TempSF")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
F.Data.DataView.Close("Quote","TempSF")
'checking on line qty if filled out 
F.Data.DataView.Create("Quote","TempUnit",22,"Unit is null or Unit <= 0","")
F.Intrinsic.Control.If(V.DataView.Quote!TempUnit.RowCount--,<>,-1)
	F.Intrinsic.UI.Msgbox("Units needs to be filled out for each sign and be > 0","Attention")
	F.Data.DataView.Close("Quote","TempUnit")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
F.Data.DataView.Close("Quote","TempUnit")

F.Data.DataView.Create("Quote","Temp",22,"","")
F.Intrinsic.Control.If(V.DataTable.Temp.Exists)
	F.Data.DataTable.Close("Temp")
F.Intrinsic.Control.EndIf

F.Data.DataView.ToDataTableDistinct("Quote","Temp","Temp","Group_No*!*UM",True)
F.Data.DataView.Close("Quote","Temp")
F.Data.DataView.Create("Temp","VTemp",22,"UM = 'SF'","")
F.Intrinsic.Control.For(V.Local.i,0,V.DataView.Temp!VTemp.RowCount--,1)
	F.Intrinsic.String.Build("Group_No = '{0}'",V.DataView.Temp!VTemp(V.Local.i).Group_No!FieldVal,V.Local.sFilter)
	F.Data.DataView.Create("Quote","Temp",22,V.Local.sFilter,"")
	V.Local.fSFExt.Set(0)
	V.Local.fTSF.Set(0)
	F.Intrinsic.Control.For(V.Local.iC,0,V.DataView.Quote!Temp.RowCount--,1)
		V.Local.sRev.Set("")
		F.Intrinsic.Math.Add(V.DataView.Quote!Temp(V.Local.iC).TOTL_SF!FieldVal,V.Local.fTSF,V.Local.fTSF)
		F.Intrinsic.Math.Mult(V.DataView.Quote!Temp(V.Local.iC).SF_PRICE!FieldVal,V.DataView.Quote!Temp(V.Local.iC).TOTL_SF!FieldVal,V.Local.fTemp)
		F.Intrinsic.Math.Div(V.Local.fTemp,V.DataView.Quote!Temp(V.Local.iC).Unit!FieldVal,V.Local.fUnit)
		F.Intrinsic.Math.Add(V.Local.fTemp,V.Local.fSFExt,V.Local.fSFExt)
'		F.Intrinsic.Math.Mult(V.DataView.Quote!Temp(V.Local.iC).Unit!FieldVal,10000,V.Local.sQty.Long)
		F.Intrinsic.Math.Mult(V.DataView.Quote!Temp(V.Local.iC).TOTL_SF!FieldVal,10000,V.Local.sQty.Long)
		F.Intrinsic.String.Format(V.DataView.Quote!Temp(V.Local.iC).SF_PRICE!FieldVal,"0.0000",V.Local.sCost)
		F.Intrinsic.Math.Mult(V.Local.sCost.Float,1000000,V.Local.sCost)
		F.Intrinsic.String.LPad(V.Local.sQty,"0",13,V.Local.sQty)
		F.Intrinsic.String.LPad(V.Local.sCost,"0",13,V.Local.sCost)
		V.Local.sPart.Set(V.DataView.Quote!Temp(V.Local.iC).Sign_Router!FieldValTrim)
		F.Intrinsic.Control.If(V.Local.sPart.Length,>,17)
			F.Intrinsic.Math.Sub(V.Local.sPart.Length,17,V.Local.iRem)
			F.Intrinsic.String.Right(V.Local.sPart,V.Local.iRem,V.Local.sRev)
			F.Intrinsic.String.Left(V.Local.sPart,17,V.Local.sPart)
		F.Intrinsic.Control.EndIf
		'adding so lines to sales order, these are the so line that is used for creating wo's
		F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","SF","PartNumber",V.Local.sPart,"PartRev",V.Local.sRev,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.Local.iC).MESSAGE!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL",V.DataView.Quote!Temp(V.Local.iC).PL!FieldVal,"UserField1","","UserField5",V.DataView.Quote!Temp(V.Local.iC).Line_Item!FieldVal,"Router",V.DataView.Quote!Temp(V.Local.iC).Sign_Router!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
		F.Intrinsic.Control.If(V.Local.iC,=,V.DataView.Quote!Temp.RowCount--)
			F.Intrinsic.Math.Div(V.Local.fSFExt,V.Local.fTSF,V.Local.fSF)
			F.Intrinsic.Math.Mult(V.Local.fTSF,10000,V.Local.sQty)
			F.Intrinsic.String.Format(V.Local.fSF,"0.0000",V.Local.sCost)
			F.Intrinsic.Math.Mult(V.Local.sCost.Float,1000000,V.Local.sCost)
			F.Intrinsic.String.LPad(V.Local.sQty,"0",13,V.Local.sQty)
			F.Intrinsic.String.LPad(V.Local.sCost,"0",13,V.Local.sCost)
			'adding total sf for signs within a same group these are the lines that will be invoiced.
			F.Intrinsic.Control.If(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"FX")
				F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","SF","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","FS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
			F.Intrinsic.Control.ElseIf(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"GX")
				F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","SF","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","GS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
			F.Intrinsic.Control.ElseIf(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"OX")
				F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","SF","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","OS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
			F.Intrinsic.Control.Else
				F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","SF","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iC)
	F.Data.DataView.Close("Quote","Temp")
F.Intrinsic.Control.Next(V.Local.i)
F.Data.DataView.Close("Temp","VTemp")

F.Data.DataView.Create("Temp","VTemp",22,"UM = 'EA'","")
F.Intrinsic.Control.For(V.Local.i,0,V.DataView.Temp!VTemp.RowCount--,1)
	F.Intrinsic.String.Build("Group_No = '{0}'",V.DataView.Temp!VTemp(V.Local.i).Group_No!FieldVal,V.Local.sFilter)
	F.Data.DataView.Create("Quote","Temp",22,V.Local.sFilter,"")
	V.Local.fSFExt.Set(0)
	V.Local.fTSF.Set(0)
	F.Intrinsic.Control.For(V.Local.iC,0,V.DataView.Quote!Temp.RowCount--,1)
		V.Local.sRev.Set("")
		F.Intrinsic.Math.Mult(V.DataView.Quote!Temp(V.Local.iC).Unit!FieldVal,10000,V.Local.sQty.Long)
		F.Intrinsic.Math.Add(V.DataView.Quote!Temp(V.Local.iC).Unit!FieldVal,V.Local.fEachQty,V.Local.fEachQty)
		F.Intrinsic.String.Format(V.DataView.Quote!Temp(V.Local.iC).SF_PRICE!FieldVal,"0.0000",V.Local.sCost)
		F.Intrinsic.Math.Mult(V.Local.sCost.Float,1000000,V.Local.sCost)
		F.Intrinsic.String.LPad(V.Local.sQty,"0",13,V.Local.sQty)
		F.Intrinsic.String.LPad(V.Local.sCost,"0",13,V.Local.sCost)
		'adding so lines to sales order, these are the so line that is used for creating wo's
		V.Local.sPart.Set(V.DataView.Quote!Temp(V.Local.iC).Sign_Router!FieldValTrim)
		F.Intrinsic.Control.If(V.Local.sPart.Length,>,17)
			F.Intrinsic.Math.Sub(V.Local.sPart.Length,17,V.Local.iRem)
			F.Intrinsic.String.Right(V.Local.sPart,V.Local.iRem,V.Local.sRev)
			F.Intrinsic.String.Left(V.Local.sPart,17,V.Local.sPart)
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","EA","PartNumber",V.Local.sPart,"PartRev",V.Local.sRev,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.Local.iC).MESSAGE!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL",V.DataView.Quote!Temp(V.Local.iC).PL!FieldVal,"UserField1","","UserField5",V.DataView.Quote!Temp(V.Local.iC).Line_Item!FieldVal,"Router",V.DataView.Quote!Temp(V.Local.iC).Sign_Router!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
		F.Intrinsic.Control.If(V.Local.iC,=,V.DataView.Quote!Temp.RowCount--)
			F.Intrinsic.Math.Mult(V.Local.fEachQty,10000,V.Local.sQty)
			F.Intrinsic.String.LPad(V.Local.sQty,"0",13,V.Local.sQty)
			F.Intrinsic.String.LPad(V.Local.sCost,"0",13,V.Local.sCost)
			'adding total sf for signs within a same group these are the lines that will be invoiced.
			F.Intrinsic.Control.If(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"FX")
				F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","EA","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","FS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
			F.Intrinsic.Control.ElseIf(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"GX")
				F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","EA","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","GS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
			F.Intrinsic.Control.ElseIf(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"OX")
				F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","EA","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","OS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
			F.Intrinsic.Control.Else
				F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","EA","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iC)
	F.Data.DataView.Close("Quote","Temp")
F.Intrinsic.Control.Next(V.Local.i)
F.Data.DataView.Close("Temp","VTemp")

F.Data.DataView.Create("Temp","VTemp",22,"UM = 'AS'","")
V.Local.fSFExt.Set(0)
V.Local.fTSF.Set(0)
F.Intrinsic.Control.For(V.Local.i,0,V.DataView.Temp!VTemp.RowCount--,1)
	F.Intrinsic.String.Build("Group_No = '{0}'",V.DataView.Temp!VTemp(V.Local.i).Group_No!FieldVal,V.Local.sFilter)
	F.Data.DataView.Create("Quote","Temp",22,V.Local.sFilter,"")
	V.Local.fASQty.Set(0)
	F.Intrinsic.Control.For(V.Local.iC,0,V.DataView.Quote!Temp.RowCount--,1)
		V.Local.sRev.Set("")
		F.Intrinsic.Math.Mult(V.DataView.Quote!Temp(V.Local.iC).SF_PRICE!FieldVal,V.DataView.Quote!Temp(V.Local.iC).Unit!FieldVal,V.Local.fTemp)
		F.Intrinsic.Math.Add(V.Local.fTemp,V.Local.fSFExt,V.Local.fSFExt)
		F.Intrinsic.Math.Mult(V.DataView.Quote!Temp(V.Local.iC).Unit!FieldVal,10000,V.Local.sQty.Long)
		F.Intrinsic.String.Format(V.DataView.Quote!Temp(V.Local.iC).SF_PRICE!FieldVal,"0.0000",V.Local.sCost)
		F.Intrinsic.Math.Mult(V.Local.sCost.Float,1000000,V.Local.sCost)
		F.Intrinsic.String.LPad(V.Local.sQty,"0",13,V.Local.sQty)
		F.Intrinsic.String.LPad(V.Local.sCost,"0",13,V.Local.sCost)
		'adding so lines to sales order, these are the so line that is used for creating wo's
		V.Local.sPart.Set(V.DataView.Quote!Temp(V.Local.iC).Sign_Router!FieldValTrim)
		F.Intrinsic.Control.If(V.Local.sPart.Length,>,17)
			F.Intrinsic.Math.Sub(V.Local.sPart.Length,17,V.Local.iRem)
			F.Intrinsic.String.Right(V.Local.sPart,V.Local.iRem,V.Local.sRev)
			F.Intrinsic.String.Left(V.Local.sPart,17,V.Local.sPart)
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","EA","PartNumber",V.Local.sPart,"PartRev",V.Local.sRev,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.Local.iC).MESSAGE!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL",V.DataView.Quote!Temp(V.Local.iC).PL!FieldVal,"UserField1","","UserField5",V.DataView.Quote!Temp(V.Local.iC).Line_Item!FieldVal,"Router",V.DataView.Quote!Temp(V.Local.iC).Sign_Router!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
	F.Intrinsic.Control.Next(V.Local.iC)
	F.Intrinsic.Control.If(V.Local.i,=,V.DataView.Temp!VTemp.RowCount--)
		F.Intrinsic.Math.Div(V.Local.fSFExt,V.DataView.Temp!VTemp.RowCount,V.Local.fSF)
		F.Intrinsic.Math.Mult(V.DataView.Temp!VTemp.RowCount,10000,V.Local.sQty)
		F.Intrinsic.String.Format(V.Local.fSF,"0.0000",V.Local.sCost)
		F.Intrinsic.Math.Mult(V.Local.sCost.Float,1000000,V.Local.sCost)
		F.Intrinsic.String.LPad(V.Local.sQty,"0",13,V.Local.sQty)
		F.Intrinsic.String.LPad(V.Local.sCost,"0",13,V.Local.sCost)
		'adding total sf for signs within a same group these are the lines that will be invoiced.
		F.Intrinsic.Control.If(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"FX")
			F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","AS","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","FS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
		F.Intrinsic.Control.ElseIf(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"GX")
			F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","AS","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","GS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
		F.Intrinsic.Control.ElseIf(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"OX")
			F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","AS","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","OS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
		F.Intrinsic.Control.Else
			F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","AS","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.Data.DataView.Close("Quote","Temp")
F.Intrinsic.Control.Next(V.Local.i)
F.Data.DataView.Close("Temp","VTemp")

F.Data.DataTable.Close("Temp")

F.Intrinsic.Control.If(V.DataTable.ORDUPL.RowCount--,<>,-1)
	F.Intrinsic.Control.CallSub(ORDUPLCreateFile)
	F.Intrinsic.Control.CallSub(ORDUPLSync)
F.Intrinsic.Control.EndIf

F.Data.DataTable.AcceptChanges("ORDUPL")
F.Data.DataTable.AcceptChanges("ORDUPLExtra")
F.Data.DataTable.AcceptChanges("ORDUPLLines")

F.Intrinsic.UI.Sleep(2)

'getting newly crated so and lines
F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Quote.RowCount--,1)
	V.Local.sRet.Redim(0,0)
	F.Intrinsic.String.Build("Select Top 1 a.Order_NO, b.Record_No, Part From V_Order_Header a left join V_Order_Lines b on a.Order_No = b.Order_No Where Customer_PO = '{0}' and Part = '{1}' and b.User_5 = '{2}' Order by a.Order_No Desc",V.Screen.FormQuote!txtCustPO.Text,V.DataTable.Quote(V.Local.i).Sign_Router!FieldVal,V.DataTable.Quote(V.Local.i).Line_Item!FieldVal,V.Local.sSql)
	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)

	F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
		F.Intrinsic.String.Build("Update Order_Lines Set User_5 = ' ' Where Order_No = '{0}' and Record_No = '{1}'",V.Local.sRet(0).Trim,V.Local.sRet(1).Trim,V.Local.sSql)
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
		'generating wo's from these newly created so lines
		V.Local.sMsg.Set(V.DataTable.Quote(V.Local.i).Message!FieldValTrim)
		F.Intrinsic.String.Build("Insert Into Order_Ln_Text Values('{0}','{1}',1,'{2}')",V.Local.sRet(0).Trim,V.Local.sRet(1).Trim,V.Local.sMsg.PSQLFriendly,V.Local.sSql)
		F.ODBC.Connection!con.Execute(V.Local.sSql)
		
		F.Data.DataTable.SetValue("Quote",V.Local.i,"Order_No",V.Local.sRet(0).Trim,"Order_Line",V.Local.sRet(1).Trim,"Customer_PO",V.Screen.FormQuote!txtCustPO.Text)
		F.Intrinsic.Control.If(V.Local.sRet(1).Length,>,2)
			F.Intrinsic.String.Left(V.Local.sRet(1),3,V.Local.sLine)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.sWOFile.Trim,=,"")
			F.Intrinsic.String.Format(V.Screen.FormQuote!dtpDueDate.Value,"MM/DD/YYYY",V.Local.sDueDate)
			F.Intrinsic.String.Build("{0}*!*{1}*!*{2}*!*{3}*!*{4}*!* *!* *!*{5}*!*{6}",V.DataTable.Quote(V.Local.i).Sign_Router!FieldValTrim,"","",V.Local.sDueDate,V.DataTable.Quote(V.Local.i).Unit!FieldVal,V.Local.sRet(0).Trim,V.Local.sLine,V.Local.sWOFile)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Format(V.Screen.FormQuote!dtpDueDate.Value,"MM/DD/YYYY",V.Local.sDueDate)
			F.Intrinsic.String.Build("{0}{1}{2}*!*{3}*!*{4}*!*{5}*!*{6}*!* *!* *!*{7}*!*{8}",V.Local.sWOFile,V.Ambient.NewLine,V.DataTable.Quote(V.Local.i).Sign_Router!FieldVal,"","",V.Local.sDueDate,V.DataTable.Quote(V.Local.i).Unit!FieldVal,V.Local.sRet(0).Trim,V.Local.sLine,V.Local.sWOFile)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf					
F.Intrinsic.Control.Next(V.Local.i)

F.Intrinsic.UI.ChangeWaitStatus("Creating Work Orders.........................")
F.Intrinsic.String.Format(V.Ambient.Now,"YYMMDD-HHMMSS",V.Local.sDate)
F.Intrinsic.Control.If(V.Caller.LocalGSSTempDir.Right1,=,"\")
	V.Local.sLocal.Set(V.Caller.LocalGSSTempDir)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("{0}\",V.Caller.LocalGSSTempDir,V.Local.sLocal)
F.Intrinsic.Control.EndIf
F.Intrinsic.String.Build("{0}WO_5182-{1}.txt",V.Local.sLocal,V.Local.sDate,V.Local.sFile)
F.Intrinsic.File.String2File(V.Local.sFile,V.Local.sWOFile)

F.Global.Callwrapper.New("GenFG","Manufacturing.CreateWorkOrderFinishedGoodPart")
F.Global.Callwrapper.SetProperty("GenFG","FileName",V.Local.sFile)
F.Global.CallWrapper.Run("GenFG")
F.Global.CallWrapper.GetProperty("GenFG","ReturnCode",V.Local.sRet)

F.Intrinsic.File.File2String(V.Local.sFile,V.Local.sData)

'updating wo descripton since template routers are used for wo generationg
F.Intrinsic.Control.If(V.DataTable.Quote(V.DataTable.Quote.RowCount--).Order_NO!FieldValTrim,<>,"")
	F.Intrinsic.String.Build("Select a.Job, a.Suffix, a.Order_No, a.Order_Line, b.Description From Order_To_WO a join V_Order_Lines b on a.Order_No = b.Order_No and a.Order_Line = b.Record_No Where a.Order_NO = '{0}'",V.DataTable.Quote(V.DataTable.Quote.RowCount--).Order_NO!FieldValTrim,V.Local.sSql)
	F.Data.DataTable.CreateFromSQL("WO","con",V.Local.sSql,True)
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.WO.RowCount--,1)
		V.Local.bSave.Set(False)
		V.Local.sTemp.Set(V.DataTable.WO(V.Local.i).Description!FieldValTrim)
		F.Intrinsic.String.Build("Update Order_To_WO Set Description = '{2}' Where Order_No = '{0}' and Order_Line = '{1}' and Job = '{3}' and Suffix = '{4}'",V.DataTable.WO(V.Local.i).Order_No!FieldValTrim,V.DataTable.WO(V.Local.i).Order_Line!FieldValTrim,V.Local.sTemp.PSQLFriendly,V.DataTable.WO(V.Local.i).Job!FieldValTrim,V.DataTable.WO(V.Local.i).Suffix!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
		F.Intrinsic.String.Build("Update Job_Header Set Description = '{2}' Where Job = '{0}' and Suffix = '{1}'",V.DataTable.WO(V.Local.i).Job!FieldValTrim,V.DataTable.WO(V.Local.i).Suffix!FieldValTrim,V.Local.sTemp.PSQLFriendly,V.Local.sSql)
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
		F.Intrinsic.String.Build("Order_NO = '{0}' and Order_Line = '{1}'",V.DataTable.WO(V.Local.i).Order_No!FieldValTrim,V.DataTable.WO(V.Local.i).Order_Line!FieldValTrim,V.Local.sFilter)
		F.Data.DataView.Create("Quote","VWO",22,V.Local.sFilter,"")
		F.Intrinsic.Control.If(V.DataView.Quote!VWO.RowCount--,<>,-1)
			F.Data.DataView.SetValue("Quote","VWO",-1,"Job",V.DataTable.WO(V.Local.i).Job!FieldValTrim,"Suffix",V.DataTable.WO(V.Local.i).Suffix!FieldValTrim)
	
			F.Intrinsic.String.Build("Select Job, Suffix, Seq, Operation, LMO, Description, Part, Units, Hours_Estimated from Job_Operations Where Job = '{0}' and Suffix = '{1}' Order by Seq",V.DataTable.WO(V.Local.i).Job!FieldValTrim,V.DataTable.WO(V.Local.i).Suffix!FieldValTrim,V.Local.sSQL)
			
			F.Data.DataTable.CreateFromSQL("JobOp","con",V.Local.sSql,True)
			F.Intrinsic.Control.For(V.Local.iC,V.DataTable.JobOp.RowCount--,0,-1)
				V.Local.bSkip.Set(False)
				F.Intrinsic.Control.If(V.DataTable.JobOp(V.Local.iC).Seq!FieldValTrim,<,"990000")
					F.Intrinsic.Control.If(V.DataTable.JobOp(V.Local.iC).LMO!FieldValTrim,=,"M")
						F.Intrinsic.Control.SelectCase(V.DataTable.JobOp(V.Local.iC).Operation!FieldValTrim)
							F.Intrinsic.Control.Case("MAT-1")
								F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User48!FieldValTrim,<>,V.DataTable.JobOp(V.Local.iC).Part!FieldValTrim,"AND",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User48!FieldValTrim,<>,"")
									F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User48!FieldValTrim,V.Local.sSql)
									F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sDescription)
									F.Intrinsic.Math.Mult(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User49!FieldValFloat,V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).Unit!FieldValFloat,V.Local.fEst)
									F.Data.DataTable.SetValue("JobOp",V.Local.iC,"Part",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User48!FieldValTrim,"Description",V.Local.sDescription.Trim,"Units",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User49!FieldVal,"Hours_Estimated",V.Local.fEst)
									V.Local.bSave.Set(True)
								F.Intrinsic.Control.Else
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User48!FieldValTrim,=,"")
										V.Local.bSkip.Set(True)
										F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
								
							F.Intrinsic.Control.Case("MAT-2")
								F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User50!FieldValTrim,<>,V.DataTable.JobOp(V.Local.iC).Part!FieldValTrim,"AND",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User50!FieldValTrim,<>,"")
									F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User50!FieldValTrim,V.Local.sSql)
									F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sDescription)
									F.Intrinsic.Math.Mult(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User51!FieldValFloat,V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).Unit!FieldValFloat,V.Local.fEst)
									F.Data.DataTable.SetValue("JobOp",V.Local.iC,"Part",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User50!FieldValTrim,"Description",V.Local.sDescription.Trim,"Units",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User51!FieldVal,"Hours_Estimated",V.Local.fEst)
									V.Local.bSave.Set(True)
								F.Intrinsic.Control.Else
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User50!FieldValTrim,=,"")
										V.Local.bSkip.Set(True)
										F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
								
							F.Intrinsic.Control.Case("MAT-3")
								F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User52!FieldValTrim,<>,V.DataTable.JobOp(V.Local.iC).Part!FieldValTrim,"AND",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User52!FieldValTrim,<>,"")
									F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User52!FieldValTrim,V.Local.sSql)
									F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sDescription)
									F.Intrinsic.Math.Mult(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User53!FieldValFloat,V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).Unit!FieldValFloat,V.Local.fEst)
									F.Data.DataTable.SetValue("JobOp",V.Local.iC,"Part",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User52!FieldValTrim,"Description",V.Local.sDescription.Trim,"Units",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User53!FieldVal,"Hours_Estimated",V.Local.fEst)
									V.Local.bSave.Set(True)
								F.Intrinsic.Control.Else
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User52!FieldValTrim,=,"")
										V.Local.bSkip.Set(True)
										F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
								
							F.Intrinsic.Control.Case("MAT-4")
								F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User54!FieldValTrim,<>,V.DataTable.JobOp(V.Local.iC).Part!FieldValTrim,"AND",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User54!FieldValTrim,<>,"")
									F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User54!FieldValTrim,V.Local.sSql)
									F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sDescription)
									F.Intrinsic.Math.Mult(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User55!FieldValFloat,V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).Unit!FieldValFloat,V.Local.fEst)
									F.Data.DataTable.SetValue("JobOp",V.Local.iC,"Part",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User54!FieldValTrim,"Description",V.Local.sDescription.Trim,"Units",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User55!FieldVal,"Hours_Estimated",V.Local.fEst)
									V.Local.bSave.Set(True)
								F.Intrinsic.Control.Else
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User54!FieldValTrim,=,"")
										V.Local.bSkip.Set(True)
										F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.EndIf	
								F.Intrinsic.Control.EndIf
								
							F.Intrinsic.Control.Case("MAT-5")
								F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User56!FieldValTrim,<>,V.DataTable.JobOp(V.Local.iC).Part!FieldValTrim,"AND",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User56!FieldValTrim,<>,"")
									F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User56!FieldValTrim,V.Local.sSql)
									F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sDescription)
									F.Intrinsic.Math.Mult(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User57!FieldValFloat,V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).Unit!FieldValFloat,V.Local.fEst)
									F.Data.DataTable.SetValue("JobOp",V.Local.iC,"Part",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User56!FieldValTrim,"Description",V.Local.sDescription.Trim,"Units",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User57!FieldVal,"Hours_Estimated",V.Local.fEst)
									V.Local.bSave.Set(True)
								F.Intrinsic.Control.Else
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User56!FieldValTrim,=,"")
										V.Local.bSkip.Set(True)
										F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
								
							F.Intrinsic.Control.Case("MAT-6")
								F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User58!FieldValTrim,<>,V.DataTable.JobOp(V.Local.iC).Part!FieldValTrim,"AND",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User58!FieldValTrim,<>,"")
									F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User58!FieldValTrim,V.Local.sSql)
									F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sDescription)
									F.Intrinsic.Math.Mult(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User59!FieldValFloat,V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).Unit!FieldValFloat,V.Local.fEst)
									F.Data.DataTable.SetValue("JobOp",V.Local.iC,"Part",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User58!FieldValTrim,"Description",V.Local.sDescription.Trim,"Units",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User59!FieldVal,"Hours_Estimated",V.Local.fEst)
									V.Local.bSave.Set(True)
								F.Intrinsic.Control.Else
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User58!FieldValTrim,=,"")
										V.Local.bSkip.Set(True)
										F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
								
						F.Intrinsic.Control.EndSelect
						
					F.Intrinsic.Control.EndIf
					
					F.Intrinsic.Control.If(V.Local.bSkip,=,False)
						F.Intrinsic.Control.If(V.DataTable.JobOp(V.Local.iC).LMO!FieldValTrim,=,"L")
							F.Intrinsic.Control.SelectCase(V.DataTable.JobOp(V.Local.iC).Operation!FieldValTrim)
								F.Intrinsic.Control.Case("STIFF1")
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User16!FieldValTrim,=,"")
										F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.EndIf
									
								F.Intrinsic.Control.Case("STIFF2")
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User16!FieldValTrim,=,"")
										F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.EndIf
									
								F.Intrinsic.Control.Case("STIFF3")
									V.Local.sStiff3.Set(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User22!FieldValTrim)
									F.Intrinsic.Control.If(V.Local.sStiff3.UCase,=,"N","OR",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User16!FieldValTrim,=,"")
										F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.EndIf
								
								F.Intrinsic.Control.Case("LAB-1")
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User48!FieldValTrim,=,"")
										F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.EndIf
									
								F.Intrinsic.Control.Case("LAB-2")
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User50!FieldValTrim,=,"")
										F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.EndIf
									
								F.Intrinsic.Control.Case("LAB-3")
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User52!FieldValTrim,=,"")
										F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.EndIf
									
								F.Intrinsic.Control.Case("LAB-5")
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User56!FieldValTrim,=,"")
										F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.EndIf
									
								F.Intrinsic.Control.Case("LAB-6")
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User58!FieldValTrim,=,"")
										F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.EndIf
											
							F.Intrinsic.Control.EndSelect
							
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iC)
			
			F.Intrinsic.Control.If(V.Local.bSave)
				F.Data.DataTable.SaveToDB("JobOp","con","Job_Operations","Job*!*Suffix*!*Seq",7)
				F.Intrinsic.String.Format(V.Screen.FormQuote!dtpDueDate.Value,"MM/DD/YYYY",V.Local.sDueDate)
				F.Global.APS.ScheduleJob(V.DataTable.JobOp(V.DataTable.JobOp.RowCount--).Job!FieldValTrim,V.DataTable.JobOp(V.DataTable.JobOp.RowCount--).Suffix!FieldValTrim,"B",V.Local.sDueDate)
			F.Intrinsic.Control.EndIf
		
			F.Data.DataTable.Close("JobOp")
		F.Intrinsic.Control.EndIf
		F.Data.DataView.Close("Quote","VWO")
	F.Intrinsic.Control.Next(V.Local.i)
	
	F.Data.DataTable.Close("WO")
	
	F.Data.DataTable.AddRow("200000","OrdNum",V.DataTable.Quote(V.DataTable.Quote.RowCount--).Order_NO!FieldValTrim,"Mode","O")
	F.Intrinsic.Control.CallSub("200000Sync")
	F.Data.DataTable.DeleteRow("200000")
	F.Data.DataTable.AcceptChanges("200000")
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.Close

F.Intrinsic.UI.CloseWaitDialog

F.Data.DataTable.SetValue("QUOTE",-1,"User44",V.Caller.User)

F.Intrinsic.Control.CallSub(cmdSave_Click)

Gui.FormQuote..Enabled(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdCreate_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdCreate_Click.End

Program.Sub.Get_Data.Start
F.Intrinsic.Control.SetErrorHandler("Get_Data_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sState.Declare(String,"AL:AK:AR:AZ:CA:CO:CT:CX:DE:FD:FL:GA:HI:IA:ID:IL:IN:KS:KY:LA:ME:MD:MA:MI:MO:MN:MS:MT:NE:NH:NV:NJ:NC:ND:NM:NY:OH:OK:OR:PA:RI:SC:SD:TN:TP:TX:UT:VT:VA:WA:WI:WV:WY")
V.Local.i.Declare(Long,0)
V.Local.iIndex.Declare(Long,0)
V.Local.sSt.Declare(String,"")
V.Local.sUser.Declare(String,"")
V.Local.sMsg.Declare(String,"")

Gui.FormQuote..Enabled(False)

F.Intrinsic.Control.If(V.Screen.FormQuote!txtCustQuote.Text,=,V.Global.sPrevQuote)
	Gui.FormQuote..Enabled(True)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.Global.sPrevQuote,<>,"")
		F.Intrinsic.String.Build("Delete From GCG_6419_C_Qte_Lock Where Cust_Quote = '{0}' and User_ID = '{1}'",V.Global.sPrevQuote.Trim,V.Caller.User,V.Local.sSql)
		F.ODBC.Connection!Con.OpenCompanyConnection
		F.ODBC.Connection!con.Execute(V.Local.sSql)
		F.ODBC.Connection!con.Close
	F.Intrinsic.Control.EndIf
	V.Global.sPrevQuote.Set(V.Screen.FormQuote!txtCustQuote.Text)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.Lock.Exists)
	F.Data.DataTable.Close("Lock")
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Cust_Quote, User_Id, Lock_Date, Lock_Time From GCG_6419_C_Qte_Lock Where Cust_Quote = '{0}'",V.Global.sPrevQuote.Trim,V.Local.sSql)
F.ODBC.Connection!Con.OpenCompanyConnection
F.Data.DataTable.CreateFromSQL("Lock","con",V.Local.sSql,True)
F.ODBC.Connection!con.Close
F.Intrinsic.Control.If(V.DataTable.Quote.Exists)
	
	F.Intrinsic.Control.If(V.DataTable.Lock.RowCount--,=,-1)
		F.Intrinsic.UI.InvokeWaitDialog("Geting Quote Data..............")
		V.Local.sSql.Set("Select Quote, Customer, Order_No, Order_Line, Customer_PO, Job, Suffix, Line_Item, Unit")
		F.Intrinsic.Control.For(V.Local.i,1,60,1)
			F.Intrinsic.String.Build("USER{0}",V.Local.i,V.Local.sUser)
			F.Intrinsic.Control.If(V.Local.i,=,14,"OR",V.Local.i,=,17)
				F.Intrinsic.String.Build("{0}, IF(ISNUMERIC({1}) = 1 and {1} <> '',Cast(rtrim({1}) as Double),Cast(Null as Double)) as {1}",V.Local.sSql,V.Local.sUser,V.Local.sSql)
			F.Intrinsic.Control.ElseIf(V.Local.i,=,19,"OR",V.Local.i,=,21)
				F.Intrinsic.String.Build("{0}, IF(ISNUMERIC({1}) = 1 and {1} <> '',Cast(rtrim({1}) as Double),Cast(Null as Double)) as {1}",V.Local.sSql,V.Local.sUser,V.Local.sSql)
			F.Intrinsic.Control.ElseIf(V.Local.i,=,29,"OR",V.Local.i,=,31)
				F.Intrinsic.String.Build("{0}, IF(ISNUMERIC({1}) = 1 and {1} <> '',Cast(rtrim({1}) as Double),Cast(Null as Double)) as {1}",V.Local.sSql,V.Local.sUser,V.Local.sSql)
			F.Intrinsic.Control.ElseIf(V.Local.i,=,33,"OR",V.Local.i,=,35)
				F.Intrinsic.String.Build("{0}, IF(ISNUMERIC({1}) = 1 and {1} <> '',Cast(rtrim({1}) as Double),Cast(Null as Double)) as {1}",V.Local.sSql,V.Local.sUser,V.Local.sSql)
			F.Intrinsic.Control.ElseIf(V.Local.i,=,37,"OR",V.Local.i,=,39)
				F.Intrinsic.String.Build("{0}, IF(ISNUMERIC({1}) = 1 and {1} <> '',Cast(rtrim({1}) as Double),Cast(Null as Double)) as {1}",V.Local.sSql,V.Local.sUser,V.Local.sSql)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0}, rtrim({1}) as {1}",V.Local.sSql,V.Local.sUser,V.Local.sSql)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.i)
		
		F.Intrinsic.String.Build("{0}, rtrim(Sign_Router) as Sign_Router, PL, UM, rtrim(Message) as Message, SF_Each, SF_Price, Group_No, rtrim(Group_Name) as Group_Name, rtrim(Group_Desc) as Group_Desc, USERH1, USERH3, USERH4, USERH5, QUICK_QUOTE, UM_EACH From GCG_6419_Quote Where Quote = '{1}' Order by Line_Item",V.Local.sSql,V.Screen.FormQuote!txtCustQuote.Text,V.Local.sSql)
	
		F.ODBC.Connection!Con.OpenCompanyConnection
		F.Data.DataTable.CreateFromSQL("TempQ","con",V.Local.sSql,True)
		F.Intrinsic.Control.If(V.Global.sPrevQuote,<>,"")
			F.Intrinsic.String.Build("Insert Into GCG_6419_C_Qte_Lock Values('{0}','{1}','{2}','{3}')",V.Global.sPrevQuote.Trim,V.Caller.User,V.Ambient.Date.PervasiveDate,V.Ambient.Time.PSQLFriendly,V.Local.sSql)
			F.ODBC.Connection!con.Execute(V.Local.sSql)
		F.Intrinsic.Control.EndIf
		F.ODBC.Connection!Con.Close
		F.Intrinsic.Control.If(V.DataTable.TempQ.RowCount--,<>,-1)
			Gui.FormQuote.txtCustPO.Text(V.DataTable.TempQ(V.DataTable.TempQ.RowCount--).Customer_PO!FieldValTrim)
			F.Intrinsic.Control.If(V.DataTable.TempQ(V.DataTable.TempQ.RowCount--).Order_No!FieldValTrim,<>,"")
				Gui.FormQuote.ddlRouter.Enabled(False)
				Gui.FormQuote.ddlState.Enabled(False)
				Gui.FormQuote.txtCust.Enabled(False)
				Gui.FormQuote.txtLines.Enabled(False)
				Gui.FormQuote.txtCustPO.Enabled(False)
				Gui.FormQuote.dtpDueDate.Enabled(False)
				Gui.FormQuote.cmdAdd.Enabled(False)
				Gui.FormQuote.cmdCust.Enabled(False)
				Gui.FormQuote.cmdCreate.Enabled(False)
				Gui.FormQuote.cmdSave.Enabled(False)
				Gui.FormQuote.cmdNewMat.Enabled(False)
				Gui.FormQuote.cmdOldMat.Enabled(False)
				Gui.FormQuote.cmdUpMat.Enabled(False)				
				V.Global.bEditable.Set(False)
			F.Intrinsic.Control.Else
				Gui.FormQuote.ddlRouter.Enabled(True)
				Gui.FormQuote.ddlState.Enabled(True)
				Gui.FormQuote.txtCust.Enabled(True)
				Gui.FormQuote.txtLines.Enabled(True)
				Gui.FormQuote.txtCustPO.Enabled(True)
				Gui.FormQuote.dtpDueDate.Enabled(True)
				Gui.FormQuote.cmdAdd.Enabled(True)
				Gui.FormQuote.cmdCust.Enabled(True)
				Gui.FormQuote.cmdCreate.Enabled(True)
				Gui.FormQuote.cmdSave.Enabled(True)
				Gui.FormQuote.cmdNewMat.Enabled(True)
				Gui.FormQuote.cmdOldMat.Enabled(True)
				Gui.FormQuote.cmdUpMat.Enabled(True)
				V.Global.bEditable.Set(True)
			F.Intrinsic.Control.EndIf
			F.Data.DataTable.DeleteRow("Quote")
			F.Data.DataTable.AcceptChanges("Quote")
			F.Data.DataTable.Merge("TempQ","Quote",False,2)
			F.Intrinsic.String.Left(V.DataTable.TempQ(V.DataTable.TempQ.RowCount--).Sign_Router!FieldVal,2,V.Local.sSt)
			F.Intrinsic.String.Split(V.Local.sState,":",V.Local.sState)
			F.Intrinsic.Control.For(V.Local.i,0,V.Local.sState.UBound,1)
				F.Intrinsic.Control.If(V.Local.sState(V.Local.i),=,V.Local.sSt)
					Gui.FormQuote.ddlState.Text(V.Local.sSt.Trim)
					F.Intrinsic.Control.ExitFor(V.Local.i)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.i)
			Gui.FormQuote.txtCustPO.Text(V.DataTable.TempQ(V.DataTable.TempQ.RowCount--).Customer_PO!FieldValTrim)
			Gui.FormQuote.txtUser1.Text(V.DataTable.TempQ(V.DataTable.TempQ.RowCount--).USERH1!FieldValTrim)
			Gui.FormQuote.txtUser3.Text(V.DataTable.TempQ(V.DataTable.TempQ.RowCount--).USERH3!FieldValTrim)
			Gui.FormQuote.txtUser4.Text(V.DataTable.TempQ(V.DataTable.TempQ.RowCount--).USERH4!FieldValTrim)
			Gui.FormQuote.txtUser5.Text(V.DataTable.TempQ(V.DataTable.TempQ.RowCount--).USERH5!FieldValTrim)
			Gui.FormQuote.txtLines.Text("")
		F.Intrinsic.Control.Else
			Gui.FormQuote.ddlState.Text("")
			Gui.FormQuote.txtCustPO.Text("")
			Gui.FormQuote.txtUser1.Text("")
			Gui.FormQuote.txtUser3.Text("")
			Gui.FormQuote.txtUser4.Text("")
			Gui.FormQuote.txtUser5.Text("")
			Gui.FormQuote.txtLines.Text("")
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.Close("TempQ")
		F.Intrinsic.Control.CallSub(ddlState_Change)
		F.Intrinsic.UI.CloseWaitDialog
	F.Intrinsic.Control.Else
		V.Global.sPrevQuote.Set("")
		F.Intrinsic.String.Build("Custom Quote Locked by User: {0}",V.DataTable.Lock(V.DataTable.Lock.RowCount--).User_ID!Fieldvaltrim,V.Local.sMsg)
		F.Intrinsic.UI.Msgbox(V.Local.sMsg)
		F.Intrinsic.Control.BlockEvents
		Gui.FormQuote.txtCustQuote.Text("")
		Gui.FormQuote.ddlState.Text("")
		Gui.FormQuote.txtCustPO.Text("")
		Gui.FormQuote.txtUser1.Text("")
		Gui.FormQuote.txtUser3.Text("")
		Gui.FormQuote.txtUser4.Text("")
		Gui.FormQuote.txtUser5.Text("")
		Gui.FormQuote.txtLines.Text("")
		Gui.FormQuote.txtCust.Text("")
		Gui.FormQuote.ddlRouter.Enabled(True)
		Gui.FormQuote.ddlState.Enabled(True)
		Gui.FormQuote.txtCust.Enabled(True)
		Gui.FormQuote.txtLines.Enabled(True)
		Gui.FormQuote.txtCustPO.Enabled(True)
		Gui.FormQuote.dtpDueDate.Enabled(True)
		Gui.FormQuote.cmdAdd.Enabled(True)
		Gui.FormQuote.cmdCust.Enabled(True)
		Gui.FormQuote.cmdCreate.Enabled(True)
		Gui.FormQuote.cmdSave.Enabled(True)
		Gui.FormQuote.cmdNewMat.Enabled(True)
		Gui.FormQuote.cmdOldMat.Enabled(True)
		Gui.FormQuote.cmdUpMat.Enabled(True)
		V.Global.bEditable.Set(True)
		F.Data.DataTable.DeleteRow("Quote")
		F.Data.DataTable.AcceptChanges("Quote")
		F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.Intrinsic.String.Split(V.Local.sState,":",V.Local.sState)
	
	F.Data.DataTable.Create("Quote",True)
	F.Data.DataTable.AddColumn("Quote","Quote","String")
	F.Data.DataTable.AddColumn("Quote","Customer","String")
	F.Data.DataTable.AddColumn("Quote","Order_NO","String")
	F.Data.DataTable.AddColumn("Quote","Order_Line","String")
	F.Data.DataTable.AddColumn("Quote","Customer_PO","String")
	F.Data.DataTable.AddColumn("Quote","Job","String")
	F.Data.DataTable.AddColumn("Quote","Suffix","String")
	F.Data.DataTable.AddColumn("Quote","LINE_ITEM","Long")
	F.Data.DataTable.AddColumn("Quote","Unit","Float")
	F.Data.DataTable.AddColumn("Quote","SIGN_ROUTER","String")
	F.Data.DataTable.AddColumn("Quote","PL","String")
	F.Data.DataTable.AddColumn("Quote","UM","String")
	F.Data.DataTable.AddColumn("Quote","MESSAGE","String")
	F.Data.DataTable.AddColumn("Quote","SF_EACH","Float")
	F.Data.DataTable.AddColumn("Quote","SF_PRICE","Float")
	F.Data.DataTable.AddExpressionColumn("QUOTE","TOTL_SF",Float,"[SF_EACH] * [Unit]")
	F.Data.DataTable.AddColumn("Quote","Group_No","Long")
	F.Data.DataTable.AddColumn("Quote","Group_Name","String")
	F.Data.DataTable.AddColumn("Quote","Group_Desc","String")
	F.Data.DataTable.AddColumn("Quote","Delete_Row","String")
	F.Data.DataTable.AddColumn("Quote","USERH1","String")
	F.Data.DataTable.AddColumn("Quote","USERH3","String")
	F.Data.DataTable.AddColumn("Quote","USERH4","String")
	F.Data.DataTable.AddColumn("Quote","USERH5","String")
	F.Data.DataTable.AddColumn("Quote","QUICK_QUOTE","String")
	F.Data.DataTable.AddColumn("Quote","UM_EACH","Float")
	
	F.Data.DataTable.Create("Routers",True)
	F.Data.DataTable.AddColumn("Routers","Selection","Boolean")
	F.Data.DataTable.AddColumn("Routers","Router","String")
	
	F.Data.DataTable.Create("UserFields",True)
	F.Data.DataTable.AddColumn("UserFields","Selection","Boolean")
	F.Data.DataTable.AddColumn("UserFields","Router","String")
	F.Data.DataTable.AddColumn("UserFields","UserField","String")
	F.Data.DataTable.AddColumn("UserFields","Caption","String")
	F.Data.DataTable.AddColumn("UserFields","Value","String")
	
	F.Data.DataView.Create("Routers","VRouters",22,"Selection = True","")
	F.Data.DataView.Create("UserFields","VUserFields",22,"Selection = True","")
	
	F.ODBC.Connection!Con.OpenCompanyConnection(999)
	
	F.Data.DataTable.CreateFromSQL("RDDL","con","Select rtrim(ucase(Router)) as Router1, rtrim(ucase(Router)) as Router2 From V_ROUTER_HEADER Order by Router",True)
	
	F.Data.DataTable.CreateFromSQL("UserCap","con","Select * From GCG_6313_RTR_EXT_TIT",True)
	
	F.Intrinsic.Control.For(v.Local.i,1,60,1)
		F.Intrinsic.String.Build("USER{0}",V.Local.i,V.Local.sUser)
		F.Intrinsic.Control.If(V.Local.i,=,14,"OR",V.Local.i,=,17)
			F.Data.DataTable.AddColumn("Quote",V.Local.sUser,"Float")
		F.Intrinsic.Control.ElseIf(V.Local.i,=,19,"OR",V.Local.i,=,21)
			F.Data.DataTable.AddColumn("Quote",V.Local.sUser,"Float")
		F.Intrinsic.Control.ElseIf(V.Local.i,=,29,"OR",V.Local.i,=,31)
			F.Data.DataTable.AddColumn("Quote",V.Local.sUser,"Float")
		F.Intrinsic.Control.ElseIf(V.Local.i,=,33,"OR",V.Local.i,=,35)
			F.Data.DataTable.AddColumn("Quote",V.Local.sUser,"Float")
		F.Intrinsic.Control.ElseIf(V.Local.i,=,37,"OR",V.Local.i,=,39)
			F.Data.DataTable.AddColumn("Quote",V.Local.sUser,"Float")
		F.Intrinsic.Control.Else
			F.Data.DataTable.AddColumn("Quote",V.Local.sUser,"String")
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataTable.UserCap.RowCount--,<>,-1)
			F.Data.DataTable.AddRow("UserFields","UserField",V.Local.sUser,"Caption",V.DataTable.UserCap(V.DataTable.UserCap.RowCount--).[V.Local.sUser]!FieldValTrim)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)

	F.Data.DataTable.SetValue("UserFields",-1,"SELECTION",False)
	
'	F.Data.DataTable.AddExpressionColumn("Quote","UM_EACH","Float","IIF([UM] = 'EA',Unit,IIF([UM] = 'SF', [SF_EACH],[SF_EACH] * Convert([USER7], 'System.Double')))")
	
	Gui.FormQuote.ddlState.AddItem(" ",0)
	
	F.Intrinsic.Control.For(V.Local.i,0,V.Local.sState.UBound,1)
		F.Intrinsic.Math.Add(V.Local.i,1,V.Local.iIndex)
		Gui.FormQuote.ddlState.AddItem(V.Local.sState(V.Local.i),V.Local.iIndex)
	F.Intrinsic.Control.Next(V.Local.i)
	
	'user1
	F.ODBC.Connection!Con.ExecuteAndReturn("select Label from OE_USER_FLDS_HDR Where Key_ID = '01'",V.Local.sSql)
	Gui.FormQuote.lblUser1.Caption(V.Local.sSql)
	'user3
	F.ODBC.Connection!Con.ExecuteAndReturn("select Label from OE_USER_FLDS_HDR Where Key_ID = '03'",V.Local.sSql)
	Gui.FormQuote.lblUser3.Caption(V.Local.sSql)
	'user4
	F.ODBC.Connection!Con.ExecuteAndReturn("select Label from OE_USER_FLDS_HDR Where Key_ID = '04'",V.Local.sSql)
	Gui.FormQuote.lblUser4.Caption(V.Local.sSql)
	'user5
	F.ODBC.Connection!Con.ExecuteAndReturn("select Label from OE_USER_FLDS_HDR Where Key_ID = '05'",V.Local.sSql)
	Gui.FormQuote.lblUser5.Caption(V.Local.sSql)
	F.ODBC.Connection!Con.Close
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.Quote.RowCount--,<>,-1)
	F.Intrinsic.Control.If(V.DataTable.Quote(V.DataTable.Quote.RowCount--).Quick_Quote!FieldValTrim,<>,"")
		Gui.FormQuote.cmdGenQuote.Enabled(False)
		Gui.FormQuote.lblQQ.Caption(V.DataTable.Quote(V.DataTable.Quote.RowCount--).Quick_Quote!FieldValTrim)
	F.Intrinsic.Control.Else
		Gui.FormQuote.cmdGenQuote.Enabled(True)
		Gui.FormQuote.lblQQ.Caption(" ")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	Gui.FormQuote.cmdGenQuote.Enabled(True)
	Gui.FormQuote.lblQQ.Caption(" ")
F.Intrinsic.Control.EndIf

Gui.FormQuote..Enabled(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Get_Data_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Get_Data.End

Program.Sub.Set_Properties.Start
F.Intrinsic.Control.SetErrorHandler("Set_Properties_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sUser.Declare(String,"")

gui.FormQuote.GsGridQuote.AddGridviewFromDatatable("GQuote","Quote")

gui.FormQuote.GsGridQuote.SetGridviewProperty("GQuote", "OptionsViewColumnAutoWidth", False)
gui.FormQuote.GsGridQuote.SetGridviewProperty("GQuote","ShowGroupPanel",True)

gui.FormQuote.GsGridQuote.ColumnEdit("GQuote","Delete_Row","EditorButton","Delete Row")
gui.FormQuote.GsGridQuote.ColumnEdit("GQuote","Group_No","DropDownList","1*!*2*!*3*!*4*!*5*!*6*!*7*!*8*!*9*!*10*!*11*!*12*!*13*!*14*!*15*!*16*!*17*!*18*!*19*!*20*!*21*!*22*!*23*!*24*!*25*!*26*!*27*!*28*!*29*!*30*!*31*!*32*!*33*!*34*!*35*!*36*!*37*!*38*!*39*!*40*!*41*!*42*!*43*!*44*!*45*!*46*!*47*!*48*!*49*!*50")
gui.FormQuote.GsGridQuote.ColumnEdit("GQuote","PL","DropDownList"," *!*FX*!*GX*!*OX")
gui.FormQuote.GsGridQuote.ColumnEdit("GQuote","SIGN_ROUTER","DropDownList","")

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Quote","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Quote","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Quote","caption","CUSTOM QUOTE")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Quote","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Quote","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Quote","Visible", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Quick_Quote","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Quick_Quote","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Quick_Quote","caption","QUICK QUOTE")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Quick_Quote","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Quick_Quote","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Quick_Quote","Visible", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer","caption","CUSTOMER")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer","Visible", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_No","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_No","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_No","caption","ORDER NO")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_No","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_No","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_No","Visible", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_Line","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_Line","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_Line","caption","ORDER LINE")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_Line","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_Line","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_Line","Visible", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer_PO","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer_PO","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer_PO","caption","CUSTOMER PO")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer_PO","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer_PO","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer_PO","Visible", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer_PO","AllowShowHide", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH1","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH1","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH1","caption","USERH1")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH1","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH1","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH1","Visible", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH1","AllowShowHide", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH3","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH3","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH3","caption","USERH3")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH3","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH3","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH3","Visible", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH3","AllowShowHide", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH4","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH4","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH4","caption","USERH4")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH4","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH4","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH4","Visible", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH4","AllowShowHide", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH5","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH5","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH5","caption","USERH5")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH5","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH5","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH5","Visible", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH5","AllowShowHide", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Job","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Job","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Job","caption","JOB")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Job","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Job","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Job","Visible", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Suffix","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Suffix","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Suffix","caption","SUFFIX")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Suffix","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Suffix","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Suffix","Visible", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","LINE_ITEM","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","LINE_ITEM","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","LINE_ITEM","caption","LINE ITEM")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","LINE_ITEM","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","LINE_ITEM","allowedit", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Unit","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Unit","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Unit","caption","# OF SIGNS")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Unit","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Unit","allowedit", True)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SIGN_ROUTER","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SIGN_ROUTER","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SIGN_ROUTER","caption","SIGN ROUTER")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SIGN_ROUTER","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SIGN_ROUTER","allowedit", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SIGN_ROUTER","MaxLength","20")

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PL","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PL","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PL","caption","PL")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PL","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PL","allowedit", True)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM","caption","UM")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM","allowedit", True)
Gui.FormQuote.GsGridQuote.ColumnEdit("GQuote","UM","DropDownList","EA*!*SF*!*AS")

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","MESSAGE","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","MESSAGE","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","MESSAGE","caption","SALES ORDER MESSAGE")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","MESSAGE","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","MESSAGE","allowedit", True)
'gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","MESSAGE","MaxLength","30")

F.Intrinsic.Control.For(V.Local.i,1,60,1)
	F.Intrinsic.String.Build("USER{0}",V.Local.i,V.Local.sUser)
	F.Intrinsic.Control.If(V.DataTable.UserCap.RowCount--,<>,-1)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"headerforecolor", v.Color.PRI-GSS-00)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"headerfontbold", true)
		F.Intrinsic.Control.If(V.DataTable.UserCap(V.DataTable.UserCap.RowCount--).[V.Local.sUser]!FieldValTrim,<>,"")
			gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"caption",V.DataTable.UserCap(V.DataTable.UserCap.RowCount--).[V.Local.sUser]!FieldValTrim)
			gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"Visible", True)
		F.Intrinsic.Control.Else
			gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"caption",V.Local.sUser)
			gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"Visible", False)
		F.Intrinsic.Control.EndIf
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"readonly", False)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"allowedit", True)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"MaxLength","70")
	F.Intrinsic.Control.Else
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"headerforecolor", v.Color.PRI-GSS-00)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"headerfontbold", true)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"caption",V.Local.sUser)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"Visible", False)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"readonly", False)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"allowedit", True)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"MaxLength","70")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.i)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_EACH","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_EACH","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_EACH","caption","SF EACH")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_EACH","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_EACH","allowedit", True)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM_EACH","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM_EACH","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM_EACH","caption","UM EACH")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM_EACH","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM_EACH","allowedit", True)
Gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM_EACH","Visible",False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_PRICE","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_PRICE","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_PRICE","caption","UM PRICE")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_PRICE","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_PRICE","allowedit", True)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","TOTL_SF","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","TOTL_SF","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","TOTL_SF","caption","TOTAL SF")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","TOTL_SF","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","TOTL_SF","allowedit", True)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_No","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_No","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_No","caption","GROUP")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_No","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_No","allowedit", True)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Name","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Name","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Name","caption","GROUP NAME")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Name","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Name","allowedit", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Name","MaxLength","50")

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Desc","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Desc","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Desc","caption","GROUP DESCRIPTION")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Desc","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Desc","allowedit", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Desc","MaxLength","50")

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Delete_Row","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Delete_Row","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Delete_Row","caption"," ")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Delete_Row","ReadOnly",True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Delete_Row","AllowEdit",False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Delete_Row","Fixed","Right")

Gui.FormQuote.GsGridQuote.AddSummaryItem("GQuote","TOTL_SF","TOTL_SF","Sum","SQ FT: ","")
Gui.FormQuote.GsGridQuote.AddGridGroupSummaryItem("GQuote","TOTL_SF","TOTL_SFTag","Sum","SF Sum: ","","N0")

gui.FormQuote.GsGridQuote.MainView("GQuote")

F.Intrinsic.Control.CallSub(Deserialize, "FORM", "FormQuote", "GRIDCONTROL", "GsGridQuote", "GRIDVIEW", "GQuote", "REGID", 6419)

F.Intrinsic.Control.For(V.Local.i,1,60,1)
	F.Intrinsic.String.Build("USER{0}",V.Local.i,V.Local.sUser)
	F.Intrinsic.Control.If(V.DataTable.UserCap.RowCount--,<>,-1)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"headerforecolor", v.Color.PRI-GSS-00)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"headerfontbold", true)
		F.Intrinsic.Control.If(V.DataTable.UserCap(V.DataTable.UserCap.RowCount--).[V.Local.sUser]!FieldValTrim,<>,"")
			gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"caption",V.DataTable.UserCap(V.DataTable.UserCap.RowCount--).[V.Local.sUser]!FieldValTrim)
			gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"Visible", True)
		F.Intrinsic.Control.Else
			gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"caption",V.Local.sUser)
			gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"Visible", False)
		F.Intrinsic.Control.EndIf
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"readonly", False)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"allowedit", True)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"MaxLength","70")
	F.Intrinsic.Control.Else
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"headerforecolor", v.Color.PRI-GSS-00)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"headerfontbold", true)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"caption",V.Local.sUser)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"Visible", False)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"readonly", False)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"allowedit", True)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"MaxLength","70")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.i)

gui.FormRouter.GsGridRouter.AddGridviewFromDatatable("GRouters","Routers")

gui.FormRouter.GsGridRouter.SetGridviewProperty("GRouters", "OptionsViewColumnAutoWidth", True)
gui.FormRouter.GsGridRouter.SetGridviewProperty("GRouters","ShowGroupPanel",True)

gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Selection","headerforecolor", v.Color.PRI-GSS-00)
gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Selection","headerfontbold", true)
gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Selection","caption","SELECTION")
gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Selection","readonly", False)
gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Selection","allowedit", True)

gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Router","headerforecolor", v.Color.PRI-GSS-00)
gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Router","headerfontbold", true)
gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Router","caption","ROUTER")
gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Router","readonly", True)
gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Router","allowedit", False)

gui.FormRouter.GsGridRouter.MainView("GRouters")

gui.FormRouter.GsGridUserFields.AddGridviewFromDatatable("GUserFields","UserFields")

gui.FormRouter.GsGridUserFields.SetGridviewProperty("GUserFields", "OptionsViewColumnAutoWidth", True)
gui.FormRouter.GsGridUserFields.SetGridviewProperty("GUserFields","ShowGroupPanel",True)

gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Selection","headerforecolor", v.Color.PRI-GSS-00)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Selection","headerfontbold", true)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Selection","caption","SELECTION")
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Selection","readonly", False)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Selection","allowedit", True)

gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Router","headerforecolor", v.Color.PRI-GSS-00)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Router","headerfontbold", true)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Router","caption","ROUTER")
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Router","readonly", True)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Router","allowedit", False)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Router","Visible", False)

gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","UserField","headerforecolor", v.Color.PRI-GSS-00)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","UserField","headerfontbold", true)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","UserField","caption","USER FIELD")
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","UserField","readonly", True)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","UserField","allowedit", False)

gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Caption","headerforecolor", v.Color.PRI-GSS-00)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Caption","headerfontbold", true)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Caption","caption","CAPTION")
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Caption","readonly", True)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Caption","allowedit", False)

gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Value","headerforecolor", v.Color.PRI-GSS-00)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Value","headerfontbold", true)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Value","caption","VALUE")
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Value","readonly", False)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Value","allowedit", True)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Value","MaxLength","70")

gui.FormRouter.GsGridUserFields.MainView("GUserFields")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Set_Properties_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Set_Properties.End

Program.Sub.Serialize.Start
'pass FORM, GRIDCONTROL, GRIDVIEW, REGID
F.Intrinsic.Control.SetErrorHandler("Serialize_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSerialize.Declare(String)
V.Local.sForm.Declare(String)
V.Local.sGridControl.Declare(String)
V.Local.sGridView.Declare(String)
V.Local.sREGID.Declare(String)

V.Local.sForm.Set(V.Args.Form.Trim)
V.Local.sGridControl.Set(V.Args.GridControl.Trim)
V.Local.sGridView.Set(V.Args.GridView.Trim)
V.Local.sREGID.Set(V.Args.REGID.Trim)

GUI.[V.Local.sForm].[V.Local.sGridControl].Serialize(V.Local.sGridView, V.Local.sSerialize)
F.Global.Registry.AddValue(V.Caller.User, V.Caller.CompanyCode, V.Local.sGridView, V.Local.sREGID, 1000, False, "Serialize", False, 0, -999.0 , 1/1/1980, 12:00:00 AM, V.Local.sSerialize)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Serialize_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.End
Function.Intrinsic.Control.EndIf
Program.Sub.Serialize.End

Program.Sub.Deserialize.Start
'pass FORM, GRIDCONTROL, GRIDVIEW, REGID
F.Intrinsic.Control.SetErrorHandler("Deserialize_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSerialize.Declare(String)
V.Local.sForm.Declare(String)
V.Local.sGridControl.Declare(String)
V.Local.sGridView.Declare(String)
V.Local.sREGID.Declare(String)

V.Local.sForm.Set(V.Args.Form.Trim)
V.Local.sGridControl.Set(V.Args.GridControl.Trim)
V.Local.sGridView.Set(V.Args.GridView.Trim)
V.Local.sREGID.Set(V.Args.REGID.Trim)

F.Global.Registry.ReadValue(V.Caller.User, V.Caller.CompanyCode, V.Local.sGridView, V.Local.sREGID, 1000, 6, "", V.Local.sSerialize)
F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
	Gui.[V.Local.sForm].[V.Local.sGridControl].Deserialize(V.Local.sSerialize)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Deserialize_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Deserialize.End

Program.Sub.cmdExport_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdExport_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.bExcel.Declare(Boolean,False)
V.Local.sFileExport.Declare(String,"")
V.Local.bFileLocked.Declare(Boolean,False)
V.Local.sMsg.Declare(String,"")
	
F.Automation.MSExcel.CheckPresence(V.Local.bExcel)
'exporting grid to an excel file or csv
F.Intrinsic.Control.If(V.Local.bExcel)
	F.Intrinsic.String.Build("{0}GCG_6419_{1}_Export.xlsx",V.Caller.LocalGssTempDir,"GsGridQuote",V.Local.sFileExport)
	F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
	F.Intrinsic.Control.If(V.Local.bFileLocked)
		F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
		F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
	F.Intrinsic.Control.Else
		Gui.FormQuote.GsGridQuote.Export(V.Local.sFileExport,"xlsx")
		F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("{0}GCG_6419_{1}_Export.csv",V.Caller.LocalGssTempDir,"GsGridQuote",V.Local.sFileExport)
	F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
	F.Intrinsic.Control.If(V.Local.bFileLocked)
		F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
		F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
	F.Intrinsic.Control.Else
		Gui.FormQuote.GsGridQuote.Export(V.Local.sFileExport,"csv")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdExport_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdExport_Click.End

Program.Sub.txtCust_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtCust_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtCust.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtCust_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtCust_GotFocus.End

Program.Sub.cmdCust_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdCust_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRet.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.Intrinsic.UI.Browser(205,"",V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	Gui.FormQuote.txtCust.Text(V.Local.sRet)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdCust_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdCust_Click.End

Program.Sub.ddlState_Change.Start
F.Intrinsic.Control.SetErrorHandler("ddlState_Change_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.sFilter.Declare(String,"")

f.Intrinsic.Control.BlockEvents

Gui.FormQuote.ddlRouter.ClearItems
Gui.FormQuote.ddlRouter.AddItem(" ",0)

F.Intrinsic.Control.If(V.Screen.FormQuote!ddlState.Value,<>,"")
'	F.ODBC.Connection!Con.OpenCompanyConnection(999)
	'populating dropdown control and dropdown within the grid
	F.Intrinsic.String.Build("ROUTER1 Like '{0}*'",V.Screen.FormQuote!ddlState.Text,V.Local.sFilter)
	F.Data.DataView.Create("RDDL","Temp",22,V.Local.sFilter,"")
	F.Data.Dictionary.CreateFromDataView("Router","RDDL","Temp","Router1","Router2")
	F.Data.DataView.ToDataTableDistinct("RDDL","Temp","RDDLTemp","Router1",True)
	F.Data.DataView.Close("RDDL","Temp")
	F.Data.DataView.Create("RDDLTemp","Temp",22,"","")
	F.Data.DataView.ToString("RDDLTemp","Temp","Router1",V.Ambient.NewLine,"*!*",V.Local.sRouter)
	F.Data.DataView.Close("RDDLTemp","Temp")
	F.Data.DataTable.Close("RDDLTemp")
'	F.Intrinsic.String.Build("Select rtrim(ucase(Router)), rtrim(ucase(Router)) From V_ROUTER_HEADER Where ucase(Router) like '{0}%' Order by Router",V.Screen.FormQuote!ddlState.Text,V.Local.sSql)
'	F.Data.Dictionary.CreateFromSQL("Router","con",V.Local.sSql)
	Gui.FormQuote.ddlRouter.AddItems("Dictionary","Router")
	F.Data.Dictionary.Close("Router")
	
'	F.Intrinsic.String.Build("Select rtrim(ucase(Router)) From V_ROUTER_HEADER Where ucase(Router) like '{0}%' Order by Router",V.Screen.FormQuote!ddlState.Text,V.Local.sSql)
'	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRouter)
'	F.ODBC.Connection!Con.Close
	
'	F.Intrinsic.String.Replace(V.Local.sRouter,"#$#","*!*",V.Local.sRouter)
	F.Intrinsic.Control.If(V.Local.sRouter.Trim,<>,"")
		F.Intrinsic.String.Build("*!*{0}",V.Local.sRouter,V.Local.sRouter)
	F.Intrinsic.Control.EndIf
	gui.FormQuote.GsGridQuote.ColumnEdit("GQuote","SIGN_ROUTER","DropDownList",V.Local.sRouter)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlState_Change_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlState_Change.End

Program.Sub.cmdGen_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdGen_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sQuote.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.iRet.Declare(Long,0)

F.Intrinsic.Control.BlockEvents

'getting a new Custom Quote Number
Gui.FormQuote.cmdGenQuote.Enabled(True)

F.ODBC.Connection!Con.OpenCompanyConnection

F.Intrinsic.Control.If(V.Global.sPrevQuote,<>,"")
	F.Intrinsic.String.Build("Delete From GCG_6419_C_Qte_Lock Where Cust_Quote = '{0}' and User_ID = '{1}'",V.Global.sPrevQuote.Trim,V.Caller.User,V.Local.sSql)
	F.ODBC.Connection!con.Execute(V.Local.sSql)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.GetID("GCG_6419_Lst_Quote","Last_Quote",True,V.Local.sQuote)

F.Intrinsic.Control.If(V.Local.sQuote,=,"9999999")
	V.Local.sQuote.Set("0000001")
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.Local.sQuote,=,"1")
		F.Intrinsic.String.LPad(V.Local.sQuote,"0",7,V.Local.sQuote)
		F.Intrinsic.String.Build("Insert Into GCG_6419_Lst_Quote Values('{0}')",V.Local.sQuote,V.Local.sSql)
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.LPad(V.Local.sQuote,"0",7,V.Local.sQuote)
		F.Intrinsic.String.Build("Update GCG_6419_Lst_Quote Set Last_Quote = '{0}'",V.Local.sQuote,V.Local.sSql)
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

Gui.FormQuote.txtCustQuote.Text(V.Local.sQuote)
V.Global.sPrevQuote.Set(V.Local.sQuote)
Gui.FormQuote.txtCustPO.Text("")

F.Intrinsic.Control.If(V.DataTable.Quote.RowCount--,<>,-1)
	F.Intrinsic.UI.Msgbox("Do you want to clear the grid?","Attention",4,V.Local.iRet)
	F.Intrinsic.Control.If(V.Local.iRet,=,6)
		F.Data.DataTable.DeleteRow("Quote")
		F.Data.DataTable.AcceptChanges("Quote")
	F.Intrinsic.Control.Else
		F.Data.DataTable.SetValue("Quote",-1,"Order_No","","Order_Line","","Job","","Suffix","","Customer_PO","")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

Gui.FormQuote.ddlRouter.Enabled(True)
Gui.FormQuote.ddlState.Enabled(True)
Gui.FormQuote.txtCust.Enabled(True)
Gui.FormQuote.txtLines.Enabled(True)
Gui.FormQuote.txtCustPO.Enabled(True)
Gui.FormQuote.dtpDueDate.Enabled(True)
Gui.FormQuote.cmdAdd.Enabled(True)
Gui.FormQuote.cmdCust.Enabled(True)
Gui.FormQuote.cmdCreate.Enabled(True)
Gui.FormQuote.cmdSave.Enabled(True)
Gui.FormQuote.cmdNewMat.Enabled(True)
Gui.FormQuote.cmdOldMat.Enabled(True)
Gui.FormQuote.cmdUpMat.Enabled(True)
V.Global.bEditable.Set(True)

F.Intrinsic.String.Build("Insert Into GCG_6419_C_Qte_Lock Values('{0}','{1}','{2}','{3}')",V.Global.sPrevQuote.Trim,V.Caller.User,V.Ambient.Date.PervasiveDate,V.Ambient.Time.PSQLFriendly,V.Local.sSql)
F.ODBC.Connection!con.Execute(V.Local.sSql)

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdGen_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdGen_Click.End

Program.Sub.txtCustQuote_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtCustQuote_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtCustQuote.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtCustQuote_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtCustQuote_GotFocus.End

Program.Sub.txtCustQuote_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtCustQuote_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sCust.Declare(String,"")

F.Intrinsic.Control.If(V.Screen.FormQuote!txtCustQuote.Text,=,V.Global.sPrevQuote)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Customer From GCG_6419_Quote Where Quote = '{0}'",V.Screen.FormQuote!txtCustQuote.Text,V.Local.sSql)

F.ODBC.Connection!con.OpenCompanyConnection
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sCust)
F.Intrinsic.Control.If(V.Local.sCust,=,"")
	F.Intrinsic.UI.Msgbox("Invalid Quote Number")
	F.Intrinsic.Control.BlockEvents
	Gui.FormQuote.txtCust.Text("")
	Gui.FormQuote.txtCustQuote.Text("")
	Gui.FormQuote.txtCust.SetFocus
	F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.Else
	Gui.FormQuote.txtCust.Text(V.Local.sCust.Trim)
	F.Intrinsic.Control.CallSub(Get_Data)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtCustQuote_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtCustQuote_LostFocus.End

Program.Sub.txtCustQuote_KeyPressEnter.Start
F.Intrinsic.Control.SetErrorHandler("txtCustQuote_KeyPressEnter_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sCust.Declare(String,"")

F.Intrinsic.Control.If(V.Screen.FormQuote!txtCustQuote.Text,=,V.Global.sPrevQuote)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Customer From GCG_6419_Quote Where Quote = '{0}'",V.Screen.FormQuote!txtCustQuote.Text,V.Local.sSql)

F.ODBC.Connection!con.OpenCompanyConnection
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sCust)
F.Intrinsic.Control.If(V.Local.sCust,=,"")
	F.Intrinsic.UI.Msgbox("Invalid Quote Number")
	F.Intrinsic.Control.BlockEvents
	Gui.FormQuote.txtCust.Text("")
	Gui.FormQuote.txtCustQuote.Text("")
	Gui.FormQuote.txtCust.SetFocus
	F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.Else
	Gui.FormQuote.txtCust.Text(V.Local.sCust.Trim)
	F.Intrinsic.Control.CallSub(Get_Data)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtCustQuote_KeyPressEnter_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtCustQuote_KeyPressEnter.End

Program.Sub.cmdQuote_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdQuote_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")
V.Local.sRet.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.SetBrowserOOT(True)

V.Local.sSql.Set("Select Distinct Quote, Customer, UserH1 From GCG_6419_Quote Order by Quote") 
V.Local.sTitles.Set("Quote*!*Customer*!*Rocal Job")
V.Local.sWidths.Set("1800*!*1800*!*1800")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.ODBC.Connection!Con.OpenCompanyConnection

F.Intrinsic.UI.Browser("Select Quote","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,9000,V.Local.sRet)

F.ODBC.Connection!Con.Close
	
F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	Gui.FormQuote.txtCustQuote.Text(V.Local.sRet.Trim)
	Gui.FormQuote.txtCust.Text(V.Local.sRet(1).Trim)
	F.Intrinsic.Control.CallSub(Get_Data)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdQuote_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdQuote_Click.End

Program.Sub.txtLines_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtLines_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtLines.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtLines_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtLines_GotFocus.End

Program.Sub.cmdAdd_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdAdd_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.iLineItem.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.iGroup.Declare(Long,1)
V.Local.sGName.Declare(String,"")
V.Local.sGDesc.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sSign.Declare(String,"")
V.Local.iU.Declare(Long,0)
V.Local.sUser.Declare(String,"")
V.Local.sSize.Declare(String,"")
V.Local.sPL.Declare(String,"")
V.Local.sQuote.Declare(String,"")
V.Local.sUM.Declare(String,"")
V.Local.sTemp.Declare(String,"")

Gui.FormQuote..Enabled(False)

'After selectinga Router this sub adds that router to the grid x amount of times and auto files the user info

V.Local.sQuote.Set(V.Screen.FormQuote!txtCustQuote.Text)
F.Intrinsic.Control.If(V.Local.sQuote.Trim,=,"")
	F.Intrinsic.UI.Msgbox("Create a Custom Quote or Select an existing Custom Quote to add lines","Attention")
	Gui.FormQuote..Enabled(True)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.Quote.RowCount--,<>,-1)
	V.Local.iLineItem.Set(V.DataTable.Quote(V.DataTable.Quote.RowCount--).Line_Item!FieldVal)
	V.Local.iGroup.Set(V.DataTable.Quote(V.DataTable.Quote.RowCount--).Group_No!FieldVal)
	V.Local.sGName.Set(V.DataTable.Quote(V.DataTable.Quote.RowCount--).Group_Name!FieldValTrim)
	V.Local.sGDesc.Set(V.DataTable.Quote(V.DataTable.Quote.RowCount--).Group_Desc!FieldValTrim)
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Top 1 Sort_1 From V_Router_Header Where ucase(Router) = '{0}'",V.Screen.FormQuote!ddlRouter.Text,V.Local.sSql)
F.ODBC.Connection!Con.OpenCompanyConnection(999)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sSize)

F.Intrinsic.String.Build("Select Top 1 Prod_Line From V_Router_Header Where ucase(Router) = '{0}'",V.Screen.FormQuote!ddlRouter.Text,V.Local.sSql)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPL)

F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Router_Header Where ucase(Router) = '{0}'",V.Screen.FormQuote!ddlRouter.Text,V.Local.sSql)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.If(V.Screen.FormQuote!txtLines.Text,>,0)
	'Getting User Fields
	F.Intrinsic.String.Build("Select * From GCG_6313_Rtr_Extra Where ucase(Router) = '{0}'",V.Screen.FormQuote!ddlRouter.Text,V.Local.sSql)
	F.ODBC.Connection!Con.OpenCompanyConnection(999)
	F.Data.DataTable.CreateFromSQL("Ext","con",V.Local.sSql,True)
	F.ODBC.Connection!Con.Close
	F.Intrinsic.Control.For(V.Local.i,1,V.Screen.FormQuote!txtLines.Text,1)
		F.Intrinsic.Math.Add(V.Local.iLineItem,1,V.Local.iLineItem)
		F.Intrinsic.Control.If(V.DataTable.Ext.RowCount--,<>,-1)
			F.Intrinsic.Control.If(V.Local.sUM,=,"AS")
				F.Data.DataTable.AddRow("Quote","SF_EACH",V.Local.sSize.Float,"LINE_ITEM",V.Local.iLineItem,"Unit",1,"SIGN_ROUTER",V.Screen.FormQuote!ddlRouter.Text,"Group_No",V.Local.iGroup,"Group_Name",V.Local.sGName,"Group_Desc",V.Local.sGDesc,"PL",V.Local.sPL,"UM",V.Local.sUM.Trim,"UM_EACH",0)
			F.Intrinsic.Control.ElseIf(V.Local.sUM,=,"SF")
				F.Data.DataTable.AddRow("Quote","SF_EACH",V.Local.sSize.Float,"LINE_ITEM",V.Local.iLineItem,"Unit",1,"SIGN_ROUTER",V.Screen.FormQuote!ddlRouter.Text,"Group_No",V.Local.iGroup,"Group_Name",V.Local.sGName,"Group_Desc",V.Local.sGDesc,"PL",V.Local.sPL,"UM",V.Local.sUM.Trim,"UM_EACH",V.Local.sSize.Float)
			F.Intrinsic.Control.Else
				F.Data.DataTable.AddRow("Quote","SF_EACH",V.Local.sSize.Float,"LINE_ITEM",V.Local.iLineItem,"Unit",1,"SIGN_ROUTER",V.Screen.FormQuote!ddlRouter.Text,"Group_No",V.Local.iGroup,"Group_Name",V.Local.sGName,"Group_Desc",V.Local.sGDesc,"PL",V.Local.sPL,"UM",V.Local.sUM.Trim,"UM_EACH",1)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.For(V.Local.iU,1,60,1)
				F.Intrinsic.String.Build("USER{0}",V.Local.iU,V.Local.sUser)
				F.Intrinsic.Control.If(V.Local.iU,=,14,"OR",V.Local.iU,=,17)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.DataTable.Quote.RowCount--,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,19,"OR",V.Local.iU,=,21)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.DataTable.Quote.RowCount--,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,29,"OR",V.Local.iU,=,31)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.DataTable.Quote.RowCount--,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,33,"OR",V.Local.iU,=,35)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.DataTable.Quote.RowCount--,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,37,"OR",V.Local.iU,=,39)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.DataTable.Quote.RowCount--,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Data.DataTable.SetValue("QUOTE",V.DataTable.Quote.RowCount--,V.Local.sUser,V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sUser,=,"USER2")
						F.Data.DataTable.SetValue("QUOTE",V.DataTable.Quote.RowCount--,"MESSAGE",V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.Else
			F.Data.DataTable.AddRow("Quote","SF_EACH",V.Local.sSize.Float,"LINE_ITEM",V.Local.iLineItem,"Unit",1,"SIGN_ROUTER",V.Screen.FormQuote!ddlRouter.Text,"Group_No",V.Local.iGroup,"Group_Name",V.Local.sGName,"Group_Desc",V.Local.sGDesc)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
	F.Data.DataTable.Close("Ext")
F.Intrinsic.Control.EndIf

Gui.FormQuote..Enabled(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdAdd_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdAdd_Click.End

Program.Sub.txtCust_KeyPressEnter.Start
F.Intrinsic.Control.SetErrorHandler("txtCust_KeyPressEnter_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sCust.Declare(String,"")

V.Local.sCust.Set(V.Screen.FormQuote!txtCust.Text)
V.Local.sCust.Set(V.Local.sCust.Trim)
F.Intrinsic.Control.If(V.Local.sCust,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Customer From V_Customer_Master Where Ucase(Customer) = '{0}'",V.Local.sCust.UCase,V.Local.sSql)

F.ODBC.Connection!con.OpenCompanyConnection
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sCust)
F.Intrinsic.Control.If(V.Local.sCust,=,"")
	F.Intrinsic.UI.Msgbox("Invalid Customer Number")
	F.Intrinsic.Control.BlockEvents
	Gui.FormQuote.txtCust.Text("")
	Gui.FormQuote.txtCust.SetFocus
	F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtCust_KeyPressEnter_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtCust_KeyPressEnter.End

Program.Sub.txtCust_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtCust_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sCust.Declare(String,"")

V.Local.sCust.Set(V.Screen.FormQuote!txtCust.Text)
V.Local.sCust.Set(V.Local.sCust.Trim)
F.Intrinsic.Control.If(V.Local.sCust,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Customer From V_Customer_Master Where Ucase(Customer) = '{0}'",V.Local.sCust.UCase,V.Local.sSql)

F.ODBC.Connection!con.OpenCompanyConnection
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sCust)
F.Intrinsic.Control.If(V.Local.sCust,=,"")
	F.Intrinsic.UI.Msgbox("Invalid Customer Number")
	F.Intrinsic.Control.BlockEvents
	Gui.FormQuote.txtCust.Text("")
	Gui.FormQuote.txtCust.SetFocus
	F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtCust_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtCust_LostFocus.End

Program.Sub.GsGridQuote_RowCellClick.Start
F.Intrinsic.Control.SetErrorHandler("GsGridQuote_RowCellClick_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.iRet.Declare(Long,0)

'removing record from grid
F.Intrinsic.Control.SelectCase(V.Args.Column.UCase)
	F.Intrinsic.Control.Case("DELETE_ROW")
		F.Intrinsic.Control.If(V.Global.bEditable)
			F.Intrinsic.UI.Msgbox("Are you sure you want to delete the row?","Attention",4,V.Local.iRet)
			F.Intrinsic.Control.If(V.Local.iRet,=,6)
				F.Data.DataTable.DeleteRow("Quote",V.Args.RowIndex)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("GsGridQuote_RowCellClick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.GsGridQuote_RowCellClick.End

Program.Sub.GsGridQuote_CellValueChanged.Start
F.Intrinsic.Control.SetErrorHandler("GsGridQuote_RowCellClick_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSign.Declare(String,"")
V.Local.iCol.Declare(Long,0)
V.Local.sRet.Declare(String,"")
V.Local.sFilter.Declare(String,"")
V.Local.iU.Declare(Long,0)
V.Local.sUser.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sSize.Declare(String,"")
V.Local.sPL.Declare(String,"")
V.Local.fTemp.Declare(Float,0)
V.Local.fUnit.Declare(Float,0)
V.Local.sUM.Declare(String,"")
V.Local.sTemp.Declare(String,"")

'auto filling changes to other lines with the group
F.Intrinsic.Control.SelectCase(V.Args.Column.UCase)
	F.Intrinsic.Control.Case("SIGN_ROUTER")
		F.Intrinsic.String.Build("Select Top 1 Sort_1 From V_Router_Header Where ucase(Router) = '{0}'",V.Args.Value,V.Local.sSql)
		F.ODBC.Connection!Con.OpenCompanyConnection
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sSize)
		F.Intrinsic.String.Build("Select Top 1 Prod_Line From V_Router_Header Where ucase(Router) = '{0}'",V.Args.Value,V.Local.sSql)
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPL)
		F.Intrinsic.String.Build("Select * From GCG_6313_Rtr_Extra Where ucase(Router) = '{0}'",V.Args.Value,V.Local.sSql)
		F.Data.DataTable.CreateFromSQL("Ext","con",V.Local.sSql,True)
		F.ODBC.Connection!Con.Close
		F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"SF_EACH",V.Local.sSize.Float,"PL",V.Local.sPL)
		F.Intrinsic.Control.If(V.DataTable.Ext.RowCount--,<>,-1)
			F.Intrinsic.Control.For(V.Local.iU,1,60,1)
				F.Intrinsic.String.Build("USER{0}",V.Local.iU,V.Local.sUser)
				F.Intrinsic.Control.If(V.Local.iU,=,14,"OR",V.Local.iU,=,17)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,19,"OR",V.Local.iU,=,21)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,29,"OR",V.Local.iU,=,31)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,33,"OR",V.Local.iU,=,35)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,37,"OR",V.Local.iU,=,39)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,V.Local.sUser,V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sUser,=,"USER2")
						F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"MESSAGE",V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.EndIf
				f.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.For(V.Local.iU,1,60,1)
				F.Intrinsic.String.Build("USER{0}",V.Local.iU,V.Local.sUser)
				F.Intrinsic.Control.If(V.Local.iU,=,14,"OR",V.Local.iU,=,17)
					F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Ambient.DBNull)
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,19,"OR",V.Local.iU,=,21)
					F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Ambient.DBNull)
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,29,"OR",V.Local.iU,=,31)
					F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Ambient.DBNull)
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,33,"OR",V.Local.iU,=,35)
					F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Ambient.DBNull)
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,37,"OR",V.Local.iU,=,39)
					F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Ambient.DBNull)
				F.Intrinsic.Control.Else
					F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,V.Local.sUser,"")
					F.Intrinsic.Control.If(V.Local.sUser,=,"USER2")
						F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"MESSAGE","")
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.Close("Ext")
		
	F.Intrinsic.Control.Case("GROUP_NAME")
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","Group_No",V.Args.RowIndex,V.Local.sRet)
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","UM",V.Args.RowIndex,V.Local.sUM)
		F.Intrinsic.Control.If(V.Local.sUM,<>,"AS")
			F.Intrinsic.String.Build("Group_No = {0}",V.Local.sRet.Long,V.Local.sFilter)
			F.Data.DataView.Create("Quote","VTEMP",22,V.Local.sFilter,"")
			F.Data.DataView.SetValue("Quote","VTEMP",-1,"Group_Name",V.Args.Value)
			F.Data.DataView.Close("Quote","VTEMP")
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("UM = {0}","AS",V.Local.sFilter)
			F.Data.DataView.Create("Quote","VTEMP",22,V.Local.sFilter,"")
			F.Data.DataView.SetValue("Quote","VTEMP",-1,"Group_Name",V.Args.Value)
			F.Data.DataView.Close("Quote","VTEMP")
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Case("GROUP_DESC")
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","Group_No",V.Args.RowIndex,V.Local.sRet)
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","UM",V.Args.RowIndex,V.Local.sUM)
		F.Intrinsic.Control.If(V.Local.sUM,<>,"AS")
			F.Intrinsic.String.Build("Group_No = {0}",V.Local.sRet.Long,V.Local.sFilter)
			F.Data.DataView.Create("Quote","VTEMP",22,V.Local.sFilter,"")
			F.Data.DataView.SetValue("Quote","VTEMP",-1,"GROUP_DESC",V.Args.Value)
			F.Data.DataView.Close("Quote","VTEMP")
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("UM = {0}","AS",V.Local.sFilter)
			F.Data.DataView.Create("Quote","VTEMP",22,V.Local.sFilter,"")
			F.Data.DataView.SetValue("Quote","VTEMP",-1,"GROUP_DESC",V.Args.Value)
			F.Data.DataView.Close("Quote","VTEMP")
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Case("GROUP_NO")
		F.Intrinsic.String.Build("Group_No = {0}",V.Args.Value,V.Local.sFilter)
		F.Data.DataView.Create("Quote","VTEMP",22,V.Local.sFilter,"")
		F.Intrinsic.Control.If(V.DataView.Quote!VTEMP.RowCount--,<>,-1)
			F.Intrinsic.Control.If(V.Args.RowIndex,<>,V.DataView.Quote!VTEMP(V.DataView.Quote!VTEMP.RowCount--).DataTableIndex)
				F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"Group_Desc",V.DataView.Quote!VTEMP(V.DataView.Quote!VTEMP.RowCount--).Group_Desc!FieldValTrim,"Group_Name",V.DataView.Quote!VTEMP(V.DataView.Quote!VTEMP.RowCount--).Group_Name!FieldValTrim)
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.DataView.Quote!VTEMP.RowCount--,>,0)
					F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"Group_Desc",V.DataView.Quote!VTEMP(0).Group_Desc!FieldValTrim,"Group_Name",V.DataView.Quote!VTEMP(0).Group_Name!FieldValTrim)
				F.Intrinsic.Control.Else
					F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"Group_Desc","","Group_Name","")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"Group_Desc","","Group_Name","")
		F.Intrinsic.Control.EndIf
		F.Data.DataView.Close("Quote","VTEMP")
	
	F.Intrinsic.Control.Case("SF_PRICE")
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","Group_No",V.Args.RowIndex,V.Local.sRet)
		F.Intrinsic.String.Build("Group_No = {0}",V.Local.sRet.Long,V.Local.sFilter)
		F.Data.DataView.Create("Quote","VTEMP",22,V.Local.sFilter,"")
		F.Data.DataView.SetValue("Quote","VTEMP",-1,"SF_PRICE",V.Args.Value)
		F.Intrinsic.Control.If(V.DataView.Quote!VTEMP(V.DataView.Quote!VTEMP.RowCount--).UM!FieldValTrim,=,"SF")
			F.Data.DataView.SetValue("Quote","VTEMP",-1,"UM_EACH",V.DataView.Quote!VTEMP(V.Local.iCol).SF_Each!FieldVal)
		F.Intrinsic.Control.EndIf
		F.Data.DataView.Close("Quote","VTEMP")
	
	F.Intrinsic.Control.Case("UM")
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","Group_No",V.Args.RowIndex,V.Local.sRet)
		F.Intrinsic.String.Build("Group_No = {0}",V.Local.sRet.Long,V.Local.sFilter)
		F.Data.DataView.Create("Quote","VTEMP",22,V.Local.sFilter,"")
		F.Data.DataView.SetValue("Quote","VTEMP",-1,"UM",V.Args.Value)
		F.Intrinsic.Control.If(V.Args.Value,=,"AS")
			F.Data.DataView.SetValue("Quote","VTEMP",-1,"UM_EACH","0")
			F.Intrinsic.UI.Msgbox("UM EACH will need to be Manually updated","Attention")
		F.Intrinsic.Control.ElseIf(V.Args.Value,=,"SF")
			F.Intrinsic.Control.For(V.Local.iCol,0,V.DataView.Quote!VTEMP.RowCount--,1)
				F.Data.DataView.SetValue("Quote","VTEMP",V.Local.iCol,"UM_EACH",V.DataView.Quote!VTEMP(V.Local.iCol).SF_Each!FieldVal)
			F.Intrinsic.Control.Next(V.Local.iCol)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.For(V.Local.iCol,0,V.DataView.Quote!VTEMP.RowCount--,1)
				F.Data.DataView.SetValue("Quote","VTEMP",V.Local.iCol,"UM_EACH",V.DataView.Quote!VTEMP(V.Local.iCol).Unit!FieldVal)
			F.Intrinsic.Control.Next(V.Local.iCol)
		F.Intrinsic.Control.EndIf
		F.Data.DataView.Close("Quote","VTEMP")
		
	F.Intrinsic.Control.Case("PL")
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","Group_No",V.Args.RowIndex,V.Local.sRet)
		F.Intrinsic.String.Build("Group_No = {0}",V.Local.sRet.Long,V.Local.sFilter)
		F.Data.DataView.Create("Quote","VTEMP",22,V.Local.sFilter,"")
		F.Data.DataView.SetValue("Quote","VTEMP",-1,"PL",V.Args.Value)
		F.Data.DataView.Close("Quote","VTEMP")
	
	F.Intrinsic.Control.Case("UNIT")
		F.Intrinsic.Control.If(V.DataTable.Quote(V.Args.RowIndex).UM!FieldValTrim,=,"EA")
			F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"UM_EACH",V.Args.Value)
		F.Intrinsic.Control.ElseIf(V.DataTable.Quote(V.Args.RowIndex).UM!FieldValTrim,=,"SF")
			F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"UM_EACH",V.DataTable.Quote(V.Args.RowIndex).SF_Each!FieldVal)
		F.Intrinsic.Control.EndIf
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("GsGridQuote_RowCellClick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.GsGridQuote_CellValueChanged.End

Program.Sub.cmdSave_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdSave_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sFieldMap.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sUser.Declare(String,"")

F.Intrinsic.UI.InvokeWaitDialog("Saving Quote Data.................")
Gui.FormQuote..Enabled(False)

V.Local.sFieldMap.Set("Quote@!@Quote*!*Customer@!@Customer*!*Line_Item@!@Line_Item*!*Unit@!@Unit*!*Sign_Router@!@Sign_Router*!*Message@!@Message*!*SF_Each@!@SF_Each*!*SF_Price@!@SF_Price*!*Group_No@!@Group_No*!*Group_Name@!@Group_Name*!*Group_Desc@!@Group_Desc*!*Order_No@!@Order_No*!*Order_Line@!@Order_Line*!*Customer_PO@!@Customer_PO*!*Job@!@Job*!*Suffix@!@Suffix*!*USERH1@!@USERH1*!*USERH3@!@USERH3*!*USERH4@!@USERH4*!*USERH5@!@USERH5*!*QUICK_QUOTE@!@QUICK_QUOTE*!*PL@!@PL*!*UM@!@UM*!*UM_EACH@!@UM_EACH")
F.Intrinsic.Control.For(V.Local.i,1,60,1)
	F.Intrinsic.String.Build("USER{0}",V.Local.i,V.Local.sUser)
	F.Intrinsic.String.Build("{0}*!*{1}@!@{1}",v.Local.sFieldMap,v.Local.sUser,V.Local.sFieldMap)
F.Intrinsic.Control.Next(V.Local.i)

F.Intrinsic.String.Build("Delete From GCG_6419_Quote Where Quote = '{0}'",V.Screen.FormQuote!txtCustQuote.Text,V.Local.sSql)
F.ODBC.Connection!con.OpenCompanyConnection
F.ODBC.Connection!Con.Execute(V.Local.sSql)
F.Intrinsic.Control.If(V.DataTable.Quote.RowCount--,<>,-1)
	F.Data.DataTable.SetValue("Quote",-1,"Quote",V.Screen.FormQuote!txtCustQuote.Text,"Customer",V.Screen.FormQuote!txtCust.Text,"Customer_PO",V.Screen.FormQuote!txtCustPO.Text,"USERH1",V.Screen.FormQuote!txtUser1.Text,"USERH3",V.Screen.FormQuote!txtUser3.Text,"USERH4",V.Screen.FormQuote!txtUser4.Text,"USERH5",V.Screen.FormQuote!txtUser5.Text)
	F.Data.DataTable.AcceptChanges("Quote")
	F.Data.DataTable.SaveToDB("Quote","con","GCG_6419_Quote","",128,V.Local.sFieldMap)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.If(V.DataTable.Quote(V.DataTable.Quote.RowCount--).Order_No!FieldValTrim,<>,"")
	Gui.FormQuote.ddlRouter.Enabled(False)
	Gui.FormQuote.ddlState.Enabled(False)
	Gui.FormQuote.txtCust.Enabled(False)
	Gui.FormQuote.txtLines.Enabled(False)
	Gui.FormQuote.txtCustPO.Enabled(False)
	Gui.FormQuote.dtpDueDate.Enabled(False)
	Gui.FormQuote.cmdAdd.Enabled(False)
	Gui.FormQuote.cmdCust.Enabled(False)
	Gui.FormQuote.cmdCreate.Enabled(False)
	Gui.FormQuote.cmdSave.Enabled(False)
	Gui.FormQuote.cmdNewMat.Enabled(False)
	Gui.FormQuote.cmdOldMat.Enabled(False)
	Gui.FormQuote.cmdUpMat.Enabled(False)
	V.Global.bEditable.Set(False)
F.Intrinsic.Control.EndIf

Gui.FormQuote..Enabled(True)
F.Intrinsic.UI.CloseWaitDialog

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdSave_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(False)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdSave_Click.End

Program.Sub.cmdLRout_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdLRout_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sMode.Declare(String,"")
V.Local.sRouter.Declare(STring,"")

V.Local.sRouter.Set(V.Screen.FormQuote!ddlRouter.Text)

Gui.FormQuote..Enabled(False)
F.Intrinsic.Control.If(V.Screen.FormQuote!optC.Value,=,True)
	V.Local.sMode.Set("C")
F.Intrinsic.Control.ElseIf(V.Screen.FormQuote!optE.Value,=,True)
	V.Local.sMode.Set("O")
F.Intrinsic.Control.ElseIf(V.Screen.FormQuote!optV.Value,=,True)
	V.Local.sMode.Set("V")
F.Intrinsic.Control.Else
	Gui.FormQuote..Enabled(True)
	Gui.FormQuote..AlwaysOnTop(True)
	Gui.FormQuote..AlwaysOnTop(False)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Data.DataTable.AddRow("400000","Mode",V.Local.sMode,"Router",V.Local.sRouter.Trim)

F.Intrinsic.Control.CallSub(400000Sync)

F.Intrinsic.Control.CallSub(ddlState_Change)

Gui.FormQuote.ddlRouter.Text(V.Local.sRouter.Trim)
Gui.FormQuote..Enabled(True)

Gui.FormQuote..AlwaysOnTop(True)
Gui.FormQuote..AlwaysOnTop(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdLRout_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdLRout_Click.End

Program.Sub.txtUser3_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtUser3_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtUser3.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtUser3_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtUser3_GotFocus.End

Program.Sub.txtUser4_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtUser4_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtUser4.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtUser4_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtUser4_GotFocus.End

Program.Sub.txtUser5_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtUser5_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtUser5.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtUser5_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtUser5_GotFocus.End

Program.Sub.cmdUser3_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdUser3_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")
V.Local.sRet.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.Intrinsic.String.Build("Select KEY_VALUE From OE_USER_VALUES Where (CUST = '{0}' OR CUST <= '') and HDR_FLAG = 'H' AND USER_NO = '3'",V.Screen.FormQuote!txtCust.Text,V.Local.sSql) 
V.Local.sTitles.Set("User Value")
V.Local.sWidths.Set("6250")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.ODBC.Connection!Con.OpenCompanyConnection

F.Intrinsic.UI.Browser("Select Quote","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,9000,V.Local.sRet)

F.ODBC.Connection!Con.Close
	
F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	Gui.FormQuote.txtUser3.Text(V.Local.sRet.Trim)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdUser3_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdUser3_Click.End

Program.Sub.cmdUser4_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdUser4_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")
V.Local.sRet.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.Intrinsic.String.Build("Select KEY_VALUE From OE_USER_VALUES Where (CUST = '{0}' OR CUST <= '') and HDR_FLAG = 'H' AND USER_NO = '4'",V.Screen.FormQuote!txtCust.Text,V.Local.sSql) 
V.Local.sTitles.Set("User Value")
V.Local.sWidths.Set("6250")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.ODBC.Connection!Con.OpenCompanyConnection

F.Intrinsic.UI.Browser("Select Quote","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,9000,V.Local.sRet)

F.ODBC.Connection!Con.Close
	
F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	Gui.FormQuote.txtUser4.Text(V.Local.sRet.Trim)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdUser4_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdUser4_Click.End

Program.Sub.cmdUser5_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdUser5_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")
V.Local.sRet.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.Intrinsic.String.Build("Select KEY_VALUE From OE_USER_VALUES Where (CUST = '{0}' OR CUST <= '') and HDR_FLAG = 'H' AND USER_NO = '5'",V.Screen.FormQuote!txtCust.Text,V.Local.sSql) 
V.Local.sTitles.Set("User Value")
V.Local.sWidths.Set("6250")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.ODBC.Connection!Con.OpenCompanyConnection

F.Intrinsic.UI.Browser("Select Quote","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,9000,V.Local.sRet)

F.ODBC.Connection!Con.Close
	
F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	Gui.FormQuote.txtUser5.Text(V.Local.sRet.Trim)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdUser5_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdUser5_Click.End

Program.Sub.txtUser1_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtUser1_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtUser1.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtUser1_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtUser1_GotFocus.End

Program.Sub.cmdUser1_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdUser1_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")
V.Local.sRet.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.Intrinsic.String.Build("Select KEY_VALUE From OE_USER_VALUES Where (CUST = '{0}' OR CUST <= '') and HDR_FLAG = 'H' AND USER_NO = '1'",V.Screen.FormQuote!txtCust.Text,V.Local.sSql) 
V.Local.sTitles.Set("User Value")
V.Local.sWidths.Set("6250")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.ODBC.Connection!Con.OpenCompanyConnection

F.Intrinsic.UI.Browser("Select Quote","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,9000,V.Local.sRet)

F.ODBC.Connection!Con.Close
	
F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	Gui.FormQuote.txtUser1.Text(V.Local.sRet.Trim)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdUser1_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdUser1_Click.End

Program.Sub.cmdGenQuote_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdGenQuote_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sDueDate.Declare(String,"")
V.Local.sOrderDate.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.sWOFile.Declare(String,"")
V.Local.sDate.Declare(String,"")
V.Local.sFile.Declare(String,"")
V.Local.sLocal.Declare(String,"")
V.Local.sData.Declare(String,"")
V.Local.iC.Declare(Long,0)
V.Local.sFilter.Declare(String,"")
V.Local.fSF.Declare(Float,0)
V.Local.fTSF.Declare(Float,0)
V.Local.fSFExt.Declare(Float,0)
V.Local.fTemp.Declare(Float,0)
V.Local.sQty.Declare(String,"")
V.Local.sCost.Declare(String,"")
V.Local.fUnit.Declare(Float,0)
V.Local.sUser1.Declare(String,"")
V.Local.sUser3.Declare(String,"")
V.Local.sUser4.Declare(String,"")
V.Local.sUser5.Declare(String,"")
V.Local.sMsg.Declare(String,"")
V.Local.sTemp.Declare(STring,"")
V.Local.fEachQty.Declare(Float,0)

V.Local.sUser1.Set(V.Screen.FormQuote!txtUser1.Text)
V.Local.sUser3.Set(V.Screen.FormQuote!txtUser3.Text)
V.Local.sUser4.Set(V.Screen.FormQuote!txtUser4.Text)
V.Local.sUser5.Set(V.Screen.FormQuote!txtUser5.Text)
F.Intrinsic.Control.If(V.Local.sUser1.Trim,=,"")
	F.Intrinsic.String.Build("{0} must be filled in.",V.Screen.FormQuote!lblUser1.Caption,V.Local.sTemp)
	V.Local.sMsg.Set(V.Local.sTemp)
F.Intrinsic.Control.ElseIf(V.Local.sUser3.Trim,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		F.Intrinsic.String.Build("{0} must be filled in.",V.Screen.FormQuote!lblUser3.Caption,V.Local.sTemp)
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}{1}{2} must be filled in.",V.Local.sMsg,V.Ambient.NewLine,V.Screen.FormQuote!lblUser3.Caption,V.Local.sTemp)
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.ElseIf(V.Local.sUser4.Trim,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		F.Intrinsic.String.Build("{0} must be filled in.",V.Screen.FormQuote!lblUser4.Caption,V.Local.sTemp)
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}{1}{2} must be filled in.",V.Local.sMsg,V.Ambient.NewLine,V.Screen.FormQuote!lblUser4.Caption,V.Local.sTemp)
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.ElseIf(V.Local.sUser5.Trim,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		F.Intrinsic.String.Build("{0} must be filled in.",V.Screen.FormQuote!lblUser5.Caption,V.Local.sTemp)
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}{1}{2} must be filled in.",V.Local.sMsg,V.Ambient.NewLine,V.Screen.FormQuote!lblUser5.Caption,V.Local.sTemp)
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Local.sMsg.Trim,<>,"")
	F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Attention")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf


F.Intrinsic.String.Format(V.Screen.FormQuote!dtpDueDate.Value,"YYYYMMDD",V.Local.sDueDate)
F.Intrinsic.String.Format(V.Ambient.Date,"YYYYMMDD",V.Local.sOrderDate)

Gui.FormQuote..Enabled(False)

F.ODBC.Connection!Con.OpenCompanyConnection

F.Intrinsic.UI.InvokeWaitDialog("Creating Quick Quote.........................")

F.Intrinsic.String.Build("Select Name_Customer_Ship, Address1_Ship, Address2_Ship, City_Ship, State_Ship, Code_Zip_Ship From V_Customer_ShipTo Where Customer = '{0}'",V.Screen.FormQuote!txtCust.Text,V.Local.sSql)
F.Intrinsic.Control.If(V.DataTable.Cust.Exists)
	F.Data.DataTable.Close("Cust")
F.Intrinsic.Control.EndIf
F.Data.DataTable.CreateFromSQL("Cust","con",V.Local.sSql,True)
F.Data.DataTable.AddRow("ORDUPL","Transaction","Q","CustomerNO",V.Screen.FormQuote!txtCust.Text,"OrderDueDate",V.Local.sDueDate,"OrderDate",V.Local.sOrderDate,"CustomerPO",V.Screen.FormQuote!txtCustPO.Text,"SHIPToName",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Name_Customer_Ship!FieldValTrim,"ShipToAddress1",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Address1_Ship!FieldValTrim,"ShipToAddress2",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Address2_Ship!FieldValTrim,"ShipToCity",V.DataTable.Cust(V.DataTable.Cust.RowCount--).City_Ship!FieldValTrim,"ShipToState",V.DataTable.Cust(V.DataTable.Cust.RowCount--).State_Ship!FieldValTrim,"ShipToZip",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Code_Zip_Ship!FieldValTrim,"UserField1Head",V.Local.sUser1.Trim,"UserField3Head",V.Local.sUser3.Trim,"UserField4Head",V.Local.sUser4.Trim,"UserField5Head",V.Local.sUser5.Trim)

F.Data.DataView.Create("Quote","TempSF",22,"TOTL_SF is null or TOTL_SF <= 0","")
F.Intrinsic.Control.If(V.DataView.Quote!TempSF.RowCount--,<>,-1)
	F.Intrinsic.UI.Msgbox("Total SF needs to be filled out for each sign and be > 0","Attention")
	F.Data.DataView.Close("Quote","TempSF")
	Gui.FormQuote..Enabled(True)
	F.ODBC.Connection!Con.Close
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
F.Data.DataView.Close("Quote","TempSF")

F.Data.DataView.Create("Quote","TempUnit",22,"Unit is null or Unit <= 0","")
F.Intrinsic.Control.If(V.DataView.Quote!TempUnit.RowCount--,<>,-1)
	F.Intrinsic.UI.Msgbox("Units needs to be filled out for each sign and be > 0","Attention")
	F.Data.DataView.Close("Quote","TempUnit")
	Gui.FormQuote..Enabled(True)
	F.ODBC.Connection!Con.Close
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
F.Data.DataView.Close("Quote","TempUnit")

F.Data.DataView.Create("Quote","Temp",22,"","")
F.Intrinsic.Control.If(V.DataTable.Temp.Exists)
	F.Data.DataTable.Close("Temp")
F.Intrinsic.Control.EndIf
F.Data.DataView.ToDataTableDistinct("Quote","Temp","Temp","Group_No*!*UM",True)
F.Data.DataView.Close("Quote","Temp")
F.Data.DataView.Create("Temp","VTemp",22,"UM = 'SF'","")
F.Intrinsic.Control.For(V.Local.i,0,V.DataView.Temp!VTemp.RowCount--,1)
	F.Intrinsic.String.Build("Group_No = '{0}'",V.DataView.Temp!VTemp(V.Local.i).Group_No!FieldVal,V.Local.sFilter)
	F.Data.DataView.Create("Quote","Temp",22,V.Local.sFilter,"")
	V.Local.fSFExt.Set(0)
	V.Local.fTSF.Set(0)
	F.Intrinsic.Control.For(V.Local.iC,0,V.DataView.Quote!Temp.RowCount--,1)
		F.Intrinsic.Math.Add(V.DataView.Quote!Temp(V.Local.iC).TOTL_SF!FieldVal,V.Local.fTSF,V.Local.fTSF)
		F.Intrinsic.Math.Mult(V.DataView.Quote!Temp(V.Local.iC).SF_PRICE!FieldVal,V.DataView.Quote!Temp(V.Local.iC).TOTL_SF!FieldVal,V.Local.fTemp)
		F.Intrinsic.Math.Div(V.Local.fTemp,V.DataView.Quote!Temp(V.Local.iC).Unit!FieldVal,V.Local.fUnit)
		F.Intrinsic.Math.Add(V.Local.fTemp,V.Local.fSFExt,V.Local.fSFExt)
		F.Intrinsic.Math.Mult(V.DataView.Quote!Temp(V.Local.iC).Unit!FieldVal,10000,V.Local.sQty.Long)
		F.Intrinsic.String.Format(V.Local.fUnit,"0.0000",V.Local.sCost)
		F.Intrinsic.Math.Mult(V.Local.sCost.Float,1000000,V.Local.sCost)
		F.Intrinsic.String.LPad(V.Local.sQty,"0",13,V.Local.sQty)
		F.Intrinsic.String.LPad(V.Local.sCost,"0",13,V.Local.sCost)
		'adding so lines to sales order, these are the so line that is used for creating wo's
'		F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","EA","PartNumber",V.DataView.Quote!Temp(V.Local.iC).Sign_Router!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.Local.iC).MESSAGE!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL",V.DataView.Quote!Temp(V.Local.iC).PL!FieldVal,"UserField1","","UserField5",V.DataView.Quote!Temp(V.Local.iC).Line_Item!FieldVal,"Router",V.DataView.Quote!Temp(V.Local.iC).Sign_Router!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
		F.Intrinsic.Control.If(V.Local.iC,=,V.DataView.Quote!Temp.RowCount--)
			F.Intrinsic.Math.Div(V.Local.fSFExt,V.Local.fTSF,V.Local.fSF)
			F.Intrinsic.Math.Mult(V.Local.fTSF,10000,V.Local.sQty)
			F.Intrinsic.String.Format(V.Local.fSF,"0.0000",V.Local.sCost)
			F.Intrinsic.Math.Mult(V.Local.sCost.Float,1000000,V.Local.sCost)
			F.Intrinsic.String.LPad(V.Local.sQty,"0",13,V.Local.sQty)
			F.Intrinsic.String.LPad(V.Local.sCost,"0",13,V.Local.sCost)
			'adding total sf for signs within a same group these are the lines that will be invoiced.
			F.Intrinsic.Control.If(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"FX")
				F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","SF","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","FS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
			F.Intrinsic.Control.ElseIf(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"GX")
				F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","SF","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","GS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
			F.Intrinsic.Control.ElseIf(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"OX")
				F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","SF","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","OS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
			F.Intrinsic.Control.Else
				F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","SF","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iC)
	F.Data.DataView.Close("Quote","Temp")
F.Intrinsic.Control.Next(V.Local.i)
F.Data.DataView.Close("Temp","VTemp")

F.Data.DataView.Create("Temp","VTemp",22,"UM = 'EA'","")
F.Intrinsic.Control.For(V.Local.i,0,V.DataView.Temp!VTemp.RowCount--,1)
	F.Intrinsic.String.Build("Group_No = '{0}'",V.DataView.Temp!VTemp(V.Local.i).Group_No!FieldVal,V.Local.sFilter)
	F.Data.DataView.Create("Quote","Temp",22,V.Local.sFilter,"")
	V.Local.fSFExt.Set(0)
	V.Local.fTSF.Set(0)
	F.Intrinsic.Control.For(V.Local.iC,0,V.DataView.Quote!Temp.RowCount--,1)
		F.Intrinsic.Math.Add(V.DataView.Quote!Temp(V.Local.iC).TOTL_SF!FieldVal,V.Local.fTSF,V.Local.fTSF)
		F.Intrinsic.Math.Mult(V.DataView.Quote!Temp(V.Local.iC).SF_PRICE!FieldVal,V.DataView.Quote!Temp(V.Local.iC).TOTL_SF!FieldVal,V.Local.fTemp)
		F.Intrinsic.Math.Div(V.Local.fTemp,V.DataView.Quote!Temp(V.Local.iC).Unit!FieldVal,V.Local.fUnit)
		F.Intrinsic.Math.Add(V.Local.fTemp,V.Local.fSFExt,V.Local.fSFExt)
		F.Intrinsic.Math.Mult(V.DataView.Quote!Temp(V.Local.iC).Unit!FieldVal,10000,V.Local.sQty.Long)
		F.Intrinsic.Math.Add(V.DataView.Quote!Temp(V.Local.iC).Unit!FieldVal,V.Local.fEachQty,V.Local.fEachQty)
		F.Intrinsic.String.Format(V.Local.fUnit,"0.0000",V.Local.sCost)
		F.Intrinsic.Math.Mult(V.Local.sCost.Float,1000000,V.Local.sCost)
		F.Intrinsic.String.LPad(V.Local.sQty,"0",13,V.Local.sQty)
		F.Intrinsic.String.LPad(V.Local.sCost,"0",13,V.Local.sCost)
		'adding so lines to sales order, these are the so line that is used for creating wo's
'		F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","EA","PartNumber",V.DataView.Quote!Temp(V.Local.iC).Sign_Router!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.Local.iC).MESSAGE!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL",V.DataView.Quote!Temp(V.Local.iC).PL!FieldVal,"UserField1","","UserField5",V.DataView.Quote!Temp(V.Local.iC).Line_Item!FieldVal,"Router",V.DataView.Quote!Temp(V.Local.iC).Sign_Router!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
		F.Intrinsic.Control.If(V.Local.iC,=,V.DataView.Quote!Temp.RowCount--)
			F.Intrinsic.Math.Div(V.Local.fSFExt,V.Local.fTSF,V.Local.fSF)
			F.Intrinsic.Math.Mult(V.Local.fEachQty,10000,V.Local.sQty)
			F.Intrinsic.String.Format(V.Local.fSF,"0.0000",V.Local.sCost)
			F.Intrinsic.Math.Mult(V.Local.sCost.Float,1000000,V.Local.sCost)
			F.Intrinsic.String.LPad(V.Local.sQty,"0",13,V.Local.sQty)
			F.Intrinsic.String.LPad(V.Local.sCost,"0",13,V.Local.sCost)
			'adding total sf for signs within a same group these are the lines that will be invoiced.
			F.Intrinsic.Control.If(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"FX")
				F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","EA","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","FS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
			F.Intrinsic.Control.ElseIf(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"GX")
				F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","EA","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","GS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
			F.Intrinsic.Control.ElseIf(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"OX")
				F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","EA","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","OS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
			F.Intrinsic.Control.Else
				F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","EA","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iC)
	F.Data.DataView.Close("Quote","Temp")
F.Intrinsic.Control.Next(V.Local.i)
F.Data.DataView.Close("Temp","VTemp")

F.Data.DataView.Create("Temp","VTemp",22,"UM = 'AS'","")
V.Local.fSFExt.Set(0)
V.Local.fTSF.Set(0)
F.Intrinsic.Control.For(V.Local.i,0,V.DataView.Temp!VTemp.RowCount--,1)
	F.Intrinsic.String.Build("Group_No = '{0}'",V.DataView.Temp!VTemp(V.Local.i).Group_No!FieldVal,V.Local.sFilter)
	F.Data.DataView.Create("Quote","Temp",22,V.Local.sFilter,"")
	F.Intrinsic.Control.For(V.Local.iC,0,V.DataView.Quote!Temp.RowCount--,1)
		F.Intrinsic.Math.Add(V.DataView.Quote!Temp(V.Local.iC).TOTL_SF!FieldVal,V.Local.fTSF,V.Local.fTSF)
		F.Intrinsic.Math.Mult(V.DataView.Quote!Temp(V.Local.iC).SF_PRICE!FieldVal,V.DataView.Quote!Temp(V.Local.iC).TOTL_SF!FieldVal,V.Local.fTemp)
		F.Intrinsic.Math.Div(V.Local.fTemp,V.DataView.Quote!Temp(V.Local.iC).Unit!FieldVal,V.Local.fUnit)
		F.Intrinsic.Math.Add(V.Local.fTemp,V.Local.fSFExt,V.Local.fSFExt)
		F.Intrinsic.Math.Mult(V.DataView.Quote!Temp(V.Local.iC).Unit!FieldVal,10000,V.Local.sQty.Long)
		F.Intrinsic.Math.Add(V.DataView.Quote!Temp(V.Local.iC).Unit!FieldVal,V.Local.fEachQty,V.Local.fEachQty)
		F.Intrinsic.String.Format(V.Local.fUnit,"0.0000",V.Local.sCost)
		F.Intrinsic.Math.Mult(V.Local.sCost.Float,1000000,V.Local.sCost)
		F.Intrinsic.String.LPad(V.Local.sQty,"0",13,V.Local.sQty)
		F.Intrinsic.String.LPad(V.Local.sCost,"0",13,V.Local.sCost)
		'adding so lines to sales order, these are the so line that is used for creating wo's
'		F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","EA","PartNumber",V.DataView.Quote!Temp(V.Local.iC).Sign_Router!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.Local.iC).MESSAGE!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL",V.DataView.Quote!Temp(V.Local.iC).PL!FieldVal,"UserField1","","UserField5",V.DataView.Quote!Temp(V.Local.iC).Line_Item!FieldVal,"Router",V.DataView.Quote!Temp(V.Local.iC).Sign_Router!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
	F.Intrinsic.Control.Next(V.Local.iC)
	F.Intrinsic.Control.If(V.Local.i,=,V.DataView.Temp!VTemp.RowCount--)
		F.Intrinsic.Math.Div(V.Local.fSFExt,V.Local.fTSF,V.Local.fSF)
		F.Intrinsic.Math.Mult(V.DataView.Temp!VTemp.RowCount,10000,V.Local.sQty)
		F.Intrinsic.String.Format(V.Local.fSF,"0.0000",V.Local.sCost)
		F.Intrinsic.Math.Mult(V.Local.sCost.Float,1000000,V.Local.sCost)
		F.Intrinsic.String.LPad(V.Local.sQty,"0",13,V.Local.sQty)
		F.Intrinsic.String.LPad(V.Local.sCost,"0",13,V.Local.sCost)
		'adding total sf for signs within a same group these are the lines that will be invoiced.
		F.Intrinsic.Control.If(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"FX")
			F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","AS","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","FS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
		F.Intrinsic.Control.ElseIf(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"GX")
			F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","AS","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","GS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
		F.Intrinsic.Control.ElseIf(V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).PL!FieldVal,=,"OX")
			F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","AS","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","OS","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
		F.Intrinsic.Control.Else
			F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","AS","PartNumber",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Desc!FieldVal,"LineOrderDate",V.Local.sOrderDate,"PL","","UserField1","","Router",V.DataView.Quote!Temp(V.DataView.Quote!Temp.RowCount--).Group_Name!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.Data.DataView.Close("Quote","Temp")
F.Intrinsic.Control.Next(V.Local.i)
F.Data.DataView.Close("Temp","VTemp")

F.Data.DataTable.Close("Temp")

F.Intrinsic.Control.If(V.DataTable.ORDUPL.RowCount--,<>,-1)
	F.Intrinsic.Control.CallSub(ORDUPLCreateFile)
	F.Intrinsic.Control.CallSub(ORDUPLSync)
F.Intrinsic.Control.EndIf

F.Data.DataTable.AcceptChanges("ORDUPL")
F.Data.DataTable.AcceptChanges("ORDUPLExtra")
F.Data.DataTable.AcceptChanges("ORDUPLLines")

F.Intrinsic.UI.Sleep(2)

F.Intrinsic.String.Build("Select Top 1 Quote_No From V_Quote_Header Where Customer_PO = '{0}' and Last_Chg_By = '{1}' Order by Date_Last_Chg Desc,Time_Last_Chg Desc",V.Screen.FormQuote!txtCustPO.text,V.Caller.User,V.Local.sSql)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)

F.Data.DataTable.SetValue("Quote",-1,"QUICK_QUOTE",V.Local.sRet.Trim)

Gui.FormQuote.lblQQ.Caption(V.Local.sRet.Trim)

F.ODBC.Connection!Con.Close

F.Intrinsic.UI.CloseWaitDialog

F.Intrinsic.Control.CallSub(cmdSave_Click)

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
	F.Data.DataTable.AddRow("251000","QuoteNo",V.Local.sRet.Trim,"Mode","O")
	F.Intrinsic.Control.CallSub(251000Sync)
	F.Data.DataTable.DeleteRow("251000")
	F.Data.DataTable.AcceptChanges("251000")
F.Intrinsic.Control.EndIf

Gui.FormQuote..Enabled(True)

Gui.FormQuote.cmdGenQuote.Enabled(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdGenQuote_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdGenQuote_Click.End

Program.Sub.Create_ContextMenu.Start
F.Intrinsic.Control.SetErrorHandler("Create_ContextMenu_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote..ContextMenuCreate("CGQ")
Gui.FormQuote.GsGridQuote.ContextMenuAttach("CGQ")
Gui.FormQuote..ContextMenuAddItem("CGQ","COMMIT ROUTER",0,"Commit UFs to Other Routers")
Gui.FormQuote..ContextMenuAddItem("CGQ","PASTE MESSAGE",0,"Paste Message(s) From Excel")
Gui.FormQuote..ContextMenuAddItem("CGQ","COPY LINE INFO",0,"Copy Line Info")
Gui.FormQuote..ContextMenuAddItem("CGQ","PASTE LINE INFO",0,"Paste Line Info")
Gui.FormQuote..ContextMenuSetItemEventHandler("CGQ","COMMIT ROUTER","Menu_Click")
Gui.FormQuote..ContextMenuSetItemEventHandler("CGQ","PASTE MESSAGE","Menu_Click_Paste")
Gui.FormQuote..ContextMenuSetItemEventHandler("CGQ","COPY LINE INFO","Menu_Click_Copy_Line")
Gui.FormQuote..ContextMenuSetItemEventHandler("CGQ","PASTE LINE INFO","Menu_Click_Paste_Line")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Create_ContextMenu_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Create_ContextMenu.End

Program.Sub.Menu_Click.Start
F.Intrinsic.Control.SetErrorHandler("Menu_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRow.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.iCol.Declare(Long,0)
V.Local.sSql.Declare(String,"")
V.Local.sUser.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sCaption.Declare(String,"")
V.Local.sFilter.Declare(String,"")

V.Global.bSave.Set(False)

Gui.FormQuote.GsGridQuote.GetSelectedRows("GQuote",V.Local.sRow)
Gui.FormQuote.GsGridQuote.GetColumnIndexByName("GQuote","SIGN_ROUTER",V.Local.iCol)

'bring up the userfield screen for mass update of userfield and committing to selected routers
F.Intrinsic.Control.If(V.Local.sRow,<>,"")
	Gui.FormQuote..Enabled(False)
	Gui.FormQuote.GsGridQuote.GetCellValue("GQuote",V.Local.iCol,V.Local.sRow.Long,V.Local.sRouter)
	F.Intrinsic.String.Build("SIGN_ROUTER = '{0}'",V.Local.sRouter,V.Local.sFilter)
	F.Data.DataView.Create("Quote","VQuote",22,V.Local.sFilter,"")
	V.Local.sRouter.Set(V.Local.sRouter.UCase)
	F.Data.DataTable.SetValue("UserFields",-1,"Router",V.Local.sRouter)
	
	F.Intrinsic.String.Build("Router User Fields - {0}",V.Local.sRouter,V.Local.sCaption)
	Gui.FormRouter.lblUserFields.Caption(V.Local.sCaption)
	F.ODBC.Connection!Con.OpenCompanyConnection

	F.Intrinsic.String.Build("Select rtrim(Router) as Router From V_Router_Header where Router like '{0}%'",V.Local.sRouter.Left2,V.Local.sSql)
	F.Data.DataTable.CreateFromSQL("TempR","con",V.Local.sSql,True)
	F.Data.DataTable.Merge("TempR","Routers",False,4)
	F.Data.DataTable.Close("TempR")
	F.Data.DataTable.SetValue("Routers",-1,"Selection",False)
	F.Intrinsic.String.Build("ROUTER = '{0}'",V.Local.sRouter,V.Local.sFilter)
	F.Data.DataView.Create("Routers","VTemp",22,V.Local.sFilter,"")
	F.Data.DataView.SetValue("Routers","VTemp",-1,"SELECTION",True)
	F.Data.DataView.Close("Routers","VTemp")
	V.Local.sRouter.Set(V.Local.sRouter.Trim)
	F.Intrinsic.String.Build("Select * From GCG_6313_RTR_EXTRA where ucase(Router) = '{0}'",V.Local.sRouter.UCase,V.Local.sSql)
	F.Data.DataTable.CreateFromSQL("TempR","con",V.Local.sSql,True)
	F.Intrinsic.Control.If(V.DataTable.TempR.RowCount--,<>,-1)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.UserFields.RowCount--,1)
			F.Intrinsic.Math.Add(V.Local.i,1,V.Local.iCol)
			F.Intrinsic.String.Build("USER{0}",V.Local.iCol,V.Local.sUser)
			F.Data.DataTable.SetValue("UserFields",V.Local.i,"Value",V.DataTable.TempR(V.DataTable.TempR.RowCount--).[V.Local.sUser]!FieldValTrim)
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.EndIf
	F.Data.DataTable.Close("TempR")
	F.ODBC.Connection!Con.Close
	Gui.FormRouter..Show

	Gui.FormRouter..WaitForDismiss
	F.Data.DataView.Close("Quote","VQuote")
	F.Intrinsic.Control.If(V.Global.bSave)
		F.Intrinsic.Control.CallSub(cmdSave_Click)
	F.Intrinsic.Control.EndIf
	Gui.FormQuote..Enabled(True)
	Gui.FormQuote..AlwaysOnTop(True)
	Gui.FormQuote..AlwaysOnTop(False)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Menu_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Menu_Click.End

Program.Sub.FormRouter_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("FormRouter_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

F.Data.DataTable.DeleteRow("Routers")
F.Data.DataTable.AcceptChanges("Routers")
F.Data.DataTable.SetValue("UserFields",-1,"Router",False,"Value","")

Gui.FormRouter..Enabled(True)

Gui.FormRouter..Visible(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormRouter_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.FormRouter_UnLoad.End

Program.Sub.cmdCommit_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdCommit_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.iR.Declare(Long,0)
V.Local.sRouter.Declare(String,"")
V.Local.sFields.Declare(String,"")
V.Local.sFieldMap.Declare(String,"")

Gui.FormRouter..Enabled(False)

'committing user field changes to the selected routers and select user fields
F.Intrinsic.Control.If(V.DataView.Routers!VRouters.RowCount--,<>,-1)
	F.Intrinsic.Control.If(V.DataView.UserFields!VUserFields.RowCount--,<>,-1)
		F.Data.DataView.ToString("UserFields","VUserFields","UserField",V.Ambient.NewLine,",",V.Local.sFields)
		F.ODBC.Connection!Con.OpenCompanyConnection
		F.Intrinsic.Control.For(V.Local.iR,0,V.DataView.Routers!VRouters.RowCount--)
			V.Local.sRouter.Set(V.DataView.Routers!VRouters(V.Local.iR).Router!FieldValTrim)
			F.Intrinsic.String.Build("Select rtrim(Router) as Router, {0} From GCG_6313_RTR_EXTRA Where ucase(Router) = '{1}'",V.Local.sFields,V.Local.sRouter.UCase,V.Local.sSql)
			F.Data.DataTable.CreateFromSQL("Extra","con",V.Local.sSql,True)
			F.Intrinsic.Control.For(V.Local.i,0,V.DataView.UserFields!VUserFields.RowCount--,1)
				F.Intrinsic.Control.If(V.Local.i,=,0)
					F.Intrinsic.String.Build("{0}@!@!{0}",V.DataView.UserFields!VUserFields(V.Local.i).UserField!FieldValTrim,V.Local.sFieldMap)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}*!*{1}@!@!{1}",V.Local.sFieldMap,V.DataView.UserFields!VUserFields(V.Local.i).UserField!FieldValTrim,V.Local.sFieldMap)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.DataTable.Extra.RowCount--,<>,-1)
					F.Data.DataTable.SetValue("Extra",-1,V.DataView.UserFields!VUserFields(V.Local.i).UserField!FieldValTrim,V.DataView.UserFields!VUserFields(V.Local.i).Value!FieldValTrim)
				F.Intrinsic.Control.Else
					F.Data.DataTable.AddRow("Extra","Router",V.Local.sRouter,V.DataView.UserFields!VUserFields(V.Local.i).UserField!FieldValTrim,V.DataView.UserFields!VUserFields(V.Local.i).Value!FieldValTrim)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.DataView.Quote!VQuote.RowCount--,<>,-1)
					F.Data.DataView.SetValue("Quote","VQuote",-1,V.DataView.UserFields!VUserFields(V.Local.i).UserField!FieldValTrim,V.DataView.UserFields!VUserFields(V.Local.i).Value!FieldValTrim)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.i)
			F.Data.DataTable.SaveToDB("Extra","con","GCG_6313_RTR_EXTRA","Router",3)
			F.Data.DataTable.Close("Extra")
		F.Intrinsic.Control.Next(V.Local.iR)
		F.ODBC.Connection!Con.Close
		V.Global.bSave.Set(True)
		F.Intrinsic.Control.CallSub(FormRouter_UnLoad)
	F.Intrinsic.Control.Else
		F.Intrinsic.UI.Msgbox("No User Fields have been Selected","Attention")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.DataView.UserFields!VUserFields.RowCount--,<>,-1)
		F.Intrinsic.UI.Msgbox("No Routers have been Selected","Attention")
	F.Intrinsic.Control.Else
		F.Intrinsic.UI.Msgbox("No Routers and User Fields have been Selected","Attention")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

Gui.FormRouter..Enabled(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdCommit_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdCommit_Click.End

Program.Sub.ddlRouter_Change.Start
F.Intrinsic.Control.SetErrorHandler("ddlRouter_Change_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtLines.Text("1")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlRouter_Change_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlRouter_Change.End

Program.Sub.cmdRout_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdRout_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.sState.Declare(String,"")

V.Local.sState.Set(V.Screen.FormQuote!ddlState.Text)
F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.SetBrowserOOT(True)

F.Intrinsic.Control.If(V.Local.sState.Trim,=,"")
	F.Intrinsic.UI.Msgbox("Select a State")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

'F.Intrinsic.String.Build("Select rtrim(ucase(A.Router)), B.User2 as Message, B.User5 as Size, B.User8 as Punch From V_ROUTER_HEADER A Left Join GCG_6313_RTR_Extra B on rtrim(ucase(A.Router)) = rtrim(ucase(B.Router)) Where ucase(A.Router) like '{0}%' Order by A.Router",V.Screen.FormQuote!ddlState.Text,V.Local.sSql)
F.Intrinsic.String.Build("Select rtrim(ucase(B.Router)), B.User2 as Message, B.User5 as Size, B.User8 as Punch From GCG_6313_RTR_Extra B Where ucase(B.Router) like '{0}%' or ucase(B.Router) like '00%' Order by B.Router",V.Screen.FormQuote!ddlState.Text,V.Local.sSql)
V.Local.sTitles.Set("Router*!*Message*!*Size*!*Punch")
V.Local.sWidths.Set("1800*!*2400*!*1500*!*1500")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.ODBC.Connection!ConX.OpenCompanyConnection

F.Intrinsic.UI.Browser("Select Router","conX",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,9000,V.Local.sRet)

F.ODBC.Connection!ConX.Close
	
F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	V.Local.sRet.Set(V.Local.sRet.Trim)
	Gui.FormQuote.ddlRouter.Text(V.Local.sRet.UCase)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdRout_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdRout_Click.End

Program.Sub.Menu_Click_Paste.Start
F.Intrinsic.Control.SetErrorHandler("Menu_Click_Paste_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sMsg.Declare(String,"")
V.Local.iIndex.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.sRow.Declare(String,"")
V.Local.iCol.Declare(Long,0)
V.Local.sRouter.Declare(String,"")
V.Local.sGroup.Declare(String,"")
V.Local.sRouterTemp.Declare(String,"")
V.Local.sGroupTemp.Declare(String,"")

Gui.FormQuote.GsGridQuote.GetSelectedRows("GQuote",V.Local.sRow)
F.Intrinsic.String.Split(V.Local.sRow,"*!*",V.Local.sRow)
V.Local.iIndex.Set(V.Local.sRow.Long)

Gui.FormQuote.GsGridQuote.GetColumnIndexByName("GQuote","MESSAGE",V.Local.iCol)

Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","GROUP_NO",V.Local.iIndex,V.Local.sGroup)
Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","SIGN_ROUTER",V.Local.iIndex,V.Local.sRouter)

f.Intrinsic.UI.GetClipboardText(V.Local.sMsg)

F.Intrinsic.String.Split(V.Local.sMsg,V.Ambient.NewLine,V.Local.sMsg)

F.Intrinsic.Control.For(V.Local.i,0,V.Local.sMsg.UBound,1)
	F.Intrinsic.Control.If(V.Local.iIndex,>,V.DataTable.Quote.RowCount--)
		F.Intrinsic.Control.ExitFor(V.Local.i)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Local.i,=,0)
		Gui.FormQuote.GsGridQuote.SetCellValue("GQuote",V.Local.iCol,V.Local.iIndex,V.Local.sMsg(V.Local.i).Trim)
	F.Intrinsic.Control.Else
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","GROUP_NO",V.Local.iIndex,V.Local.sGroupTemp)
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","SIGN_ROUTER",V.Local.iIndex,V.Local.sRouterTemp)
		F.Intrinsic.Control.If(V.Local.sGroup.Trim,=,V.Local.sGroupTemp.Trim,"AND",V.Local.sRouter.Trim,=,V.Local.sRouterTemp.Trim)
			Gui.FormQuote.GsGridQuote.SetCellValue("GQuote",V.Local.iCol,V.Local.iIndex,V.Local.sMsg(V.Local.i).Trim)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.ExitFor(V.Local.i)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Add(V.Local.iIndex,1,V.Local.iIndex)
F.Intrinsic.Control.Next(V.Local.i)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Menu_Click_Paste_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Menu_Click_Paste.End

Program.Sub.cmdOldMat_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdOldMat_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRet.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.Intrinsic.UI.Browser(105,"",V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	Gui.FormQuote.txtOldMat.Text(V.Local.sRet.Trim)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdOldMat_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdOldMat_Click.End

Program.Sub.cmdNewMat_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdNewMat_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRet.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.Intrinsic.UI.Browser(105,"",V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	Gui.FormQuote.txtNewMat.Text(V.Local.sRet.Trim)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdNewMat_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdNewMat_Click.End

Program.Sub.cmdUpMat_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdUpMat_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sOldMat.Declare(String,"")
V.Local.sNewMat.Declare(String,"")
V.Local.fSF.Declare(Float,0)
V.Local.sFilter.Declare(String,"")

'F.Intrinsic.Control.If(V.Screen.FormQuote!txtSF.Text,<>,"")
'	V.Local.fSF.Set(V.Screen.FormQuote!txtSF.Text)
'F.Intrinsic.Control.Else
'	F.Intrinsic.UI.Msgbox("The Following needs to be filled in: Material, New Material and Sq Ft","Attention")
'	F.Intrinsic.Control.ExitSub
'F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormQuote!txtOldMat.Text,<>,"")
	V.Local.sOldMat.Set(V.Screen.FormQuote!txtOldMat.Text)
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("The Following needs to be filled in: Material, New Material and Sq Ft","Attention")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormQuote!txtNewMat.Text,<>,"")
	V.Local.sNewMat.Set(V.Screen.FormQuote!txtNewMat.Text)
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("The Following needs to be filled in: Material, New Material and Sq Ft","Attention")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

Gui.FormQuote.GsGridQuote.GetGridviewProperty("GQuote","ActiveFilterString",V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
	F.Intrinsic.String.Build("{0} and [USER48] = '{1}'",V.Local.sRet,V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("[USER48] = '{0}'",V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.EndIf

F.Data.DataView.Create("Quote","VUser48",22,V.Local.sFilter,"")

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
	F.Intrinsic.String.Build("{0} and [USER50] = '{1}'",V.Local.sRet,V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("[USER50] = '{0}'",V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.EndIf

F.Data.DataView.Create("Quote","VUser50",22,V.Local.sFilter,"")

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
	F.Intrinsic.String.Build("{0} and [USER52] = '{1}'",V.Local.sRet,V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("[USER52] = '{0}'",V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.EndIf

F.Data.DataView.Create("Quote","VUser52",22,V.Local.sFilter,"")

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
	F.Intrinsic.String.Build("{0} and [USER54] = '{1}'",V.Local.sRet,V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("[USER54] = '{0}'",V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.EndIf

F.Data.DataView.Create("Quote","VUser54",22,V.Local.sFilter,"")

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
	F.Intrinsic.String.Build("{0} and [USER56] = '{1}'",V.Local.sRet,V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("[USER56] = '{0}'",V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.EndIf

F.Data.DataView.Create("Quote","VUser56",22,V.Local.sFilter,"")

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
	F.Intrinsic.String.Build("{0} and [USER58] = '{1}'",V.Local.sRet,V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("[USER58] = '{0}'",V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.EndIf

F.Data.DataView.Create("Quote","VUser58",22,V.Local.sFilter,"")

F.Intrinsic.Control.If(V.DataView.Quote!VUser48.RowCount--,<>,-1)
'	F.Data.DataView.SetValue("Quote","VUser48",-1,"User49",V.Local.fSF,"User48",V.Local.sNewMat)
	F.Data.DataView.SetValue("Quote","VUser48",-1,"User48",V.Local.sNewMat)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataView.Quote!VUser50.RowCount--,<>,-1)
'	F.Data.DataView.SetValue("Quote","VUser50",-1,"User51",V.Local.fSF,"User50",V.Local.sNewMat)
	F.Data.DataView.SetValue("Quote","VUser50",-1,"User50",V.Local.sNewMat)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataView.Quote!VUser52.RowCount--,<>,-1)
'	F.Data.DataView.SetValue("Quote","VUser52",-1,"User53",V.Local.fSF,"User52",V.Local.sNewMat)
	F.Data.DataView.SetValue("Quote","VUser52",-1,"User52",V.Local.sNewMat)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataView.Quote!VUser54.RowCount--,<>,-1)
'	F.Data.DataView.SetValue("Quote","VUser54",-1,"User55",V.Local.fSF,"User54",V.Local.sNewMat)
	F.Data.DataView.SetValue("Quote","VUser54",-1,"User54",V.Local.sNewMat)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataView.Quote!VUser56.RowCount--,<>,-1)
'	F.Data.DataView.SetValue("Quote","VUser56",-1,"User57",V.Local.fSF,"User56",V.Local.sNewMat)
	F.Data.DataView.SetValue("Quote","VUser56",-1,"User56",V.Local.sNewMat)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataView.Quote!VUser58.RowCount--,<>,-1)
'	F.Data.DataView.SetValue("Quote","VUser58",-1,"User59",V.Local.fSF,"User58",V.Local.sNewMat)
	F.Data.DataView.SetValue("Quote","VUser58",-1,"User58",V.Local.sNewMat)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("Quote","VUser48")
F.Data.DataView.Close("Quote","VUser50")
F.Data.DataView.Close("Quote","VUser52")
F.Data.DataView.Close("Quote","VUser54")
F.Data.DataView.Close("Quote","VUser56")
F.Data.DataView.Close("Quote","VUser58")

Gui.FormQuote.txtOldMat.Text("")
Gui.FormQuote.txtNewMat.Text("")
Gui.FormQuote.txtSF.Text(0)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdUpMat_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdUpMat_Click.End

Program.Sub.txtSF_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSF_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtSF.SelectAll

F.Intrinsic.Control.Label("txtSF_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSF_GotFocus.End

Program.Sub.Menu_Click_Copy_Line.Start
F.Intrinsic.Control.SetErrorHandler("Menu_Click_Copy_Line_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRow.Declare(String,"")

Gui.FormQuote.GsGridQuote.GetSelectedRows("GQuote",V.Local.sRow)
F.Intrinsic.String.Split(V.Local.sRow,"*!*",V.Local.sRow)

V.Global.iCopyIndex.Set(V.Local.sRow.Long)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Menu_Click_Copy_Line_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Menu_Click_Copy_Line.End

Program.Sub.Menu_Click_Paste_Line.Start
F.Intrinsic.Control.SetErrorHandler("Menu_Click_Paste_Line_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRow.Declare(String,"")
V.Local.iIndex.Declare(Long,0)

Gui.FormQuote.GsGridQuote.GetSelectedRows("GQuote",V.Local.sRow)
F.Intrinsic.String.Split(V.Local.sRow,"*!*",V.Local.sRow)

V.Local.iIndex.Set(V.Local.sRow.Long)

F.Intrinsic.Control.If(V.Global.iCopyIndex,<>,-1)
	F.Intrinsic.Control.BlockEvents
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User1",V.DataTable.Quote(V.Global.iCopyIndex).User1!FieldVal,"User2",V.DataTable.Quote(V.Global.iCopyIndex).User2!FieldVal,"User3",V.DataTable.Quote(V.Global.iCopyIndex).User3!FieldVal,"User4",V.DataTable.Quote(V.Global.iCopyIndex).User4!FieldVal,"User5",V.DataTable.Quote(V.Global.iCopyIndex).User5!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User6",V.DataTable.Quote(V.Global.iCopyIndex).User6!FieldVal,"User7",V.DataTable.Quote(V.Global.iCopyIndex).User7!FieldVal,"User8",V.DataTable.Quote(V.Global.iCopyIndex).User8!FieldVal,"User9",V.DataTable.Quote(V.Global.iCopyIndex).User9!FieldVal,"User10",V.DataTable.Quote(V.Global.iCopyIndex).User10!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User11",V.DataTable.Quote(V.Global.iCopyIndex).User11!FieldVal,"User12",V.DataTable.Quote(V.Global.iCopyIndex).User12!FieldVal,"User13",V.DataTable.Quote(V.Global.iCopyIndex).User13!FieldVal,"User14",V.DataTable.Quote(V.Global.iCopyIndex).User14!FieldVal,"User15",V.DataTable.Quote(V.Global.iCopyIndex).User15!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User16",V.DataTable.Quote(V.Global.iCopyIndex).User16!FieldVal,"User17",V.DataTable.Quote(V.Global.iCopyIndex).User17!FieldVal,"User18",V.DataTable.Quote(V.Global.iCopyIndex).User18!FieldVal,"User19",V.DataTable.Quote(V.Global.iCopyIndex).User19!FieldVal,"User20",V.DataTable.Quote(V.Global.iCopyIndex).User20!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User21",V.DataTable.Quote(V.Global.iCopyIndex).User21!FieldVal,"User22",V.DataTable.Quote(V.Global.iCopyIndex).User12!FieldVal,"User23",V.DataTable.Quote(V.Global.iCopyIndex).User13!FieldVal,"User24",V.DataTable.Quote(V.Global.iCopyIndex).User24!FieldVal,"User25",V.DataTable.Quote(V.Global.iCopyIndex).User25!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User26",V.DataTable.Quote(V.Global.iCopyIndex).User26!FieldVal,"User27",V.DataTable.Quote(V.Global.iCopyIndex).User17!FieldVal,"User28",V.DataTable.Quote(V.Global.iCopyIndex).User18!FieldVal,"User29",V.DataTable.Quote(V.Global.iCopyIndex).User29!FieldVal,"User30",V.DataTable.Quote(V.Global.iCopyIndex).User30!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User31",V.DataTable.Quote(V.Global.iCopyIndex).User31!FieldVal,"User32",V.DataTable.Quote(V.Global.iCopyIndex).User32!FieldVal,"User33",V.DataTable.Quote(V.Global.iCopyIndex).User33!FieldVal,"User34",V.DataTable.Quote(V.Global.iCopyIndex).User34!FieldVal,"User35",V.DataTable.Quote(V.Global.iCopyIndex).User35!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User36",V.DataTable.Quote(V.Global.iCopyIndex).User36!FieldVal,"User37",V.DataTable.Quote(V.Global.iCopyIndex).User37!FieldVal,"User38",V.DataTable.Quote(V.Global.iCopyIndex).User38!FieldVal,"User39",V.DataTable.Quote(V.Global.iCopyIndex).User39!FieldVal,"User40",V.DataTable.Quote(V.Global.iCopyIndex).User40!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User41",V.DataTable.Quote(V.Global.iCopyIndex).User41!FieldVal,"User42",V.DataTable.Quote(V.Global.iCopyIndex).User42!FieldVal,"User43",V.DataTable.Quote(V.Global.iCopyIndex).User43!FieldVal,"User44",V.DataTable.Quote(V.Global.iCopyIndex).User44!FieldVal,"User45",V.DataTable.Quote(V.Global.iCopyIndex).User45!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User46",V.DataTable.Quote(V.Global.iCopyIndex).User46!FieldVal,"User47",V.DataTable.Quote(V.Global.iCopyIndex).User47!FieldVal,"User48",V.DataTable.Quote(V.Global.iCopyIndex).User48!FieldVal,"User49",V.DataTable.Quote(V.Global.iCopyIndex).User49!FieldVal,"User50",V.DataTable.Quote(V.Global.iCopyIndex).User50!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User51",V.DataTable.Quote(V.Global.iCopyIndex).User51!FieldVal,"User52",V.DataTable.Quote(V.Global.iCopyIndex).User52!FieldVal,"User53",V.DataTable.Quote(V.Global.iCopyIndex).User53!FieldVal,"User54",V.DataTable.Quote(V.Global.iCopyIndex).User54!FieldVal,"User55",V.DataTable.Quote(V.Global.iCopyIndex).User55!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User56",V.DataTable.Quote(V.Global.iCopyIndex).User56!FieldVal,"User57",V.DataTable.Quote(V.Global.iCopyIndex).User57!FieldVal,"User58",V.DataTable.Quote(V.Global.iCopyIndex).User58!FieldVal,"User59",V.DataTable.Quote(V.Global.iCopyIndex).User59!FieldVal,"User60",V.DataTable.Quote(V.Global.iCopyIndex).User60!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"Unit",V.DataTable.Quote(V.Global.iCopyIndex).Unit!FieldVal,"Sign_Router",V.DataTable.Quote(V.Global.iCopyIndex).Sign_Router!FieldVal,"Message",V.DataTable.Quote(V.Global.iCopyIndex).Message!FieldVal,"UM_EACH",V.DataTable.Quote(V.Global.iCopyIndex).UM_EACH!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"SF_Each",V.DataTable.Quote(V.Global.iCopyIndex).SF_Each!FieldVal,"SF_Price",V.DataTable.Quote(V.Global.iCopyIndex).SF_Price!FieldVal,"Project",V.DataTable.Quote(V.Global.iCopyIndex).Project!FieldVal,"Phase",V.DataTable.Quote(V.Global.iCopyIndex).Phase!FieldVal)
	F.Intrinsic.Control.UnBlockEvents
	V.Global.iCopyIndex.Set(-1)
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("Need to Copy Line before Pasting","Attention")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Menu_Click_Paste_Line_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Menu_Click_Paste_Line.End

Program.Sub.Comments.Start
${$5$}$2.0.0.0$}$2
${$6$}$rking$}$20231103072844346$}$QNdZLVy4bWuiWa9jh1ZTiKHvMPldSPXe2fPC1dxcjBSLY6oalSUW9kNFdvuWrhjapnhicCUtJDc=
Program.Sub.Comments.End