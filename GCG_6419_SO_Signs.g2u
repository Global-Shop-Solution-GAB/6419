Program.Sub.ScreenSU.Start
Gui.FormQuote..Create(BaseForm)
Gui.FormQuote..Caption("Custom Customer Quote ")
Gui.FormQuote..Size(15360,10770)
Gui.FormQuote..MinX(0)
Gui.FormQuote..MinY(0)
Gui.FormQuote..Position(0,0)
Gui.FormQuote..BackColor(-2147483633)
Gui.FormQuote..MousePointer(0)
Gui.FormQuote..Event(UnLoad,FormQuote_UnLoad)
Gui.FormQuote..AlwaysOnTop(False)
Gui.FormQuote..FontName("Tahoma")
Gui.FormQuote..FontSize(8.25)
Gui.FormQuote..ControlBox(True)
Gui.FormQuote..MaxButton(True)
Gui.FormQuote..MinButton(True)
Gui.FormQuote..Moveable(True)
Gui.FormQuote..Sizeable(True)
Gui.FormQuote..ShowInTaskBar(True)
Gui.FormQuote..TitleBar(True)
Gui.FormQuote.txtCust.Create(TextBox,"",True,1650,300,0,210,300,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtCust.Event(KeyPressEnter,txtCust_KeyPressEnter)
Gui.FormQuote.txtCust.MaxLength(6)
Gui.FormQuote.txtCust.Locked(True)
Gui.FormQuote.lblCust.Create(Label,"Customer",True,705,210,0,210,90,True,0,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lblCust.BorderStyle(0)
Gui.FormQuote.ddlState.Create(ComboBox)
Gui.FormQuote.ddlState.Size(690,330)
Gui.FormQuote.ddlState.Position(2445,300)
Gui.FormQuote.ddlState.Event(LostFocus,ddlState_Change)
Gui.FormQuote.ddlState.Enabled(True)
Gui.FormQuote.ddlState.Visible(True)
Gui.FormQuote.ddlState.Zorder(0)
Gui.FormQuote.ddlState.FontName("Tahoma")
Gui.FormQuote.ddlState.FontSize(8.25)
Gui.FormQuote.lblState.Create(Label,"State",True,375,210,0,2415,75,True,0,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lblState.BorderStyle(0)
Gui.FormQuote.txtSaleOrder.Create(TextBox,"",True,1890,300,0,3555,330,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtSaleOrder.Event(GotFocus,txtSaleOrder_GotFocus)
Gui.FormQuote.txtSaleOrder.Event(LostFocus,txtSaleOrder_LostFocus)
Gui.FormQuote.txtSaleOrder.Event(KeyPressEnter,txtSaleOrder_KeyPressEnter)
Gui.FormQuote.txtSaleOrder.MaxLength(7)
Gui.FormQuote.cmdSO.Create(Button)
Gui.FormQuote.cmdSO.Size(405,375)
Gui.FormQuote.cmdSO.Position(5505,285)
Gui.FormQuote.cmdSO.Caption("^")
Gui.FormQuote.cmdSO.Event(Click,cmdSO_Click)
Gui.FormQuote.cmdSO.Enabled(True)
Gui.FormQuote.cmdSO.Visible(True)
Gui.FormQuote.cmdSO.Zorder(0)
Gui.FormQuote.cmdSO.FontName("Tahoma")
Gui.FormQuote.cmdSO.FontSize(8.25)
Gui.FormQuote.lblSO.Create(Label,"Sales Order #",True,1005,210,0,3525,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lblSO.BorderStyle(0)
Gui.FormQuote.ddlRouter.Create(DropDownList)
Gui.FormQuote.ddlRouter.Size(2235,330)
Gui.FormQuote.ddlRouter.Position(6015,330)
Gui.FormQuote.ddlRouter.Event(Change,ddlRouter_Change)
Gui.FormQuote.ddlRouter.Enabled(True)
Gui.FormQuote.ddlRouter.Visible(True)
Gui.FormQuote.ddlRouter.Zorder(0)
Gui.FormQuote.ddlRouter.FontName("Tahoma")
Gui.FormQuote.ddlRouter.FontSize(8.25)
Gui.FormQuote.lblRouter.Create(Label,"Router",True,495,210,0,6015,105,True,0,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lblRouter.BorderStyle(0)
Gui.FormQuote.lblProj.Create(Label,"Project",True,690,255,0,5640,9900,True,0,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lblProj.Anchor(6)
Gui.FormQuote.lblProj.BorderStyle(0)
Gui.FormQuote.txtProj.Create(TextBox,"",True,1020,300,0,6345,9810,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.lblProjPhase.Create(Label,"Project Phase",True,990,210,0,8730,90,True,0,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lblProjPhase.BorderStyle(0)
Gui.FormQuote.ddlProjPhase.Create(DropDownList)
Gui.FormQuote.ddlProjPhase.Size(1755,330)
Gui.FormQuote.ddlProjPhase.Position(8775,330)
Gui.FormQuote.ddlProjPhase.Enabled(True)
Gui.FormQuote.ddlProjPhase.Visible(True)
Gui.FormQuote.ddlProjPhase.Zorder(0)
Gui.FormQuote.ddlProjPhase.FontName("Tahoma")
Gui.FormQuote.ddlProjPhase.FontSize(8.25)
Gui.FormQuote.lblLines.Create(Label,"Number of Lines",True,1185,210,0,10665,75,True,0,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lblLines.BorderStyle(0)
Gui.FormQuote.txtLines.Create(TextBox,"",True,750,300,0,10740,345,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtLines.NumericOnly(2)
Gui.FormQuote.txtLines.Event(GotFocus,txtLines_GotFocus)
Gui.FormQuote.txtLines.DefaultValue("0")
Gui.FormQuote.cmdAdd.Create(Button)
Gui.FormQuote.cmdAdd.Size(1095,375)
Gui.FormQuote.cmdAdd.Position(11625,285)
Gui.FormQuote.cmdAdd.Caption("Add Lines")
Gui.FormQuote.cmdAdd.Event(Click,cmdAdd_Click)
Gui.FormQuote.cmdAdd.Enabled(True)
Gui.FormQuote.cmdAdd.Visible(True)
Gui.FormQuote.cmdAdd.Zorder(0)
Gui.FormQuote.cmdAdd.FontName("Tahoma")
Gui.FormQuote.cmdAdd.FontSize(8.25)
Gui.FormQuote.optV.Create(Option)
Gui.FormQuote.optV.Size(780,255)
Gui.FormQuote.optV.Position(11985,15)
Gui.FormQuote.optV.Caption("View")
Gui.FormQuote.optV.Enabled(True)
Gui.FormQuote.optV.Visible(True)
Gui.FormQuote.optV.Zorder(0)
Gui.FormQuote.optV.FontName("Tahoma")
Gui.FormQuote.optV.FontSize(8.25)
Gui.FormQuote.optE.Create(Option)
Gui.FormQuote.optE.Size(690,255)
Gui.FormQuote.optE.Position(12810,15)
Gui.FormQuote.optE.Caption("Edit")
Gui.FormQuote.optE.Enabled(True)
Gui.FormQuote.optE.Visible(True)
Gui.FormQuote.optE.Zorder(0)
Gui.FormQuote.optE.FontName("Tahoma")
Gui.FormQuote.optE.FontSize(8.25)
Gui.FormQuote.optC.Create(Option)
Gui.FormQuote.optC.Size(780,255)
Gui.FormQuote.optC.Position(13530,15)
Gui.FormQuote.optC.Caption("Copy")
Gui.FormQuote.optC.Enabled(True)
Gui.FormQuote.optC.Visible(True)
Gui.FormQuote.optC.Zorder(0)
Gui.FormQuote.optC.FontName("Tahoma")
Gui.FormQuote.optC.FontSize(8.25)
Gui.FormQuote.cmdLRout.Create(Button)
Gui.FormQuote.cmdLRout.Size(1320,375)
Gui.FormQuote.cmdLRout.Position(12810,285)
Gui.FormQuote.cmdLRout.Caption("Launch Router")
Gui.FormQuote.cmdLRout.Event(Click,cmdLRout_Click)
Gui.FormQuote.cmdLRout.Enabled(True)
Gui.FormQuote.cmdLRout.Visible(True)
Gui.FormQuote.cmdLRout.Zorder(0)
Gui.FormQuote.cmdLRout.FontName("Tahoma")
Gui.FormQuote.cmdLRout.FontSize(8.25)
Gui.FormQuote.GsGridQuote.Create(GsGridControl)
Gui.FormQuote.GsGridQuote.Size(14835,8115)
Gui.FormQuote.GsGridQuote.Position(210,1110)
Gui.FormQuote.GsGridQuote.Anchor(15)
Gui.FormQuote.GsGridQuote.Event(RowCellClick,GsGridQuote_RowCellClick)
Gui.FormQuote.GsGridQuote.Event(CellValueChanged,GsGridQuote_CellValueChanged)
Gui.FormQuote.GsGridQuote.Enabled(True)
Gui.FormQuote.GsGridQuote.Visible(True)
Gui.FormQuote.GsGridQuote.Zorder(0)
Gui.FormQuote.lblUser1.Create(Label,"User 1:",True,1050,255,0,45,9480,True,1,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lblUser1.Anchor(6)
Gui.FormQuote.lblUser1.BorderStyle(0)
Gui.FormQuote.txtUser1.Create(TextBox,"",True,2445,300,0,1095,9390,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtUser1.Anchor(6)
Gui.FormQuote.txtUser1.Event(GotFocus,txtUser1_GotFocus)
Gui.FormQuote.txtUser1.MaxLength(30)
Gui.FormQuote.txtUser1.Locked(True)
Gui.FormQuote.lblUser3.Create(Label,"User 3:",True,1110,255,0,4050,9480,True,1,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lblUser3.Anchor(6)
Gui.FormQuote.lblUser3.BorderStyle(0)
Gui.FormQuote.txtUser3.Create(TextBox,"",True,2445,300,0,5175,9390,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtUser3.Anchor(6)
Gui.FormQuote.txtUser3.Event(GotFocus,txtUser3_GotFocus)
Gui.FormQuote.txtUser3.MaxLength(30)
Gui.FormQuote.txtUser3.Locked(True)
Gui.FormQuote.lblUser4.Create(Label,"User 4:",True,1110,255,0,8130,9480,True,1,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lblUser4.Anchor(6)
Gui.FormQuote.lblUser4.BorderStyle(0)
Gui.FormQuote.txtUser4.Create(TextBox,"",True,2445,300,0,9270,9390,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtUser4.Anchor(6)
Gui.FormQuote.txtUser4.Event(GotFocus,txtUser4_GotFocus)
Gui.FormQuote.txtUser4.MaxLength(30)
Gui.FormQuote.txtUser4.Locked(True)
Gui.FormQuote.lblUser5.Create(Label,"User 5:",True,1110,255,0,1995,9900,True,1,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lblUser5.Anchor(6)
Gui.FormQuote.lblUser5.BorderStyle(0)
Gui.FormQuote.txtUser5.Create(TextBox,"",True,2445,300,0,3150,9810,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtUser5.Anchor(6)
Gui.FormQuote.txtUser5.Event(GotFocus,txtUser5_GotFocus)
Gui.FormQuote.txtUser5.MaxLength(30)
Gui.FormQuote.txtUser5.Locked(True)
Gui.FormQuote.cmdSave.Create(Button)
Gui.FormQuote.cmdSave.Size(855,375)
Gui.FormQuote.cmdSave.Position(135,9780)
Gui.FormQuote.cmdSave.Anchor(6)
Gui.FormQuote.cmdSave.Caption("Save")
Gui.FormQuote.cmdSave.Event(Click,cmdSave_Click)
Gui.FormQuote.cmdSave.Enabled(True)
Gui.FormQuote.cmdSave.Visible(True)
Gui.FormQuote.cmdSave.Zorder(0)
Gui.FormQuote.cmdSave.FontName("Tahoma")
Gui.FormQuote.cmdSave.FontSize(8.25)
Gui.FormQuote.cmdExport.Create(Button)
Gui.FormQuote.cmdExport.Size(855,375)
Gui.FormQuote.cmdExport.Position(1080,9780)
Gui.FormQuote.cmdExport.Anchor(6)
Gui.FormQuote.cmdExport.Caption("Export")
Gui.FormQuote.cmdExport.Event(Click,cmdExport_Click)
Gui.FormQuote.cmdExport.Enabled(True)
Gui.FormQuote.cmdExport.Visible(True)
Gui.FormQuote.cmdExport.Zorder(0)
Gui.FormQuote.cmdExport.FontName("Tahoma")
Gui.FormQuote.cmdExport.FontSize(8.25)
Gui.FormQuote.lblCustPO.Create(Label,"Customer PO/Reference:",True,2010,255,0,7395,9900,True,1,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lblCustPO.Anchor(6)
Gui.FormQuote.lblCustPO.BorderStyle(0)
Gui.FormQuote.txtCustPO.Create(TextBox,"",True,2865,300,0,9435,9810,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtCustPO.Anchor(6)
Gui.FormQuote.txtCustPO.MaxLength(15)
Gui.FormQuote.txtCustPO.Locked(True)
Gui.FormQuote.dtpDueDate.Create(DatePicker)
Gui.FormQuote.dtpDueDate.Size(1935,285)
Gui.FormQuote.dtpDueDate.Position(13095,9375)
Gui.FormQuote.dtpDueDate.Anchor(6)
Gui.FormQuote.dtpDueDate.Enabled(False)
Gui.FormQuote.dtpDueDate.Visible(True)
Gui.FormQuote.dtpDueDate.Zorder(0)
Gui.FormQuote.dtpDueDate.CheckBox(False)
Gui.FormQuote.dtpDueDate.FontName("Tahoma")
Gui.FormQuote.dtpDueDate.FontSize(8.25)
Gui.FormQuote.cmdCreate.Create(Button)
Gui.FormQuote.cmdCreate.Size(2595,375)
Gui.FormQuote.cmdCreate.Position(12390,9780)
Gui.FormQuote.cmdCreate.Caption("Create Sales Order/Work Order")
Gui.FormQuote.cmdCreate.Event(Click,cmdCreate_Click)
Gui.FormQuote.cmdCreate.Anchor(6)
Gui.FormQuote.cmdCreate.Enabled(True)
Gui.FormQuote.cmdCreate.Visible(True)
Gui.FormQuote.cmdCreate.Zorder(0)
Gui.FormQuote.cmdCreate.FontName("Tahoma")
Gui.FormQuote.cmdCreate.FontSize(8.25)
Gui.FormQuote.lbl1.Create(Label,"Due Date",True,855,255,0,12180,9465,True,1,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lbl1.Anchor(6)
Gui.FormQuote.lbl1.BorderStyle(0)
Gui.FormQuote.cmdRout.Create(Button)
Gui.FormQuote.cmdRout.Size(405,375)
Gui.FormQuote.cmdRout.Position(8310,285)
Gui.FormQuote.cmdRout.Caption("^")
Gui.FormQuote.cmdRout.Event(Click,cmdRout_Click)
Gui.FormQuote.cmdRout.Enabled(True)
Gui.FormQuote.cmdRout.Visible(True)
Gui.FormQuote.cmdRout.Zorder(0)
Gui.FormQuote.cmdRout.FontName("Tahoma")
Gui.FormQuote.cmdRout.FontSize(8.25)
Gui.FormQuote.txtOldMat.Create(TextBox,"",True,2340,300,0,3255,750,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.lblOldMat.Create(Label,"Material",True,555,210,0,2445,840,True,0,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lblOldMat.BorderStyle(0)
Gui.FormQuote.cmdOldMat.Create(Button)
Gui.FormQuote.cmdOldMat.Size(405,375)
Gui.FormQuote.cmdOldMat.Position(5640,720)
Gui.FormQuote.cmdOldMat.Caption("^")
Gui.FormQuote.cmdOldMat.Event(Click,cmdOldMat_Click)
Gui.FormQuote.cmdOldMat.Enabled(True)
Gui.FormQuote.cmdOldMat.Visible(True)
Gui.FormQuote.cmdOldMat.Zorder(0)
Gui.FormQuote.cmdOldMat.FontName("Tahoma")
Gui.FormQuote.cmdOldMat.FontSize(8.25)
Gui.FormQuote.lblNewMat.Create(Label,"New Material",True,945,210,0,6165,840,True,0,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lblNewMat.BorderStyle(0)
Gui.FormQuote.txtNewMat.Create(TextBox,"",True,2340,300,0,7320,750,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtNewMat.Locked(True)
Gui.FormQuote.cmdNewMat.Create(Button)
Gui.FormQuote.cmdNewMat.Size(405,375)
Gui.FormQuote.cmdNewMat.Position(9720,720)
Gui.FormQuote.cmdNewMat.Caption("^")
Gui.FormQuote.cmdNewMat.Event(Click,cmdNewMat_Click)
Gui.FormQuote.cmdNewMat.Enabled(True)
Gui.FormQuote.cmdNewMat.Visible(True)
Gui.FormQuote.cmdNewMat.Zorder(0)
Gui.FormQuote.cmdNewMat.FontName("Tahoma")
Gui.FormQuote.cmdNewMat.FontSize(8.25)
Gui.FormQuote.lblSF.Create(Label,"Sq Ft",False,375,210,0,180,795,True,0,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lblSF.Anchor(9)
Gui.FormQuote.lblSF.BorderStyle(0)
Gui.FormQuote.txtSF.Create(TextBox,"",False,1320,300,0,795,705,True,0,"Arial",8,-2147483643,1)
Gui.FormQuote.txtSF.Anchor(9)
Gui.FormQuote.txtSF.NumericOnly(1)
Gui.FormQuote.txtSF.Event(GotFocus,txtSF_GotFocus)
Gui.FormQuote.cmdUpMat.Create(Button)
Gui.FormQuote.cmdUpMat.Size(1590,375)
Gui.FormQuote.cmdUpMat.Position(13455,720)
Gui.FormQuote.cmdUpMat.Anchor(9)
Gui.FormQuote.cmdUpMat.Caption("Update Material")
Gui.FormQuote.cmdUpMat.Event(Click,cmdUpMat_Click)
Gui.FormQuote.cmdUpMat.Enabled(True)
Gui.FormQuote.cmdUpMat.Visible(True)
Gui.FormQuote.cmdUpMat.Zorder(0)
Gui.FormQuote.cmdUpMat.FontName("Tahoma")
Gui.FormQuote.cmdUpMat.FontSize(8.25)
Gui.FormQuote.lblGroup.Create(Label,"Group",True,450,210,0,10260,780,True,0,"Arial",8,-2147483633,0,0)
Gui.FormQuote.lblGroup.BorderStyle(0)
Gui.FormQuote.ddlGroup.Create(DropDownList)
Gui.FormQuote.ddlGroup.Enabled(True)
Gui.FormQuote.ddlGroup.Visible(True)
Gui.FormQuote.ddlGroup.Zorder(0)
Gui.FormQuote.ddlGroup.Size(2565,300)
Gui.FormQuote.ddlGroup.Position(10785,720)
Gui.FormQuote.ddlGroup.FontName("Tahoma")
Gui.FormQuote.ddlGroup.FontSize(8.25)
Gui.FormRouter..Create(BaseForm)
Gui.FormRouter..Caption("Commit User Fields to Other Routers")
Gui.FormRouter..Size(15360,10695)
Gui.FormRouter..MinX(0)
Gui.FormRouter..MinY(0)
Gui.FormRouter..Position(0,0)
Gui.FormRouter..BackColor(-2147483633)
Gui.FormRouter..MousePointer(0)
Gui.FormRouter..Event(UnLoad,FormRouter_UnLoad)
Gui.FormRouter..AlwaysOnTop(False)
Gui.FormRouter..FontName("Tahoma")
Gui.FormRouter..FontSize(8.25)
Gui.FormRouter..ControlBox(True)
Gui.FormRouter..MaxButton(True)
Gui.FormRouter..MinButton(True)
Gui.FormRouter..Moveable(True)
Gui.FormRouter..Sizeable(True)
Gui.FormRouter..ShowInTaskBar(True)
Gui.FormRouter..TitleBar(True)
Gui.FormRouter.GsGridUserFields.Create(GsGridControl)
Gui.FormRouter.GsGridUserFields.Size(8775,9195)
Gui.FormRouter.GsGridUserFields.Position(90,450)
Gui.FormRouter.GsGridUserFields.Anchor(15)
Gui.FormRouter.GsGridUserFields.Enabled(True)
Gui.FormRouter.GsGridUserFields.Visible(True)
Gui.FormRouter.GsGridUserFields.Zorder(0)
Gui.FormRouter.GsGridRouter.Create(GsGridControl)
Gui.FormRouter.GsGridRouter.Size(5835,9195)
Gui.FormRouter.GsGridRouter.Position(9135,450)
Gui.FormRouter.GsGridRouter.Anchor(11)
Gui.FormRouter.GsGridRouter.Enabled(True)
Gui.FormRouter.GsGridRouter.Visible(True)
Gui.FormRouter.GsGridRouter.Zorder(0)
Gui.FormRouter.lblUserFields.Create(Label,"Router User Fields ",True,2220,255,0,120,150,True,0,"Arial",10,-2147483633,0,0)
Gui.FormRouter.lblUserFields.BorderStyle(0)
Gui.FormRouter.lblRouters.Create(Label,"Routers",True,2220,255,0,9135,135,True,0,"Arial",10,-2147483633,0,0)
Gui.FormRouter.lblRouters.BorderStyle(0)
Gui.FormRouter.cmdCommit.Create(Button)
Gui.FormRouter.cmdCommit.Size(1590,375)
Gui.FormRouter.cmdCommit.Position(105,9720)
Gui.FormRouter.cmdCommit.Caption("Commit Changes")
Gui.FormRouter.cmdCommit.Event(Click,cmdCommit_Click)
Gui.FormRouter.cmdCommit.Enabled(True)
Gui.FormRouter.cmdCommit.Visible(True)
Gui.FormRouter.cmdCommit.Zorder(0)
Gui.FormRouter.cmdCommit.FontName("Tahoma")
Gui.FormRouter.cmdCommit.FontSize(8.25)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
Program.External.Include.Library("ORDUPL.lib")
Program.External.Include.Library("400000.lib")
Program.External.Include.Library("251000.lib")
Program.External.Include.Library("200000.lib")
V.Global.bEditable.Declare(Boolean,True)
V.Global.sPrevQuote.Declare(String,"-1")
V.Global.bSave.Declare(Boolean,False)
V.Global.bShow.Declare(Boolean,False)
V.Global.bError.Declare(Boolean,False)
V.Global.bNew.Declare(Boolean,False)
V.Global.sLastOrder.Declare(String,"")
V.Global.sLastLine.Declare(String,"")
V.Global.iCopyIndex.Declare(Long,-1)
V.Global.bOpen.Declare(Boolean,False)
Program.Sub.Preflight.End

Program.Sub.Main.Start
F.Intrinsic.Control.SetErrorHandler("Main_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

'Gui.FormQuote.lblQQ.Caption(" ")
Gui.FormQuote.optV.Value(1)

Gui.FormQuote.txtLines.Text("0")

'F.Intrinsic.Control.If(V.Caller.CompanyCode,=,"TST")
	Gui.FormQuote.ddlGroup.Visible(True)
	Gui.FormQuote.lblGroup.Visible(True)
'F.Intrinsic.Control.Else
'	Gui.FormQuote.ddlGroup.Visible(False)
'	Gui.FormQuote.lblGroup.Visible(False)
'F.Intrinsic.Control.EndIf
'creating context menu
F.Intrinsic.Control.CallSub(Create_ContextMenu)
'getting data
F.Intrinsic.Control.CallSub(Get_Data)
'setting grid properties
F.Intrinsic.Control.CallSub(Set_Properties)

Gui.FormQuote..Show

V.Global.bShow.Set(True)

Gui.FormQuote..AlwaysOnTop(True)
Gui.FormQuote..AlwaysOnTop(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Main_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Main.End

Program.Sub.FormQuote_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("FormQuote_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.i.Declare(Long,0)

'clearing lock for user
F.Intrinsic.Control.If(V.Global.sPrevQuote.Trim,<>,"")
'	F.Global.General.DestroySoftLock("SO",V.Global.sPrevQuote,V.Local.i)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Global.bShow)
	F.Intrinsic.Control.CallSub(Serialize, "FORM", "FormQuote", "GRIDCONTROL", "GsGridQuote", "GRIDVIEW", "GQuote", "REGID", 6419)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Global.bOpen)
	F.ODBC.Connection!con.Close
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Global.bError)
	F.Intrinsic.Control.If(V.DataTable.Quote.Exists)
		F.Intrinsic.Control.If(V.DataTable.Quote.RowCount--,<>,-1)
			F.Intrinsic.Control.CallSub(cmdSave_Click)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.End

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormQuote_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.End
Function.Intrinsic.Control.EndIf
Program.Sub.FormQuote_UnLoad.End

Program.Sub.cmdCreate_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdCreate_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.iC.Declare(Long,0)
V.Local.sDueDate.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.sWOFile.Declare(String,"")
V.Local.sDate.Declare(String,"")
V.Local.sFile.Declare(String,"")
V.Local.sLocal.Declare(String,"")
V.Local.sData.Declare(String,"")
V.Local.sFilter.Declare(String,"")
V.Local.sUser1.Declare(String,"")
V.Local.sUser3.Declare(String,"")
V.Local.sUser4.Declare(String,"")
V.Local.sUser5.Declare(String,"")
V.Local.sMsg.Declare(String,"")
V.Local.sTemp.Declare(STring,"")
V.Local.sMaxRecordNo.Declare(String,"")
V.Local.iRemainNo.Declare(Long,0)
V.Local.iIndex.Declare(Long,0)
V.Local.iMax.Declare(Long,0)
V.Local.iRet.Declare(Long,0)
V.Local.bSave.Declare(Boolean,False)
V.Local.sDescription.Declare(String,"")
V.Local.sLine.Declare(String,"")
V.Local.iCount.Declare(Long,0)
V.Local.sStiff3.Declare(String,"")
V.Local.bSkip.Declare(Boolean,False)
V.Local.fEst.Declare(Float,0)
V.Local.iStart.Declare(Long,0)
V.Local.sOrder.Declare(String,"")

F.Intrinsic.Control.If(V.DataTable.Quote.RowCount--,=,-1)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
'making sure users fields are filled out before creating so and wo's
V.Local.sUser1.Set(V.Screen.FormQuote!txtUser1.Text)
V.Local.sUser3.Set(V.Screen.FormQuote!txtUser3.Text)
V.Local.sUser4.Set(V.Screen.FormQuote!txtUser4.Text)
V.Local.sUser5.Set(V.Screen.FormQuote!txtUser5.Text)

F.Data.DataView.Create("Quote","GCheck",22,"trim(GROUP_DESC) = '' or trim(Group_No) = ''","")

'F.Intrinsic.Control.If(V.Local.sUser1.Trim,=,"")
'	F.Intrinsic.String.Build("{0} must be filled in.",V.Screen.FormQuote!lblUser1.Caption,V.Local.sTemp)
'	V.Local.sMsg.Set(V.Local.sTemp)
'F.Intrinsic.Control.ElseIf(V.Local.sUser3.Trim,=,"")
'	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
'		F.Intrinsic.String.Build("{0} must be filled in.",V.Screen.FormQuote!lblUser3.Caption,V.Local.sTemp)
'		V.Local.sMsg.Set(V.Local.sTemp)
'	F.Intrinsic.Control.Else
'		F.Intrinsic.String.Build("{0}{1}{2} must be filled in.",V.Local.sMsg,V.Ambient.NewLine,V.Screen.FormQuote!lblUser3.Caption,V.Local.sTemp)
'		V.Local.sMsg.Set(V.Local.sTemp)
'	F.Intrinsic.Control.EndIf
'F.Intrinsic.Control.ElseIf(V.Local.sUser4.Trim,=,"")
'	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
'		F.Intrinsic.String.Build("{0} must be filled in.",V.Screen.FormQuote!lblUser4.Caption,V.Local.sTemp)
'		V.Local.sMsg.Set(V.Local.sTemp)
'	F.Intrinsic.Control.Else
'		F.Intrinsic.String.Build("{0}{1}{2} must be filled in.",V.Local.sMsg,V.Ambient.NewLine,V.Screen.FormQuote!lblUser4.Caption,V.Local.sTemp)
'		V.Local.sMsg.Set(V.Local.sTemp)
'	F.Intrinsic.Control.EndIf
'F.Intrinsic.Control.ElseIf(V.Local.sUser5.Trim,=,"")
'	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
'		F.Intrinsic.String.Build("{0} must be filled in.",V.Screen.FormQuote!lblUser5.Caption,V.Local.sTemp)
'		V.Local.sMsg.Set(V.Local.sTemp)
'			
'	F.Intrinsic.Control.Else
'		F.Intrinsic.String.Build("{0}{1}{2} must be filled in.",V.Local.sMsg,V.Ambient.NewLine,V.Screen.FormQuote!lblUser5.Caption,V.Local.sTemp)
'		V.Local.sMsg.Set(V.Local.sTemp)
'	F.Intrinsic.Control.EndIf
'F.Intrinsic.Control.ElseIf(V.DataView.Quote!GCheck.RowCount--,<>,-1)
'	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
'		V.Local.sTemp.Set("Group and Group Description must be filled in for all lines.")
'		V.Local.sMsg.Set(V.Local.sTemp)
'	F.Intrinsic.Control.Else
'		F.Intrinsic.String.Build("{0}{1}Group and Group Description must be filled in for all lines.",V.Local.sMsg,V.Ambient.NewLine,V.Local.sTemp)
'		V.Local.sMsg.Set(V.Local.sTemp)
'	F.Intrinsic.Control.EndIf
'F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataView.Quote!GCheck.RowCount--,<>,-1)
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sTemp.Set("Group and Group Description must be filled in for all lines.")
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}{1}Group and Group Description must be filled in for all lines.",V.Local.sMsg,V.Ambient.NewLine,V.Local.sTemp)
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("Quote","GCheck")

V.Local.sTemp.Set(V.Screen.FormQuote!txtProj.Text)
F.Intrinsic.Control.If(V.Local.sTemp.Trim,<>,"")
	F.Data.DataView.Create("QUOTE","VPHase",22,"Phase = '' or Phase is null","")
	F.Intrinsic.Control.If(V.DataView.Quote!VPHase.RowCount--,<>,-1)
		F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
			V.Local.sMsg.Set("Project Phases must be filled in for all lines")
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0}{1}Project Phases must be filled in for all lines",V.Local.sMsg,V.Ambient.NewLine,V.Local.sTemp)
			V.Local.sMsg.Set(V.Local.sTemp)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.Data.DataView.Close("Quote","VPHase")
F.Intrinsic.Control.EndIf

F.Data.DataView.Create("Quote","MCheck",22,"(trim(User48) <> '' and (trim(User49) = '' or User49 is null)) Or (trim(User50) <> '' and (trim(User51) = '' or User51 is null)) Or (trim(User52) <> '' and (trim(User53) = '' or User53 is null)) Or (trim(User54) <> '' and (trim(User55) = '' or User55 is null)) Or (trim(User56) <> '' and (trim(User57) = '' or User57 is null)) Or (trim(User58) <> '' and (trim(User59) = '' or User59 is null))","")
F.Intrinsic.Control.If(V.DataView.Quote!MCheck.RowCount--,<>,-1)
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sMsg.Set("There are Material Qty Missing")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}{1}There are Material Qty Missing",V.Local.sMsg,V.Ambient.NewLine,V.Local.sTemp)
		V.Local.sMsg.Set(V.Local.sTemp)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf
F.Data.DataView.Close("Quote","MCheck")

F.Intrinsic.Control.If(V.Local.sMsg.Trim,<>,"")
	F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Attention")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.UI.Msgbox("Are you sure you want to Create Sales Order Lines and Create Work Orders?","Attention",4,V.Local.iRet)

F.Intrinsic.Control.If(V.Local.iRet,<>,6)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

Gui.FormQuote..Enabled(False)

F.ODBC.Connection!Con.OpenCompanyConnection
V.Global.bOpen.Set(True)
F.Intrinsic.UI.InvokeWaitDialog("Creating Sales Order.........................")

F.Intrinsic.Control.If(V.Global.bNew)
	F.Intrinsic.Control.If(V.Global.sLastLine.Trim,=,"")
		V.Local.iStart.Set(0)
		F.Intrinsic.String.Build("select Max(Record_No) from V_ORDER_LINES Where Order_no = '{0}'",V.Global.sPrevQuote,V.Local.sSql)
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sMaxRecordNo)
		
		F.Intrinsic.Math.Div(V.Local.sMaxRecordNo.Long,10,V.Local.iMax)
		F.Intrinsic.Math.Sub(799,V.Local.iMax,V.Local.iRemainNo)
		
		F.Intrinsic.Control.If(V.Local.iRemainNo,>,0)
			F.Intrinsic.Control.CallSub(Update_SO,"Record_No",V.Local.sMaxRecordNo,"Start",0)
			V.Local.iIndex.Set(V.Args.Index)
		F.Intrinsic.Control.EndIf
	f.Intrinsic.Control.Else
		V.Local.iStart.Set(0)
		V.Local.sMaxRecordNo.Set(V.Global.sLastLine)
		
		F.Intrinsic.String.Build("Select Top 1 Order_No From GCG_6419_SO_Signs Where P_Order_No = '{0}' and Order_NO <> '' Order by Line_Item Desc",V.Global.sPrevQuote,V.Local.sSql)
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sOrder)
			
		'Checking if additional lines have been added to the sales order
		F.Intrinsic.String.Build("select Max(Record_No) from V_ORDER_LINES Where Order_no = '{0}'",V.Local.sOrder,V.Local.sSql)
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
		F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
			F.Intrinsic.Control.If(V.Local.sRet.Long,>,V.Local.sMaxRecordNo.Long)
				V.Local.sMaxRecordNo.Set(V.Local.sRet.Trim)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Math.Div(V.Local.sMaxRecordNo.Long,10,V.Local.iMax)
		F.Intrinsic.Math.Sub(995,V.Local.iMax,V.Local.iRemainNo)
		
		F.Intrinsic.Control.If(V.Local.iRemainNo,>,0)
			F.Intrinsic.Control.CallSub(Update_SO,"Record_No",V.Local.sMaxRecordNo,"Start",0,"Order",V.Local.sOrder)
			V.Local.iIndex.Set(V.Args.Index)
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	
	F.Data.DataView.Create("Quote","SOWOQuote",22,"Order_NO <> '' and Order_No Not is null","LINE_ITEM")
	
	V.Local.sMaxRecordNo.Set(V.DataView.Quote!SOWOQuote(V.DataView.Quote!SOWOQuote.RowCount--).Order_Line!FieldValTrim)

	V.Local.iStart.Set(V.DataView.Quote!SOWOQuote(V.DataView.Quote!SOWOQuote.RowCount--).DataTableIndex)
	
	'Checking if additional lines have been added to the sales order
	F.Intrinsic.String.Build("select Max(Record_No) from V_ORDER_LINES Where Order_no = '{0}'",V.DataView.Quote!SOWOQuote(V.DataView.Quote!SOWOQuote.RowCount--).Order_No!FieldValTrim,V.Local.sSql)
	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
	F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
		F.Intrinsic.Control.If(V.Local.sRet.Long,>,V.Local.sMaxRecordNo.Long)
			V.Local.sMaxRecordNo.Set(V.Local.sRet.Trim)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Math.Add(V.Local.iStart,1,V.Local.iStart)
	F.Intrinsic.Math.Div(V.Local.sMaxRecordNo.Long,10,V.Local.iMax)
	F.Intrinsic.Math.Sub(799,V.Local.iMax,V.Local.iRemainNo)
	
	F.Intrinsic.Control.If(V.Local.iRemainNo,>,0)
		F.Intrinsic.Control.CallSub(Update_SO,"Record_No",V.Local.sMaxRecordNo,"Start",V.Local.iStart,"Order",V.DataView.Quote!SOWOQuote(V.DataView.Quote!SOWOQuote.RowCount--).Order_No!FieldValTrim)
		V.Local.iIndex.Set(V.Args.Index)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Sub(V.Local.iStart,1,V.Local.iStart)
		V.Local.iIndex.Set(V.Local.iStart)
	F.Intrinsic.Control.EndIf
	F.Data.DataView.Close("Quote","SOWOQuote")
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.Close
V.Global.bOpen.Set(False)

F.Intrinsic.Control.If(V.Local.iIndex,<,V.DataTable.Quote.RowCount--)
	F.Intrinsic.Control.CallSub(Create_SO,"Index",V.Local.iIndex)
F.Intrinsic.Control.EndIf

F.Intrinsic.UI.Sleep(2)

F.ODBC.Connection!Con.OpenCompanyConnection
V.Global.bOpen.Set(True)

'getting newly crated so and lines
F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Quote.RowCount--,1)
	V.Local.sRet.Redim(0,0)
	F.Intrinsic.String.Build("Select Top 1 a.Order_NO, b.Record_No, Part From V_Order_Header a left join V_Order_Lines b on a.Order_No = b.Order_No Where Customer_PO = '{0}' and Part = '{1}' and b.User_5 = '{2}' Order by a.Order_No Desc",V.Screen.FormQuote!txtCustPO.Text,V.DataTable.Quote(V.Local.i).Sign_Router!FieldVal,V.DataTable.Quote(V.Local.i).Line_Item!FieldVal,V.Local.sSql)
	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)

	F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
		F.Intrinsic.String.Build("Update Order_Lines Set User_5 = ' ' Where Order_No = '{0}' and Record_No = '{1}'",V.Local.sRet(0).Trim,V.Local.sRet(1).Trim,V.Local.sSql)
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
		'generating wo's from these newly created so lines
		V.Local.sMsg.Set(V.DataTable.Quote(V.Local.i).Message!FieldValTrim)
		F.Intrinsic.String.Build("Insert Into Order_Ln_Text Values('{0}','{1}',1,'{2}')",V.Local.sRet(0).Trim,V.Local.sRet(1).Trim,V.Local.sMsg.PSQLFriendly,V.Local.sSql)
		F.ODBC.Connection!con.Execute(V.Local.sSql)
		
		F.Data.DataTable.SetValue("Quote",V.Local.i,"Order_No",V.Local.sRet(0).Trim,"Order_Line",V.Local.sRet(1).Trim)
		F.Intrinsic.Control.If(V.Local.sRet(1).Length,>,2)
			F.Intrinsic.String.Left(V.Local.sRet(1),3,V.Local.sLine)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.sWOFile(V.Local.sWOFile.UBound).Trim,=,"")
			F.Intrinsic.String.Format(V.Screen.FormQuote!dtpDueDate.Value,"MM/DD/YYYY",V.Local.sDueDate)
			F.Intrinsic.String.Build("{0}*!*{1}*!*{2}*!*{3}*!*{4}*!* *!* *!*{5}*!*{6}",V.DataTable.Quote(V.Local.i).Sign_Router!FieldValTrim,"","",V.Local.sDueDate,V.DataTable.Quote(V.Local.i).Unit!FieldVal,V.Local.sRet(0).Trim,V.Local.sLine,V.Local.sWOFile(V.Local.sWOFile.UBound))
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Format(V.Screen.FormQuote!dtpDueDate.Value,"MM/DD/YYYY",V.Local.sDueDate)
			F.Intrinsic.String.Build("{0}{1}{2}*!*{3}*!*{4}*!*{5}*!*{6}*!* *!* *!*{7}*!*{8}",V.Local.sWOFile(V.Local.sWOFile.UBound),V.Ambient.NewLine,V.DataTable.Quote(V.Local.i).Sign_Router!FieldVal,"","",V.Local.sDueDate,V.DataTable.Quote(V.Local.i).Unit!FieldVal,V.Local.sRet(0).Trim,V.Local.sLine,V.Local.sWOFile(V.Local.sWOFile.UBound))
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.iCount,=,500)
			F.Intrinsic.Math.Add(V.Local.sWOFile.UBound,1,V.Local.iCount)
			V.Local.sWOFile.RedimPreserve(0,V.Local.iCount)
			V.Local.iCount.Set(0)
		F.Intrinsic.Control.Else
			F.Intrinsic.Math.Add(V.Local.iCount,1,V.Local.iCount)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf					
F.Intrinsic.Control.Next(V.Local.i)

F.Intrinsic.UI.ChangeWaitStatus("Creating Work Orders.........................")
F.Intrinsic.Control.If(V.Caller.LocalGSSTempDir.Right1,=,"\")
	V.Local.sLocal.Set(V.Caller.LocalGSSTempDir)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("{0}\",V.Caller.LocalGSSTempDir,V.Local.sLocal)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sWOFile.UBound,1)
	F.Intrinsic.String.Format(V.Ambient.Now,"YYMMDD-HHMMSS",V.Local.sDate)
	F.Intrinsic.String.Build("{0}WO_6419-{1}.txt",V.Local.sLocal,V.Local.sDate,V.Local.sFile)
	F.Intrinsic.File.String2File(V.Local.sFile,V.Local.sWOFile(V.Local.iC))
	
	F.Global.Callwrapper.New("GenFG","Manufacturing.CreateWorkOrderFinishedGoodPart")
	F.Global.Callwrapper.SetProperty("GenFG","FileName",V.Local.sFile)
	F.Global.CallWrapper.Run("GenFG")
	F.Global.CallWrapper.GetProperty("GenFG","ReturnCode",V.Local.sRet)
	
	F.Intrinsic.File.File2String(V.Local.sFile,V.Local.sData)
F.Intrinsic.Control.Next(V.Local.iC)
'updating wo descripton since template routers are used for wo generationg
'F.Intrinsic.Control.If(V.DataTable.Quote(V.DataTable.Quote.RowCount--).Order_NO!FieldValTrim,<>,"")
'	F.Intrinsic.String.Build("Select a.Job, a.Suffix, a.Order_No, a.Order_Line, b.Description From Order_To_WO a join V_Order_Lines b on a.Order_No = b.Order_No and a.Order_Line = b.Record_No Where a.Order_NO = '{0}'",V.DataTable.Quote(V.DataTable.Quote.RowCount--).Order_NO!FieldValTrim,V.Local.sSql)
'	F.Data.DataTable.CreateFromSQL("WO","con",V.Local.sSql,True)
'	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.WO.RowCount--,1)
'		F.Intrinsic.String.Build("Update Order_To_WO Set Description = '{2}' Where Order_No = '{0}' and Order_Line = '{1}' and Job = '{3}' and Suffix = '{4}'",V.DataTable.WO(V.Local.i).Order_No!FieldValTrim,V.DataTable.WO(V.Local.i).Order_Line!FieldValTrim,V.DataTable.WO(V.Local.i).Description!FieldValTrim,V.DataTable.WO(V.Local.i).Job!FieldValTrim,V.DataTable.WO(V.Local.i).Suffix!FieldValTrim,V.Local.sSql)
'		F.ODBC.Connection!Con.Execute(V.Local.sSql)
'		F.Intrinsic.String.Build("Update Job_Header Set Description = '{2}' Where Job = '{0}' and Suffix = '{1}'",V.DataTable.WO(V.Local.i).Job!FieldValTrim,V.DataTable.WO(V.Local.i).Suffix!FieldValTrim,V.DataTable.WO(V.Local.i).Description!FieldValTrim,V.Local.sSql)
'		F.ODBC.Connection!Con.Execute(V.Local.sSql)
'		F.Intrinsic.String.Build("Order_NO = '{0}' and Order_Line = '{1}'",V.DataTable.WO(V.Local.i).Order_No!FieldValTrim,V.DataTable.WO(V.Local.i).Order_Line!FieldValTrim,V.Local.sFilter)
'		F.Data.DataView.Create("Quote","VWO",22,V.Local.sFilter,"")
'		F.Intrinsic.Control.If(V.DataView.Quote!VWO.RowCount--,<>,-1)
'			F.Data.DataView.SetValue("Quote","VWO",-1,"Job",V.DataTable.WO(V.Local.i).Job!FieldValTrim,"Suffix",V.DataTable.WO(V.Local.i).Suffix!FieldValTrim)
'		F.Intrinsic.Control.EndIf
'		F.Data.DataView.Close("Quote","VWO")
'	F.Intrinsic.Control.Next(V.Local.i)
'	F.Data.DataTable.Close("WO")
'	
'	F.Data.DataTable.AddRow("200000","OrdNum",V.DataTable.Quote(V.DataTable.Quote.RowCount--).Order_NO!FieldValTrim,"Mode","O")
'	F.Intrinsic.Control.CallSub("200000Sync")
'	F.Data.DataTable.DeleteRow("200000")
'	F.Data.DataTable.AcceptChanges("200000")
'F.Intrinsic.Control.EndIf
F.Data.DataView.Create("Quote","VOrder",22,"","")
F.Data.DataView.ToDataTableDistinct("Quote","VOrder","OrdersNO","Order_NO",True)
F.Data.DataView.Close("Quote","VOrder")

F.Intrinsic.UI.ChangeWaitStatus("Updating Work Orders.........................")

F.Intrinsic.Control.For(V.Local.iCount,0,V.DataTable.OrdersNo.RowCount--,1)
	F.Intrinsic.Control.If(V.DataTable.OrdersNo(V.Local.iCount).Order_NO!FieldValTrim,<>,"")
		F.Intrinsic.String.Build("Select a.Job, a.Suffix, a.Order_No, a.Order_Line, b.Description From Order_To_WO a join V_Order_Lines b on a.Order_No = b.Order_No and a.Order_Line = b.Record_No Where a.Order_NO = '{0}'",V.DataTable.OrdersNo(V.Local.iCount).Order_NO!FieldValTrim,V.Local.sSql)
		F.Data.DataTable.CreateFromSQL("WO","con",V.Local.sSql,True)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.WO.RowCount--,1)
			V.Local.bSave.Set(False)
			V.Local.sTemp.Set(V.DataTable.WO(V.Local.i).Description!FieldValTrim)
			F.Intrinsic.String.Build("Update Order_To_WO Set Description = '{2}' Where Order_No = '{0}' and Order_Line = '{1}' and Job = '{3}' and Suffix = '{4}'",V.DataTable.WO(V.Local.i).Order_No!FieldValTrim,V.DataTable.WO(V.Local.i).Order_Line!FieldValTrim,V.Local.sTemp.PSQLFriendly,V.DataTable.WO(V.Local.i).Job!FieldValTrim,V.DataTable.WO(V.Local.i).Suffix!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.Execute(V.Local.sSql)
			F.Intrinsic.String.Build("Update Job_Header Set Description = '{2}' Where Job = '{0}' and Suffix = '{1}'",V.DataTable.WO(V.Local.i).Job!FieldValTrim,V.DataTable.WO(V.Local.i).Suffix!FieldValTrim,V.Local.sTemp.PSQLFriendly,V.Local.sSql)
			F.ODBC.Connection!Con.Execute(V.Local.sSql)
			F.Intrinsic.String.Build("Order_NO = '{0}' and Order_Line = '{1}'",V.DataTable.WO(V.Local.i).Order_No!FieldValTrim,V.DataTable.WO(V.Local.i).Order_Line!FieldValTrim,V.Local.sFilter)
			F.Data.DataView.Create("Quote","VWO",22,V.Local.sFilter,"")
			F.Intrinsic.Control.If(V.DataView.Quote!VWO.RowCount--,<>,-1)
				F.Data.DataView.SetValue("Quote","VWO",-1,"Job",V.DataTable.WO(V.Local.i).Job!FieldValTrim,"Suffix",V.DataTable.WO(V.Local.i).Suffix!FieldValTrim)
		
				F.Intrinsic.String.Build("Select Job, Suffix, Seq, Operation, LMO, Description, Part, Units, Hours_Estimated from Job_Operations Where Job = '{0}' and Suffix = '{1}' Order by Seq",V.DataTable.WO(V.Local.i).Job!FieldValTrim,V.DataTable.WO(V.Local.i).Suffix!FieldValTrim,V.Local.sSQL)
		
				F.Data.DataTable.CreateFromSQL("JobOp","con",V.Local.sSql,True)
				F.Intrinsic.Control.For(V.Local.iC,V.DataTable.JobOp.RowCount--,0,-1)
					V.Local.bSkip.Set(False)
					F.Intrinsic.Control.If(V.DataTable.JobOp(V.Local.iC).Seq!FieldValTrim,<,"990000")
						F.Intrinsic.Control.If(V.DataTable.JobOp(V.Local.iC).LMO!FieldValTrim,=,"M")
							F.Intrinsic.Control.SelectCase(V.DataTable.JobOp(V.Local.iC).Operation!FieldValTrim)
								F.Intrinsic.Control.Case("MAT-1")
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User48!FieldValTrim,<>,V.DataTable.JobOp(V.Local.iC).Part!FieldValTrim,"AND",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User48!FieldValTrim,<>,"")
										F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User48!FieldValTrim,V.Local.sSql)
										F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sDescription)
										F.Intrinsic.Math.Mult(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User49!FieldValFloat,V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).Unit!FieldValFloat,V.Local.fEst)
										F.Data.DataTable.SetValue("JobOp",V.Local.iC,"Part",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User48!FieldValTrim,"Description",V.Local.sDescription.Trim,"Units",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User49!FieldVal,"Hours_Estimated",V.Local.fEst)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User48!FieldValTrim,=,"")
											V.Local.bSkip.Set(True)
											F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
											V.Local.bSave.Set(True)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
									
								F.Intrinsic.Control.Case("MAT-2")
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User50!FieldValTrim,<>,V.DataTable.JobOp(V.Local.iC).Part!FieldValTrim,"AND",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User50!FieldValTrim,<>,"")
										F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User50!FieldValTrim,V.Local.sSql)
										F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sDescription)
										F.Intrinsic.Math.Mult(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User51!FieldValFloat,V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).Unit!FieldValFloat,V.Local.fEst)
										F.Data.DataTable.SetValue("JobOp",V.Local.iC,"Part",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User50!FieldValTrim,"Description",V.Local.sDescription.Trim,"Units",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User51!FieldVal,"Hours_Estimated",V.Local.fEst)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User50!FieldValTrim,=,"")
											V.Local.bSkip.Set(True)
											F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
											V.Local.bSave.Set(True)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
									
								F.Intrinsic.Control.Case("MAT-3")
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User52!FieldValTrim,<>,V.DataTable.JobOp(V.Local.iC).Part!FieldValTrim,"AND",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User52!FieldValTrim,<>,"")
										F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User52!FieldValTrim,V.Local.sSql)
										F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sDescription)
										F.Intrinsic.Math.Mult(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User53!FieldValFloat,V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).Unit!FieldValFloat,V.Local.fEst)
										F.Data.DataTable.SetValue("JobOp",V.Local.iC,"Part",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User52!FieldValTrim,"Description",V.Local.sDescription.Trim,"Units",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User53!FieldVal,"Hours_Estimated",V.Local.fEst)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User52!FieldValTrim,=,"")
											V.Local.bSkip.Set(True)
											F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
											V.Local.bSave.Set(True)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
									
								F.Intrinsic.Control.Case("MAT-4")
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User54!FieldValTrim,<>,V.DataTable.JobOp(V.Local.iC).Part!FieldValTrim,"AND",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User54!FieldValTrim,<>,"")
										F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User54!FieldValTrim,V.Local.sSql)
										F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sDescription)
										F.Intrinsic.Math.Mult(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User55!FieldValFloat,V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).Unit!FieldValFloat,V.Local.fEst)
										F.Data.DataTable.SetValue("JobOp",V.Local.iC,"Part",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User54!FieldValTrim,"Description",V.Local.sDescription.Trim,"Units",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User55!FieldVal,"Hours_Estimated",V.Local.fEst)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User54!FieldValTrim,=,"")
											V.Local.bSkip.Set(True)
											F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
											V.Local.bSave.Set(True)
										F.Intrinsic.Control.EndIf	
									F.Intrinsic.Control.EndIf
									
								F.Intrinsic.Control.Case("MAT-5")
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User56!FieldValTrim,<>,V.DataTable.JobOp(V.Local.iC).Part!FieldValTrim,"AND",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User56!FieldValTrim,<>,"")
										F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User56!FieldValTrim,V.Local.sSql)
										F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sDescription)
										F.Intrinsic.Math.Mult(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User57!FieldValFloat,V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).Unit!FieldValFloat,V.Local.fEst)
										F.Data.DataTable.SetValue("JobOp",V.Local.iC,"Part",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User56!FieldValTrim,"Description",V.Local.sDescription.Trim,"Units",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User57!FieldVal,"Hours_Estimated",V.Local.fEst)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User56!FieldValTrim,=,"")
											V.Local.bSkip.Set(True)
											F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
											V.Local.bSave.Set(True)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
									
								F.Intrinsic.Control.Case("MAT-6")
									F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User58!FieldValTrim,<>,V.DataTable.JobOp(V.Local.iC).Part!FieldValTrim,"AND",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User58!FieldValTrim,<>,"")
										F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User58!FieldValTrim,V.Local.sSql)
										F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sDescription)
										F.Intrinsic.Math.Mult(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User59!FieldValFloat,V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).Unit!FieldValFloat,V.Local.fEst)
										F.Data.DataTable.SetValue("JobOp",V.Local.iC,"Part",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User58!FieldValTrim,"Description",V.Local.sDescription.Trim,"Units",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User59!FieldVal,"Hours_Estimated",V.Local.fEst)
										V.Local.bSave.Set(True)
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User58!FieldValTrim,=,"")
											V.Local.bSkip.Set(True)
											F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
											V.Local.bSave.Set(True)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
									
							F.Intrinsic.Control.EndSelect
							
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Control.If(V.Local.bSkip,=,False)
							F.Intrinsic.Control.If(V.DataTable.JobOp(V.Local.iC).LMO!FieldValTrim,=,"L")
								F.Intrinsic.Control.SelectCase(V.DataTable.JobOp(V.Local.iC).Operation!FieldValTrim)
									F.Intrinsic.Control.Case("STIFF1")
										F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User16!FieldValTrim,=,"")
											F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
											V.Local.bSave.Set(True)
										F.Intrinsic.Control.EndIf
										
									F.Intrinsic.Control.Case("STIFF2")
										F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User16!FieldValTrim,=,"")
											F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
											V.Local.bSave.Set(True)
										F.Intrinsic.Control.EndIf
										
									F.Intrinsic.Control.Case("STIFF3")
										V.Local.sStiff3.Set(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User22!FieldValTrim)
										F.Intrinsic.Control.If(V.Local.sStiff3.UCase,=,"N","OR",V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User16!FieldValTrim,=,"")
											F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
											V.Local.bSave.Set(True)
										F.Intrinsic.Control.EndIf
									
									F.Intrinsic.Control.Case("LAB-1")
										F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User48!FieldValTrim,=,"")
											F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
											V.Local.bSave.Set(True)
										F.Intrinsic.Control.EndIf
										
									F.Intrinsic.Control.Case("LAB-2")
										F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User50!FieldValTrim,=,"")
											F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
											V.Local.bSave.Set(True)
										F.Intrinsic.Control.EndIf
										
									F.Intrinsic.Control.Case("LAB-3")
										F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User52!FieldValTrim,=,"")
											F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
											V.Local.bSave.Set(True)
										F.Intrinsic.Control.EndIf
									
									F.Intrinsic.Control.Case("LAB-4")
										F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User54!FieldValTrim,=,"")
											F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
											V.Local.bSave.Set(True)
										F.Intrinsic.Control.EndIf
										
									F.Intrinsic.Control.Case("LAB-5")
										F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User56!FieldValTrim,=,"")
											F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
											V.Local.bSave.Set(True)
										F.Intrinsic.Control.EndIf
										
									F.Intrinsic.Control.Case("LAB-6")
										F.Intrinsic.Control.If(V.DataView.Quote!VWO(V.DataView.Quote!VWO.RowCount--).User58!FieldValTrim,=,"")
											F.Data.DataTable.DeleteRow("JobOp",V.Local.iC)
											V.Local.bSave.Set(True)
										F.Intrinsic.Control.EndIf
										
								F.Intrinsic.Control.EndSelect
								
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Next(V.Local.iC)
				
				F.Intrinsic.Control.If(V.Local.bSave)
					F.Data.DataTable.SaveToDB("JobOp","con","Job_Operations","Job*!*Suffix*!*Seq",7)
					F.Intrinsic.String.Format(V.Screen.FormQuote!dtpDueDate.Value,"MM/DD/YYYY",V.Local.sDueDate)
					F.Global.APS.ScheduleJob(V.DataTable.JobOp(V.DataTable.JobOp.RowCount--).Job!FieldValTrim,V.DataTable.JobOp(V.DataTable.JobOp.RowCount--).Suffix!FieldValTrim,"B",V.Local.sDueDate)
				F.Intrinsic.Control.EndIf
			
				F.Data.DataTable.Close("JobOp")
			F.Intrinsic.Control.EndIf
			F.Data.DataView.Close("Quote","VWO")
		F.Intrinsic.Control.Next(V.Local.i)
		
		F.Data.DataTable.Close("WO")
	F.Intrinsic.Control.EndIf

F.Intrinsic.Control.Next(V.Local.iCount)

F.Intrinsic.Control.For(V.Local.iCount,0,V.DataTable.OrdersNo.RowCount--,1)
	F.Intrinsic.Control.If(V.DataTable.OrdersNo(V.Local.iCount).Order_NO!FieldValTrim,<>,"")
		F.Data.DataTable.AddRow("200000","OrdNum",V.DataTable.OrdersNo(V.Local.iCount).Order_NO!FieldValTrim,"Mode","O")
		F.Intrinsic.Control.CallSub("200000Sync")
		F.Data.DataTable.DeleteRow("200000")
		F.Data.DataTable.AcceptChanges("200000")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.iCount)

F.ODBC.Connection!Con.Close

V.Global.bOpen.Set(False)

F.Intrinsic.Control.If(V.DataTable.Cust.Exists)
	F.Data.DataTable.Close("Cust")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.OrdersNO.Exists)
	F.Data.DataTable.Close("OrdersNO")
F.Intrinsic.Control.EndIf

F.Intrinsic.UI.CloseWaitDialog

F.Data.DataTable.SetValue("QUOTE",-1,"User44",V.Caller.User)

F.Intrinsic.Control.CallSub(cmdSave_Click)

Gui.FormQuote..Enabled(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdCreate_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdCreate_Click.End

Program.Sub.Get_Data.Start
F.Intrinsic.Control.SetErrorHandler("Get_Data_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sState.Declare(String,"00:AL:AK:AR:AZ:CA:CO:CT:CX:DE:FD:FL:GA:HI:IA:ID:IL:IN:KS:KY:LA:ME:MD:MA:MI:MO:MN:MS:MT:NE:NH:NV:NJ:NC:ND:NM:NY:OH:OK:OR:PA:RI:SC:SD:TN:TP:TX:UT:VT:VA:WA:WI:WV:WY")
V.Local.i.Declare(Long,0)
V.Local.iIndex.Declare(Long,0)
V.Local.sSt.Declare(String,"")
V.Local.sUser.Declare(String,"")
V.Local.sMsg.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.sPhase.Declare(String,"")
V.Local.iRet.Declare(Long,0)
V.Local.bUpdate.Declare(Boolean,False)

Gui.FormQuote..Enabled(False)

F.Intrinsic.Control.If(V.Screen.FormQuote!txtSaleOrder.Text,=,V.Global.sPrevQuote)
	Gui.FormQuote..Enabled(True)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.Global.sPrevQuote,<>,"")
'		F.Global.General.DestroySoftLock("SO",V.Global.sPrevQuote,V.Local.i)
	F.Intrinsic.Control.EndIf
	V.Global.sPrevQuote.Set(V.Screen.FormQuote!txtSaleOrder.Text)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.Lock.Exists)
	F.Data.DataTable.Close("Lock")
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Rec_Key, User_Id, F_Date, Lock_Time From X_Lock_File Where rtrim(Rec_Key) = '{0}' and Company = '{1}'",V.Global.sPrevQuote.Trim,V.Caller.CompanyCode,V.Local.sSql)
F.ODBC.Connection!Con.OpenCompanyConnection
V.Global.bOpen.Set(True)

F.Data.DataTable.CreateFromSQL("Lock","con",V.Local.sSql,True)
F.ODBC.Connection!con.Close
V.Global.bOpen.Set(False)

F.Intrinsic.Control.If(V.DataTable.Quote.Exists)	
	F.Intrinsic.Control.If(V.DataTable.Lock.RowCount--,=,-1)
		F.ODBC.Connection!Con.OpenCompanyConnection
		V.Global.bOpen.Set(True)
		F.Intrinsic.String.Build("Select Left(Record_No,3) as SO_Line From V_Order_Lines Where Product_Line in('FS','OS','GS') and Order_No = '{0}' Order by Record_No",V.Global.sPrevQuote,V.Local.sSql)
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
		F.Intrinsic.String.Replace(V.Local.sRet,"#$#","*!*",V.Local.sRet)
		Gui.FormQuote.GsGridQuote.ColumnEdit("GQuote","Group_No","DropDownList",V.Local.sRet)
		
		F.Intrinsic.String.Build("Select Left(Record_No,3)+' |~| '+rtrim(Description) as Group_Desc, Left(Record_No,3)+' |~| '+rtrim(Description) as Group_Desc From V_Order_Lines Where Product_Line in('FS','OS','GS') and Order_No = '{0}' Order by Record_No",V.Global.sPrevQuote,V.Local.sSql)
		F.Data.Dictionary.CreateFromSQL("GRP",con,V.Local.sSql)
		Gui.FormQuote.ddlGroup.ClearItems
		Gui.FormQuote.ddlGroup.AddItems(Dictionary,"GRP")
		F.Data.Dictionary.Close("GRP")
		
		F.Intrinsic.String.Build("select Top 1 Group_No+' |~| '+rtrim(Group_Desc) from GCG_6419_SO_SIGNS Where P_Order_No = '{0}' Order by Line_Item Desc",V.Global.sPrevQuote,V.Local.sSql)
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sMsg)
		F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
			Gui.FormQuote.ddlGroup.ListIndex(0)
		F.Intrinsic.Control.Else
			Gui.FormQuote.ddlGroup.Text(V.Local.sMsg)
			V.Local.sMsg.Set("")
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.String.Build("select Top 1 Order_No, Order_Line from GCG_6419_SO_SIGNS Where P_Order_No = '{0}' and Order_Line <> '' Order by Line_Item Desc",V.Global.sPrevQuote,V.Local.sSql)
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Global.sLastOrder)
		F.Intrinsic.String.Split(V.Global.sLastOrder,"*!*",V.Global.sLastOrder)
		V.Global.sLastOrder.RedimPreserve(0,1)
		V.Global.sLastLine.Set(V.Global.sLastOrder(1))
		V.Global.sLastOrder.RedimPreserve(0,0)
		
		F.Intrinsic.String.Build("Select Left(Record_No,3) as SO_Line, rtrim(Part) as Part, rtrim(Description) as Description, Product_Line, Price, Um_Order, Qty_Ordered From V_Order_Lines Where Product_Line in('FS','OS','GS') and Order_No = '{0}' Order by Record_No",V.Global.sPrevQuote,V.Local.sSql)
		
		F.Intrinsic.Control.If(V.DataTable.SOLINES.Exists)
			F.Data.DataTable.Close("SOLINES")
		F.Intrinsic.Control.EndIf
		
		F.Data.DataTable.CreateFromSQL("SOLINES","con",V.Local.sSql,True)
		
		V.Local.sSql.Set("Select P_Order_No, P_Order_Line, Customer, Order_No, Order_Line, Job, Suffix, Line_Item, Unit")
		F.Intrinsic.Control.For(V.Local.i,1,60,1)
			F.Intrinsic.String.Build("USER{0}",V.Local.i,V.Local.sUser)
			F.Intrinsic.Control.If(V.Local.i,=,14,"OR",V.Local.i,=,17)
				F.Intrinsic.String.Build("{0}, IF(ISNUMERIC({1}) = 1 and {1} <> '',Cast(rtrim({1}) as Double),Cast(Null as Double)) as {1}",V.Local.sSql,V.Local.sUser,V.Local.sSql)
			F.Intrinsic.Control.ElseIf(V.Local.i,=,19,"OR",V.Local.i,=,21)
				F.Intrinsic.String.Build("{0}, IF(ISNUMERIC({1}) = 1 and {1} <> '',Cast(rtrim({1}) as Double),Cast(Null as Double)) as {1}",V.Local.sSql,V.Local.sUser,V.Local.sSql)
			F.Intrinsic.Control.ElseIf(V.Local.i,=,29,"OR",V.Local.i,=,31)
				F.Intrinsic.String.Build("{0}, IF(ISNUMERIC({1}) = 1 and {1} <> '',Cast(rtrim({1}) as Double),Cast(Null as Double)) as {1}",V.Local.sSql,V.Local.sUser,V.Local.sSql)
			F.Intrinsic.Control.ElseIf(V.Local.i,=,33,"OR",V.Local.i,=,35)
				F.Intrinsic.String.Build("{0}, IF(ISNUMERIC({1}) = 1 and {1} <> '',Cast(rtrim({1}) as Double),Cast(Null as Double)) as {1}",V.Local.sSql,V.Local.sUser,V.Local.sSql)
			F.Intrinsic.Control.ElseIf(V.Local.i,=,37,"OR",V.Local.i,=,39)
				F.Intrinsic.String.Build("{0}, IF(ISNUMERIC({1}) = 1 and {1} <> '',Cast(rtrim({1}) as Double),Cast(Null as Double)) as {1}",V.Local.sSql,V.Local.sUser,V.Local.sSql)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0}, rtrim({1}) as {1}",V.Local.sSql,V.Local.sUser,V.Local.sSql)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.i)
		
		F.Intrinsic.Control.If(V.Global.sLastLine.Trim,=,"")
			F.Intrinsic.UI.InvokeWaitDialog("Geting Quote Data..............")
			F.Intrinsic.String.Build("{0}, rtrim(Sign_Router) as Sign_Router, PL, UM, rtrim(Message) as Message, SF_Each, SF_Price, Group_No, rtrim(Group_Name) as Group_Name, rtrim(Group_Desc) as Group_Desc, USERH1, USERH3, USERH4, USERH5, UM_Each, Project, Phase From GCG_6419_SO_Signs Where P_Order_No = '{1}' Order by Line_Item asc",V.Local.sSql,V.Screen.FormQuote!txtSaleOrder.Text,V.Local.sSql)
		F.Intrinsic.Control.Else
			F.Intrinsic.UI.Msgbox("Do you want to add addtional Lines","Attention",4,V.Local.iRet)
			F.Intrinsic.UI.InvokeWaitDialog("Geting Quote Data..............")
			
			F.Intrinsic.Control.If(V.Local.iRet,=,6)
				V.Local.bUpdate.Set(True)
				F.Intrinsic.String.Build("{0}, rtrim(Sign_Router) as Sign_Router, PL, UM, rtrim(Message) as Message, SF_Each, SF_Price, Group_No, rtrim(Group_Name) as Group_Name, rtrim(Group_Desc) as Group_Desc, USERH1, USERH3, USERH4, USERH5, UM_Each, Project, Phase From GCG_6419_SO_Signs Where P_Order_No = '{1}' and (Order_Line = '' or Order_Line is null) Order by Line_Item asc",V.Local.sSql,V.Screen.FormQuote!txtSaleOrder.Text,V.Local.sSql)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0}, rtrim(Sign_Router) as Sign_Router, PL, UM, rtrim(Message) as Message, SF_Each, SF_Price, Group_No, rtrim(Group_Name) as Group_Name, rtrim(Group_Desc) as Group_Desc, USERH1, USERH3, USERH4, USERH5, UM_Each, Project, Phase From GCG_6419_SO_Signs Where P_Order_No = '{1}' Order by Line_Item asc",V.Local.sSql,V.Screen.FormQuote!txtSaleOrder.Text,V.Local.sSql)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
		F.Data.DataTable.CreateFromSQL("TempQ","con",V.Local.sSql,True)
		
		F.Intrinsic.Control.If(V.Global.sPrevQuote,<>,"")
'			F.Global.General.CreateSoftLock("SO",V.Global.sPrevQuote,V.Local.i)
		F.Intrinsic.Control.EndIf

		F.Intrinsic.String.Build("Select User_1,User_3,User_4,User_5, Date_Due, Customer_PO, Project From V_Order_Header Where Order_No = '{0}'",V.Global.sPrevQuote,V.Local.sSql)
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		Gui.FormQuote.txtUser1.Text(V.Local.sRet(0).Trim)
		Gui.FormQuote.txtUser3.Text(V.Local.sRet(1).Trim)
		Gui.FormQuote.txtUser4.Text(V.Local.sRet(2).Trim)
		Gui.FormQuote.txtUser5.Text(V.Local.sRet(3).Trim)
		Gui.FormQuote.dtpDueDate.Value(V.Local.sRet(4))
		Gui.FormQuote.txtCustPO.Text(V.Local.sRet(5).Trim)
		Gui.FormQuote.txtProj.Text(V.Local.sRet(6).Trim)
		Gui.FormQuote.ddlProjPhase.ClearItems
		Gui.FormQuote.ddlProjPhase.AddItem(" ",0)
		F.Intrinsic.String.Build("select rtrim(Phase), rtrim(Phase) from V_PROJECT_PHASE Where Project = '{0}'",V.Local.sRet(6).Trim,V.Local.sSql)
		F.Data.Dictionary.CreateFromSQL("Phase","con",V.Local.sSql)
		Gui.FormQuote.ddlProjPhase.AddItems("Dictionary","Phase")
		F.Data.Dictionary.Close("Phase")
		F.Intrinsic.String.Build("select rtrim(Phase) from V_PROJECT_PHASE Where Project = '{0}'",V.Local.sRet(6).Trim,V.Local.sSql)
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
		F.Intrinsic.String.Replace(V.Local.sRet,"#$#","*!*",V.Local.sRet)
		F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
			F.Intrinsic.String.Build("*!*{0}",V.Local.sRet,V.Local.sRet)
		F.Intrinsic.Control.EndIf
		gui.FormQuote.GsGridQuote.ColumnEdit("GQuote","Phase","DropDownList",V.Local.sRet)
'		F.ODBC.Connection!Con.ExecuteAndReturn("select rtrim(Text1) from V_OP_HEADER where ID = '400316' and Sequence = '0000'",V.Local.sPhase)
		F.Intrinsic.String.Build("select Top 1 rtrim(Phase) from V_PROJECT_PHASE where Project = '{0}' Order by Pos",V.Local.sRet(6).Trim,V.Local.sSql)
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPhase)
		F.ODBC.Connection!Con.Close
		V.Global.bOpen.Set(False)
		
		F.Intrinsic.Control.If(V.DataTable.TempQ.RowCount--,<>,-1)
			V.Local.sPhase.Set(V.DataTable.TempQ(V.DataTable.TempQ.RowCount--).Phase!FieldValTrim)
			F.Intrinsic.Control.If(V.DataTable.TempQ(V.DataTable.TempQ.RowCount--).Order_No!FieldValTrim,<>,"","AND",V.DataTable.TempQ(0).Order_No!FieldValTrim,<>,"")
				Gui.FormQuote.ddlRouter.Enabled(False)
				Gui.FormQuote.ddlState.Enabled(False)
				Gui.FormQuote.txtCust.Enabled(False)
				Gui.FormQuote.txtLines.Enabled(False)
'				Gui.FormQuote.dtpDueDate.Enabled(False)
				Gui.FormQuote.cmdAdd.Enabled(False)
'				Gui.FormQuote.cmdCust.Enabled(False)
				Gui.FormQuote.cmdCreate.Enabled(False)
				Gui.FormQuote.cmdSave.Enabled(False)
				Gui.FormQuote.cmdOldMat.Enabled(False)
				Gui.FormQuote.cmdNewMat.Enabled(False)
				Gui.FormQuote.cmdUpMat.Enabled(False)
				V.Global.bEditable.Set(False)
			F.Intrinsic.Control.ElseIf(V.DataTable.TempQ(V.DataTable.TempQ.RowCount--).Order_No!FieldValTrim,=,"","AND",V.DataTable.TempQ(0).Order_No!FieldValTrim,<>,"")
				Gui.FormQuote.ddlRouter.Enabled(False)
				Gui.FormQuote.ddlState.Enabled(False)
				Gui.FormQuote.txtCust.Enabled(False)
				Gui.FormQuote.txtLines.Enabled(False)
				Gui.FormQuote.cmdAdd.Enabled(False)
				Gui.FormQuote.cmdCreate.Enabled(True)
				Gui.FormQuote.cmdSave.Enabled(False)
				Gui.FormQuote.cmdOldMat.Enabled(False)
				Gui.FormQuote.cmdNewMat.Enabled(False)
				Gui.FormQuote.cmdUpMat.Enabled(False)
				V.Global.bEditable.Set(False)
				V.Global.bNew.Set(False)
			F.Intrinsic.Control.Else
				Gui.FormQuote.ddlRouter.Enabled(True)
				Gui.FormQuote.ddlState.Enabled(True)
				Gui.FormQuote.txtCust.Enabled(True)
				Gui.FormQuote.txtLines.Enabled(True)
'				Gui.FormQuote.dtpDueDate.Enabled(True)
				Gui.FormQuote.cmdAdd.Enabled(True)
'				Gui.FormQuote.cmdCust.Enabled(True)
				Gui.FormQuote.cmdCreate.Enabled(True)
				Gui.FormQuote.cmdSave.Enabled(True)
				Gui.FormQuote.cmdOldMat.Enabled(True)
				Gui.FormQuote.cmdNewMat.Enabled(True)
				Gui.FormQuote.cmdUpMat.Enabled(True)
				V.Global.bEditable.Set(True)
				V.Global.bNew.Set(True)
			F.Intrinsic.Control.EndIf
			F.Data.DataTable.DeleteRow("Quote")
			F.Data.DataTable.AcceptChanges("Quote")
			F.Data.DataTable.Merge("TempQ","Quote",False,2)
			F.Intrinsic.String.Left(V.DataTable.TempQ(V.DataTable.TempQ.RowCount--).Sign_Router!FieldVal,2,V.Local.sSt)
			F.Intrinsic.String.Split(V.Local.sState,":",V.Local.sState)
			F.Intrinsic.Control.For(V.Local.i,0,V.Local.sState.UBound,1)
				F.Intrinsic.Control.If(V.Local.sState(V.Local.i),=,V.Local.sSt)
					Gui.FormQuote.ddlState.Text(V.Local.sSt.Trim)
					F.Intrinsic.Control.ExitFor(V.Local.i)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.i)
			Gui.FormQuote.txtLines.Text("")
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.bUpdate)
				F.ODBC.Connection!Con.OpenCompanyConnection
				V.Global.bOpen.Set(True)
				F.Intrinsic.String.Build("Select Top 1 Left(Sign_Router,2) From GCG_6419_SO_SIGNS Where P_Order_No = '{0}' Order by Line_Item asc",V.Screen.FormQuote!txtSaleOrder.Text,V.Local.sSql)
				F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sSt)
				F.ODBC.Connection!Con.Close
				V.Global.bOpen.Set(False)
				F.Intrinsic.String.Split(V.Local.sState,":",V.Local.sState)
				F.Intrinsic.Control.For(V.Local.i,0,V.Local.sState.UBound,1)
					F.Intrinsic.Control.If(V.Local.sState(V.Local.i),=,V.Local.sSt)
						Gui.FormQuote.ddlState.Text(V.Local.sSt.Trim)
						F.Intrinsic.Control.ExitFor(V.Local.i)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Next(V.Local.i)
				Gui.FormQuote.txtLines.Text("")
				Gui.FormQuote.ddlRouter.Enabled(True)
				Gui.FormQuote.ddlState.Enabled(True)
				Gui.FormQuote.txtCust.Enabled(False)
				Gui.FormQuote.txtLines.Enabled(True)
				Gui.FormQuote.cmdAdd.Enabled(True)
				Gui.FormQuote.cmdCreate.Enabled(True)
				Gui.FormQuote.cmdSave.Enabled(True)
				Gui.FormQuote.cmdOldMat.Enabled(True)
				Gui.FormQuote.cmdNewMat.Enabled(True)
				Gui.FormQuote.cmdUpMat.Enabled(True)
				V.Global.bEditable.Set(True)
				V.Global.bNew.Set(True)
			F.Intrinsic.Control.Else
				Gui.FormQuote.ddlRouter.Enabled(True)
				Gui.FormQuote.ddlState.Enabled(True)
				Gui.FormQuote.txtCust.Enabled(True)
				Gui.FormQuote.txtLines.Enabled(True)
				Gui.FormQuote.cmdAdd.Enabled(True)
				Gui.FormQuote.cmdCreate.Enabled(True)
				Gui.FormQuote.cmdSave.Enabled(True)
				Gui.FormQuote.cmdOldMat.Enabled(True)
				Gui.FormQuote.cmdNewMat.Enabled(True)
				Gui.FormQuote.cmdUpMat.Enabled(True)
				V.Global.bEditable.Set(True)
				V.Global.bNew.Set(True)
			F.Intrinsic.Control.EndIf
			F.Data.DataTable.DeleteRow("Quote")
			F.Data.DataTable.AcceptChanges("Quote")
		F.Intrinsic.Control.EndIf
		Gui.FormQuote.ddlProjPhase.Text(V.Local.sPhase)
		F.Data.DataTable.Close("TempQ")
		F.Intrinsic.Control.CallSub(ddlState_Change)
		F.Intrinsic.UI.CloseWaitDialog
	F.Intrinsic.Control.Else
		V.Global.sPrevQuote.Set("")
		F.Intrinsic.String.Build("Sales Order is Locked by User: {0}",V.DataTable.Lock(V.DataTable.Lock.RowCount--).User_ID!Fieldvaltrim,V.Local.sMsg)
		F.Intrinsic.UI.Msgbox(V.Local.sMsg)
		F.Intrinsic.Control.BlockEvents
		Gui.FormQuote.txtSaleOrder.Text("")
		Gui.FormQuote.ddlState.Text("")
		Gui.FormQuote.txtUser1.Text("")
		Gui.FormQuote.txtUser3.Text("")
		Gui.FormQuote.txtUser4.Text("")
		Gui.FormQuote.txtUser5.Text("")
		Gui.FormQuote.txtLines.Text("")
		Gui.FormQuote.txtCust.Text("")
		Gui.FormQuote.txtCustPO.Text("")
		Gui.FormQuote.ddlRouter.Enabled(True)
		Gui.FormQuote.ddlState.Enabled(True)
		Gui.FormQuote.txtCust.Enabled(True)
		Gui.FormQuote.txtLines.Enabled(True)
'		Gui.FormQuote.dtpDueDate.Enabled(True)
		Gui.FormQuote.cmdAdd.Enabled(True)
'		Gui.FormQuote.cmdCust.Enabled(True)
		Gui.FormQuote.cmdCreate.Enabled(True)
		Gui.FormQuote.cmdSave.Enabled(True)
		Gui.FormQuote.cmdOldMat.Enabled(True)
		Gui.FormQuote.cmdNewMat.Enabled(True)
			Gui.FormQuote.cmdUpMat.Enabled(True)
		V.Global.bEditable.Set(True)
		F.Data.DataTable.DeleteRow("Quote")
		F.Data.DataTable.AcceptChanges("Quote")
		F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.Intrinsic.String.Split(V.Local.sState,":",V.Local.sState)
	
	F.Data.DataTable.Create("Quote",True)
	F.Data.DataTable.AddColumn("Quote","P_Order_no","String")
	F.Data.DataTable.AddColumn("Quote","P_Order_Line","String")
	F.Data.DataTable.AddColumn("Quote","Customer","String")
	F.Data.DataTable.AddColumn("Quote","Order_NO","String")
	F.Data.DataTable.AddColumn("Quote","Order_Line","String")
	F.Data.DataTable.AddColumn("Quote","Job","String")
	F.Data.DataTable.AddColumn("Quote","Suffix","String")
	F.Data.DataTable.AddColumn("Quote","LINE_ITEM","Long")
	F.Data.DataTable.AddColumn("Quote","Unit","Float")
	F.Data.DataTable.AddColumn("Quote","SIGN_ROUTER","String")
	F.Data.DataTable.AddColumn("Quote","PL","String")
	F.Data.DataTable.AddColumn("Quote","UM","String")
	F.Data.DataTable.AddColumn("Quote","MESSAGE","String")
	F.Data.DataTable.AddColumn("Quote","SF_EACH","Float")
	F.Data.DataTable.AddColumn("Quote","SF_PRICE","Float")
	F.Data.DataTable.AddExpressionColumn("QUOTE","TOTL_SF",Float,"[SF_EACH] * [Unit]")
	F.Data.DataTable.AddColumn("Quote","Group_No","String")
	F.Data.DataTable.AddColumn("Quote","Group_Name","String")
	F.Data.DataTable.AddColumn("Quote","Group_Desc","String")
	F.Data.DataTable.AddColumn("Quote","Delete_Row","String")
	F.Data.DataTable.AddColumn("Quote","USERH1","String")
	F.Data.DataTable.AddColumn("Quote","USERH3","String")
	F.Data.DataTable.AddColumn("Quote","USERH4","String")
	F.Data.DataTable.AddColumn("Quote","USERH5","String")
	F.Data.DataTable.AddColumn("Quote","UM_EACH","Float")
	F.Data.DataTable.AddColumn("Quote","PROJECT","String")
	F.Data.DataTable.AddColumn("Quote","PHASE","String")
	
	F.Data.DataTable.Create("Routers",True)
	F.Data.DataTable.AddColumn("Routers","Selection","Boolean")
	F.Data.DataTable.AddColumn("Routers","Router","String")
	
	F.Data.DataTable.Create("UserFields",True)
	F.Data.DataTable.AddColumn("UserFields","Selection","Boolean")
	F.Data.DataTable.AddColumn("UserFields","Router","String")
	F.Data.DataTable.AddColumn("UserFields","UserField","String")
	F.Data.DataTable.AddColumn("UserFields","Caption","String")
	F.Data.DataTable.AddColumn("UserFields","Value","String")
	
	F.Data.DataView.Create("Routers","VRouters",22,"Selection = True","")
	F.Data.DataView.Create("UserFields","VUserFields",22,"Selection = True","")
	
	F.ODBC.Connection!Con.OpenCompanyConnection(999)
	V.Global.bOpen.Set(True)
	
	F.Data.DataTable.CreateFromSQL("RDDL","con","Select rtrim(ucase(Router)) as Router1, rtrim(ucase(Router)) as Router2 From V_ROUTER_HEADER Order by Router",True)
	
	F.Data.DataTable.CreateFromSQL("UserCap","con","Select * From GCG_6313_RTR_EXT_TIT",True)
	
	F.Intrinsic.Control.For(v.Local.i,1,60,1)
		F.Intrinsic.String.Build("USER{0}",V.Local.i,V.Local.sUser)
		F.Intrinsic.Control.If(V.Local.i,=,14,"OR",V.Local.i,=,17)
			F.Data.DataTable.AddColumn("Quote",V.Local.sUser,"Float")
		F.Intrinsic.Control.ElseIf(V.Local.i,=,19,"OR",V.Local.i,=,21)
			F.Data.DataTable.AddColumn("Quote",V.Local.sUser,"Float")
		F.Intrinsic.Control.ElseIf(V.Local.i,=,29,"OR",V.Local.i,=,31)
			F.Data.DataTable.AddColumn("Quote",V.Local.sUser,"Float")
		F.Intrinsic.Control.ElseIf(V.Local.i,=,33,"OR",V.Local.i,=,35)
			F.Data.DataTable.AddColumn("Quote",V.Local.sUser,"Float")
		F.Intrinsic.Control.ElseIf(V.Local.i,=,37,"OR",V.Local.i,=,39)
			F.Data.DataTable.AddColumn("Quote",V.Local.sUser,"Float")
		F.Intrinsic.Control.Else
			F.Data.DataTable.AddColumn("Quote",V.Local.sUser,"String")
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataTable.UserCap.RowCount--,<>,-1)
			F.Data.DataTable.AddRow("UserFields","UserField",V.Local.sUser,"Caption",V.DataTable.UserCap(V.DataTable.UserCap.RowCount--).[V.Local.sUser]!FieldValTrim)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)

	F.Data.DataTable.SetValue("UserFields",-1,"SELECTION",False)
	
	Gui.FormQuote.ddlState.AddItem(" ",0)
	
	F.Intrinsic.Control.For(V.Local.i,0,V.Local.sState.UBound,1)
		F.Intrinsic.Math.Add(V.Local.i,1,V.Local.iIndex)
		Gui.FormQuote.ddlState.AddItem(V.Local.sState(V.Local.i),V.Local.iIndex)
	F.Intrinsic.Control.Next(V.Local.i)
	
	'user1
	F.ODBC.Connection!Con.ExecuteAndReturn("select Label from OE_USER_FLDS_HDR Where Key_ID = '01'",V.Local.sSql)
	Gui.FormQuote.lblUser1.Caption(V.Local.sSql)
	'user3
	F.ODBC.Connection!Con.ExecuteAndReturn("select Label from OE_USER_FLDS_HDR Where Key_ID = '03'",V.Local.sSql)
	Gui.FormQuote.lblUser3.Caption(V.Local.sSql)
	'user4
	F.ODBC.Connection!Con.ExecuteAndReturn("select Label from OE_USER_FLDS_HDR Where Key_ID = '04'",V.Local.sSql)
	Gui.FormQuote.lblUser4.Caption(V.Local.sSql)
	'user5
	F.ODBC.Connection!Con.ExecuteAndReturn("select Label from OE_USER_FLDS_HDR Where Key_ID = '05'",V.Local.sSql)
	Gui.FormQuote.lblUser5.Caption(V.Local.sSql)
	F.ODBC.Connection!Con.Close
	V.Global.bOpen.Set(False)
F.Intrinsic.Control.EndIf

'F.Intrinsic.Control.If(V.DataTable.Quote.RowCount--,<>,-1)
'	F.Intrinsic.Control.If(V.DataTable.Quote(V.DataTable.Quote.RowCount--).Quick_Quote!FieldValTrim,<>,"")
'		Gui.FormQuote.cmdGenQuote.Enabled(False)
'		Gui.FormQuote.lblQQ.Caption(V.DataTable.Quote(V.DataTable.Quote.RowCount--).Quick_Quote!FieldValTrim)
'	F.Intrinsic.Control.Else
'		Gui.FormQuote.cmdGenQuote.Enabled(True)
'		Gui.FormQuote.lblQQ.Caption(" ")
'	F.Intrinsic.Control.EndIf
'F.Intrinsic.Control.Else
'	Gui.FormQuote.cmdGenQuote.Enabled(True)
'	Gui.FormQuote.lblQQ.Caption(" ")
'F.Intrinsic.Control.EndIf

Gui.FormQuote..Enabled(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Get_Data_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Get_Data.End

Program.Sub.Set_Properties.Start
F.Intrinsic.Control.SetErrorHandler("Set_Properties_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sUser.Declare(String,"")

gui.FormQuote.GsGridQuote.AddGridviewFromDatatable("GQuote","Quote")

gui.FormQuote.GsGridQuote.SetGridviewProperty("GQuote", "OptionsViewColumnAutoWidth", False)
gui.FormQuote.GsGridQuote.SetGridviewProperty("GQuote","ShowGroupPanel",True)

gui.FormQuote.GsGridQuote.ColumnEdit("GQuote","Delete_Row","EditorButton","Delete Row")
gui.FormQuote.GsGridQuote.ColumnEdit("GQuote","PL","DropDownList"," *!*FX*!*GX*!*OX")
gui.FormQuote.GsGridQuote.ColumnEdit("GQuote","Group_No","DropDownList"," ")
gui.FormQuote.GsGridQuote.ColumnEdit("GQuote","SIGN_ROUTER","DropDownList","")
gui.FormQuote.GsGridQuote.ColumnEdit("GQuote","PHASE","DropDownList","")

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","P_Order_No","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","P_Order_No","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","P_Order_No","caption","PARENT ORDER NO")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","P_Order_No","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","P_Order_No","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","P_Order_No","Visible", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","P_Order_Line","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","P_Order_Line","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","P_Order_Line","caption","PARENT ORDER LINE")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","P_Order_Line","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","P_Order_Line","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","P_Order_Line","Visible", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer","caption","CUSTOMER")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Customer","Visible", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_No","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_No","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_No","caption","ORDER NO")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_No","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_No","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_No","Visible", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_Line","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_Line","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_Line","caption","ORDER LINE")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_Line","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_Line","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Order_Line","Visible", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH1","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH1","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH1","caption","USERH1")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH1","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH1","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH1","Visible", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH1","AllowShowHide", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH3","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH3","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH3","caption","USERH3")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH3","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH3","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH3","Visible", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH3","AllowShowHide", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH4","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH4","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH4","caption","USERH4")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH4","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH4","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH4","Visible", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH4","AllowShowHide", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH5","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH5","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH5","caption","USERH5")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH5","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH5","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH5","Visible", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","USERH5","AllowShowHide", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Job","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Job","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Job","caption","JOB")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Job","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Job","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Job","Visible", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Suffix","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Suffix","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Suffix","caption","SUFFIX")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Suffix","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Suffix","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Suffix","Visible", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","LINE_ITEM","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","LINE_ITEM","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","LINE_ITEM","caption","LINE ITEM")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","LINE_ITEM","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","LINE_ITEM","allowedit", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Unit","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Unit","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Unit","caption","# OF SIGNS")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Unit","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Unit","allowedit", True)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SIGN_ROUTER","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SIGN_ROUTER","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SIGN_ROUTER","caption","SIGN ROUTER")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SIGN_ROUTER","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SIGN_ROUTER","allowedit", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SIGN_ROUTER","MaxLength","20")


gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PROJECT","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PROJECT","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PROJECT","caption","PROJECT")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PROJECT","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PROJECT","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PROJECT","MaxLength","7")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PROJECT","Visible", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PHASE","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PHASE","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PHASE","caption","PHASE")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PHASE","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PHASE","allowedit", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PHASE","MaxLength","4")

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PL","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PL","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PL","caption","PL")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PL","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","PL","allowedit", True)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM","caption","UM")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM","allowedit", False)
Gui.FormQuote.GsGridQuote.ColumnEdit("GQuote","UM","DropDownList","EA*!*SF*!*AS")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM","Visible", False)
'gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM","AllowShowHide", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","MESSAGE","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","MESSAGE","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","MESSAGE","caption","SALES ORDER MESSAGE")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","MESSAGE","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","MESSAGE","allowedit", True)
'gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","MESSAGE","MaxLength","70")

F.Intrinsic.Control.For(V.Local.i,1,60,1)
	F.Intrinsic.String.Build("USER{0}",V.Local.i,V.Local.sUser)
	F.Intrinsic.Control.If(V.DataTable.UserCap.RowCount--,<>,-1)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"headerforecolor", v.Color.PRI-GSS-00)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"headerfontbold", true)
		F.Intrinsic.Control.If(V.DataTable.UserCap(V.DataTable.UserCap.RowCount--).[V.Local.sUser]!FieldValTrim,<>,"")
			gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"caption",V.DataTable.UserCap(V.DataTable.UserCap.RowCount--).[V.Local.sUser]!FieldValTrim)
			gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"Visible", True)
		F.Intrinsic.Control.Else
			gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"caption",V.Local.sUser)
			gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"Visible", False)
		F.Intrinsic.Control.EndIf
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"readonly", False)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"allowedit", True)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"MaxLength","70")
	F.Intrinsic.Control.Else
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"headerforecolor", v.Color.PRI-GSS-00)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"headerfontbold", true)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"caption",V.Local.sUser)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"Visible", False)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"readonly", False)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"allowedit", True)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"MaxLength","70")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.i)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_EACH","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_EACH","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_EACH","caption","SF EACH")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_EACH","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_EACH","allowedit", True)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM_EACH","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM_EACH","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM_EACH","caption","SF PRICE")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM_EACH","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","UM_EACH","allowedit", True)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_PRICE","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_PRICE","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_PRICE","caption","PRICE")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_PRICE","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","SF_PRICE","allowedit", False)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","TOTL_SF","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","TOTL_SF","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","TOTL_SF","caption","TOTAL SF")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","TOTL_SF","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","TOTL_SF","allowedit", True)

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_No","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_No","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_No","caption","GROUP")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_No","readonly", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_No","allowedit", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_No","MaxLength","50")

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Name","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Name","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Name","caption","GROUP NAME")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Name","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Name","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Name","MaxLength","50")

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Desc","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Desc","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Desc","caption","GROUP DESCRIPTION")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Desc","readonly", True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Desc","allowedit", False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Group_Desc","MaxLength","50")

gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Delete_Row","headerforecolor", v.Color.PRI-GSS-00)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Delete_Row","headerfontbold", true)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Delete_Row","caption"," ")
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Delete_Row","ReadOnly",True)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Delete_Row","AllowEdit",False)
gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote","Delete_Row","Fixed","Right")

Gui.FormQuote.GsGridQuote.AddSummaryItem("GQuote","TOTL_SF","TOTL_SF","Sum","SQ FT: ","")
Gui.FormQuote.GsGridQuote.AddGridGroupSummaryItem("GQuote","TOTL_SF","TOTL_SFTag","Sum","SF Sum: ","","N0")

gui.FormQuote.GsGridQuote.MainView("GQuote")

F.Intrinsic.Control.CallSub(Deserialize, "FORM", "FormQuote", "GRIDCONTROL", "GsGridQuote", "GRIDVIEW", "GQuote", "REGID", 6419)

F.Intrinsic.Control.For(V.Local.i,1,60,1)
	F.Intrinsic.String.Build("USER{0}",V.Local.i,V.Local.sUser)
	F.Intrinsic.Control.If(V.DataTable.UserCap.RowCount--,<>,-1)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"headerforecolor", v.Color.PRI-GSS-00)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"headerfontbold", true)
		F.Intrinsic.Control.If(V.DataTable.UserCap(V.DataTable.UserCap.RowCount--).[V.Local.sUser]!FieldValTrim,<>,"")
			gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"caption",V.DataTable.UserCap(V.DataTable.UserCap.RowCount--).[V.Local.sUser]!FieldValTrim)
			gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"Visible", True)
		F.Intrinsic.Control.Else
			gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"caption",V.Local.sUser)
			gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"Visible", False)
		F.Intrinsic.Control.EndIf
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"readonly", False)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"allowedit", True)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"MaxLength","70")
	F.Intrinsic.Control.Else
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"headerforecolor", v.Color.PRI-GSS-00)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"headerfontbold", true)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"caption",V.Local.sUser)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"Visible", False)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"readonly", False)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"allowedit", True)
		gui.FormQuote.GsGridQuote.SetColumnProperty("GQuote",V.Local.sUser,"MaxLength","70")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.i)

gui.FormRouter.GsGridRouter.AddGridviewFromDatatable("GRouters","Routers")

gui.FormRouter.GsGridRouter.SetGridviewProperty("GRouters", "OptionsViewColumnAutoWidth", True)
gui.FormRouter.GsGridRouter.SetGridviewProperty("GRouters","ShowGroupPanel",True)

gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Selection","headerforecolor", v.Color.PRI-GSS-00)
gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Selection","headerfontbold", true)
gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Selection","caption","SELECTION")
gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Selection","readonly", False)
gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Selection","allowedit", True)

gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Router","headerforecolor", v.Color.PRI-GSS-00)
gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Router","headerfontbold", true)
gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Router","caption","ROUTER")
gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Router","readonly", True)
gui.FormRouter.GsGridRouter.SetColumnProperty("GRouters","Router","allowedit", False)

gui.FormRouter.GsGridRouter.MainView("GRouters")

gui.FormRouter.GsGridUserFields.AddGridviewFromDatatable("GUserFields","UserFields")

gui.FormRouter.GsGridUserFields.SetGridviewProperty("GUserFields", "OptionsViewColumnAutoWidth", True)
gui.FormRouter.GsGridUserFields.SetGridviewProperty("GUserFields","ShowGroupPanel",True)

gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Selection","headerforecolor", v.Color.PRI-GSS-00)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Selection","headerfontbold", true)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Selection","caption","SELECTION")
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Selection","readonly", False)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Selection","allowedit", True)

gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Router","headerforecolor", v.Color.PRI-GSS-00)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Router","headerfontbold", true)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Router","caption","ROUTER")
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Router","readonly", True)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Router","allowedit", False)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Router","Visible", False)

gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","UserField","headerforecolor", v.Color.PRI-GSS-00)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","UserField","headerfontbold", true)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","UserField","caption","USER FIELD")
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","UserField","readonly", True)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","UserField","allowedit", False)

gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Caption","headerforecolor", v.Color.PRI-GSS-00)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Caption","headerfontbold", true)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Caption","caption","CAPTION")
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Caption","readonly", True)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Caption","allowedit", False)

gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Value","headerforecolor", v.Color.PRI-GSS-00)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Value","headerfontbold", true)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Value","caption","VALUE")
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Value","readonly", False)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Value","allowedit", True)
gui.FormRouter.GsGridUserFields.SetColumnProperty("GUserFields","Value","MaxLength","70")

gui.FormRouter.GsGridUserFields.MainView("GUserFields")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Set_Properties_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Set_Properties.End

Program.Sub.Serialize.Start
'pass FORM, GRIDCONTROL, GRIDVIEW, REGID
F.Intrinsic.Control.SetErrorHandler("Serialize_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSerialize.Declare(String)
V.Local.sForm.Declare(String)
V.Local.sGridControl.Declare(String)
V.Local.sGridView.Declare(String)
V.Local.sREGID.Declare(String)
V.Local.iUser.Declare(Long)
V.Local.sSql.Declare(String)

V.Local.sForm.Set(V.Args.Form.Trim)
V.Local.sGridControl.Set(V.Args.GridControl.Trim)
V.Local.sGridView.Set(V.Args.GridView.Trim)
V.Local.sREGID.Set(V.Args.REGID.Trim)

GUI.[V.Local.sForm].[V.Local.sGridControl].Serialize(V.Local.sGridView, V.Local.sSerialize)

F.Global.Registry.AddValue(V.Caller.User, V.Caller.CompanyCode, V.Local.sGridView, V.Local.sREGID, 1, False, "Serialize", False, 0, -999.0 , 1/1/1980, 12:00:00 AM, V.Local.sSerialize)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Serialize_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.End
Function.Intrinsic.Control.EndIf
Program.Sub.Serialize.End

Program.Sub.Deserialize.Start
'pass FORM, GRIDCONTROL, GRIDVIEW, REGID
F.Intrinsic.Control.SetErrorHandler("Deserialize_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSerialize.Declare(String)
V.Local.sForm.Declare(String)
V.Local.sGridControl.Declare(String)
V.Local.sGridView.Declare(String)
V.Local.sREGID.Declare(String)

V.Local.sForm.Set(V.Args.Form.Trim)
V.Local.sGridControl.Set(V.Args.GridControl.Trim)
V.Local.sGridView.Set(V.Args.GridView.Trim)
V.Local.sREGID.Set(V.Args.REGID.Trim)

F.Global.Registry.ReadValue(V.Caller.User, V.Caller.CompanyCode, V.Local.sGridView, V.Local.sREGID, 1, 6, "", V.Local.sSerialize)

F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
	Gui.[V.Local.sForm].[V.Local.sGridControl].Deserialize(V.Local.sSerialize)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Deserialize_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Deserialize.End

Program.Sub.cmdExport_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdExport_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.bExcel.Declare(Boolean,False)
V.Local.sFileExport.Declare(String,"")
V.Local.bFileLocked.Declare(Boolean,False)
V.Local.sMsg.Declare(String,"")
	
F.Automation.MSExcel.CheckPresence(V.Local.bExcel)
'exporting grid to an excel file or csv
F.Intrinsic.Control.If(V.Local.bExcel)
	F.Intrinsic.String.Build("{0}GCG_6419_{1}_Export.xlsx",V.Caller.LocalGssTempDir,"GsGridQuote",V.Local.sFileExport)
	F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
	F.Intrinsic.Control.If(V.Local.bFileLocked)
		F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
		F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
	F.Intrinsic.Control.Else
		Gui.FormQuote.GsGridQuote.Export(V.Local.sFileExport,"xlsx")
		F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("{0}GCG_6419_{1}_Export.csv",V.Caller.LocalGssTempDir,"GsGridQuote",V.Local.sFileExport)
	F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
	F.Intrinsic.Control.If(V.Local.bFileLocked)
		F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
		F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
	F.Intrinsic.Control.Else
		Gui.FormQuote.GsGridQuote.Export(V.Local.sFileExport,"csv")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdExport_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdExport_Click.End

Program.Sub.ddlState_Change.Start
F.Intrinsic.Control.SetErrorHandler("ddlState_Change_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.sFilter.Declare(String,"")

f.Intrinsic.Control.BlockEvents

Gui.FormQuote.ddlRouter.ClearItems
Gui.FormQuote.ddlRouter.AddItem(" ",0)

F.Intrinsic.Control.If(V.Screen.FormQuote!ddlState.Value,<>,"")
'	F.ODBC.Connection!Con.OpenCompanyConnection(999)
	'populating dropdown control and dropdown within the grid
	F.Intrinsic.String.Build("ROUTER1 Like '{0}*' or ROUTER1 Like 'IMPORT*'",V.Screen.FormQuote!ddlState.Text,V.Local.sFilter)
	F.Data.DataView.Create("RDDL","Temp",22,V.Local.sFilter,"")
	F.Data.Dictionary.CreateFromDataView("Router","RDDL","Temp","Router1","Router2")
	F.Data.DataView.ToDataTableDistinct("RDDL","Temp","RDDLTemp","Router1",True)
	F.Data.DataView.Close("RDDL","Temp")
	F.Data.DataView.Create("RDDLTemp","Temp",22,"","")
	F.Data.DataView.ToString("RDDLTemp","Temp","Router1",V.Ambient.NewLine,"*!*",V.Local.sRouter)
	F.Data.DataView.Close("RDDLTemp","Temp")
	F.Data.DataTable.Close("RDDLTemp")
'	F.Intrinsic.String.Build("Select rtrim(ucase(Router)), rtrim(ucase(Router)) From V_ROUTER_HEADER Where ucase(Router) like '{0}%' Order by Router",V.Screen.FormQuote!ddlState.Text,V.Local.sSql)
'	F.Data.Dictionary.CreateFromSQL("Router","con",V.Local.sSql)
	Gui.FormQuote.ddlRouter.AddItems("Dictionary","Router")
	F.Data.Dictionary.Close("Router")
	
'	F.Intrinsic.String.Build("Select rtrim(ucase(Router)) From V_ROUTER_HEADER Where ucase(Router) like '{0}%' Order by Router",V.Screen.FormQuote!ddlState.Text,V.Local.sSql)
'	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRouter)
'	F.ODBC.Connection!Con.Close
	
'	F.Intrinsic.String.Replace(V.Local.sRouter,"#$#","*!*",V.Local.sRouter)
	F.Intrinsic.Control.If(V.Local.sRouter.Trim,<>,"")
		F.Intrinsic.String.Build("*!*{0}",V.Local.sRouter,V.Local.sRouter)
	F.Intrinsic.Control.EndIf
	gui.FormQuote.GsGridQuote.ColumnEdit("GQuote","SIGN_ROUTER","DropDownList",V.Local.sRouter)

F.Intrinsic.Control.EndIf

f.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlState_Change_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlState_Change.End

Program.Sub.txtSaleOrder_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSaleOrder_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtSaleOrder.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSaleOrder_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSaleOrder_GotFocus.End

Program.Sub.txtSaleOrder_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSaleOrder_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sCust.Declare(String,"")

F.Intrinsic.Control.If(V.Screen.FormQuote!txtSaleOrder.Text,=,V.Global.sPrevQuote)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Customer From V_ORDER_HEADER Where Order_No = '{0}'",V.Screen.FormQuote!txtSaleOrder.Text,V.Local.sSql)

F.ODBC.Connection!con.OpenCompanyConnection
V.Global.bOpen.Set(True)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sCust)
F.ODBC.Connection!Con.Close
V.Global.bOpen.Set(False)
F.Intrinsic.Control.If(V.Local.sCust,=,"")
	F.Intrinsic.UI.Msgbox("Invalid Quote Number")
	F.Intrinsic.Control.BlockEvents
	Gui.FormQuote.txtCust.Text("")
	Gui.FormQuote.txtSaleOrder.Text("")
	Gui.FormQuote.txtCust.SetFocus
	F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.Else
	Gui.FormQuote.txtCust.Text(V.Local.sCust.Trim)
	F.Intrinsic.Control.CallSub(Get_Data)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSaleOrder_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSaleOrder_LostFocus.End

Program.Sub.txtSaleOrder_KeyPressEnter.Start
F.Intrinsic.Control.SetErrorHandler("txtSaleOrder_KeyPressEnter_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sCust.Declare(String,"")

F.Intrinsic.Control.If(V.Screen.FormQuote!txtSaleOrder.Text,=,V.Global.sPrevQuote)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Customer From V_ORDER_HEADER Where Order_No = '{0}'",V.Screen.FormQuote!txtSaleOrder.Text,V.Local.sSql)

F.ODBC.Connection!con.OpenCompanyConnection
V.Global.bOpen.Set(True)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sCust)
F.ODBC.Connection!Con.Close
V.Global.bOpen.Set(False)
F.Intrinsic.Control.If(V.Local.sCust,=,"")
	F.Intrinsic.UI.Msgbox("Invalid Quote Number")
	F.Intrinsic.Control.BlockEvents
	Gui.FormQuote.txtCust.Text("")
	Gui.FormQuote.txtSaleOrder.Text("")
	Gui.FormQuote.txtCust.SetFocus
	F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.Else
	Gui.FormQuote.txtCust.Text(V.Local.sCust.Trim)
	F.Intrinsic.Control.CallSub(Get_Data)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSaleOrder_KeyPressEnter_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSaleOrder_KeyPressEnter.End

Program.Sub.cmdSO_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdSO_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")
V.Local.sRet.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.SetBrowserOOT(True)

V.Local.sSql.Set("Select Distinct a.Order_No, a.Customer, a.User_1 From V_ORDER_HEADER a Join V_Order_Lines b on a.Order_No = b.Order_No Where Product_Line in('FS','OS','GS') Order by a.Order_NO") 
V.Local.sTitles.Set("Sales Order*!*Customer*!*Rocal Job")
V.Local.sWidths.Set("1800*!*1800*!*1800")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.ODBC.Connection!Con.OpenCompanyConnection
V.Global.bOpen.Set(True)
F.Intrinsic.UI.Browser("Select Sales Order","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,9000,V.Local.sRet)

F.ODBC.Connection!Con.Close
V.Global.bOpen.Set(False)
	
F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	Gui.FormQuote.txtSaleOrder.Text(V.Local.sRet.Trim)
	Gui.FormQuote.txtCust.Text(V.Local.sRet(1).Trim)
	F.Intrinsic.Control.CallSub(Get_Data)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdSO_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdSO_Click.End

Program.Sub.txtLines_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtLines_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtLines.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtLines_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtLines_GotFocus.End

Program.Sub.cmdAdd_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdAdd_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.iLineItem.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.sGroup.Declare(String,"")
V.Local.sGName.Declare(String,"")
V.Local.sGDesc.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sSign.Declare(String,"")
V.Local.iU.Declare(Long,0)
V.Local.sUser.Declare(String,"")
V.Local.sSize.Declare(String,"")
V.Local.sPL.Declare(String,"")
V.Local.sQuote.Declare(String,"")
V.Local.sUM.Declare(String,"")
V.Local.fPrice.Declare(Float,0)
V.Local.sGPL.Declare(String,"")
V.Local.sSOLine.Declare(String,"")
V.Local.fTemp.Declare(Float,0)
V.Local.sFilter.Declare(String,"")
V.Local.fSumUnit.Declare(Float,0)
V.Local.sTemp.Declare(String,"")

Gui.FormQuote..Enabled(False)

'After selectinga Router this sub adds that router to the grid x amount of times and auto files the user info

V.Local.sQuote.Set(V.Screen.FormQuote!txtSaleOrder.Text)
F.Intrinsic.Control.If(V.Local.sQuote.Trim,=,"")
	F.Intrinsic.UI.Msgbox("Create a Custom Quote or Select an existing Custom Quote to add lines","Attention")
	Gui.FormQuote..Enabled(True)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.OpenCompanyConnection(999)
V.Global.bOpen.Set(True)

F.Intrinsic.Control.If(V.DataTable.Quote.RowCount--,<>,-1)
	V.Local.iLineItem.Set(V.DataTable.Quote(V.DataTable.Quote.RowCount--).Line_Item!FieldVal)
'	V.Local.sGroup.Set(V.DataTable.Quote(V.DataTable.Quote.RowCount--).Group_No!FieldVal)
'	V.Local.sGName.Set(V.DataTable.Quote(V.DataTable.Quote.RowCount--).Group_Name!FieldValTrim)
'	V.Local.sGDesc.Set(V.DataTable.Quote(V.DataTable.Quote.RowCount--).Group_Desc!FieldValTrim)
'	V.Local.fPrice.Set(V.DataTable.Quote(V.DataTable.Quote.RowCount--).SF_Price!FieldValFloat)
'	V.Local.sUM.Set(V.DataTable.Quote(V.DataTable.Quote.RowCount--).UM!FieldVal)
'	V.Local.sSOLine.Set(V.DataTable.Quote(V.DataTable.Quote.RowCount--).P_Order_Line!FieldValTrim)
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.Global.sLastLine.Trim,<>,"")
		F.Intrinsic.String.Build("select Top 1 Line_Item, Group_No from GCG_6419_SO_SIGNS Where P_Order_No = '{0}' Order by Line_Item Desc",V.Global.sPrevQuote,V.Local.sSql)
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sTemp)
		F.Intrinsic.String.Split(V.Local.sTemp,"*!*",V.Local.sTemp)
		F.Intrinsic.Control.If(V.Local.sTemp(1).Trim,<>,"")
			V.Local.iLineItem.Set(V.Local.sTemp.Long)
'			F.Intrinsic.String.Build("SO_Line > '{0}'",V.Local.sTemp(1).Trim,V.Local.sFilter)
'			F.Data.DataView.Create("SOLINES","VLine",22,V.Local.sFilter,"SO_Line")
'			F.Intrinsic.Control.If(V.DataView.SOLINES!VLine.RowCount--,<>,-1)
'				V.Local.sGroup.Set(V.DataView.SOLINES!VLine(0).SO_Line!FieldVal)
'				V.Local.sGName.Set(V.DataView.SOLINES!VLine(0).Part!FieldValTrim)
'				V.Local.sGDesc.Set(V.DataView.SOLINES!VLine(0).Description!FieldValTrim)
'				V.Local.fPrice.Set(V.DataView.SOLINES!VLine(0).Price!FieldValFloat)
'				V.Local.sUM.Set(V.DataView.SOLINES!VLine(0).UM_Order!FieldVal)
'				F.Intrinsic.String.Build("{0}0",V.Local.sGroup,V.Local.sSOLine)
'			F.Intrinsic.Control.Else
'				V.Local.sGroup.Set(V.DataTable.SOLINES(V.DataTable.SOLINES.RowCount--).SO_Line!FieldVal)
'				V.Local.sGName.Set(V.DataTable.SOLINES(V.DataTable.SOLINES.RowCount--).Part!FieldValTrim)
'				V.Local.sGDesc.Set(V.DataTable.SOLINES(V.DataTable.SOLINES.RowCount--).Description!FieldValTrim)
'				V.Local.fPrice.Set(V.DataTable.SOLINES(V.DataTable.SOLINES.RowCount--).Price!FieldValFloat)
'				V.Local.sUM.Set(V.DataTable.SOLINES(V.DataTable.SOLINES.RowCount--).UM_Order!FieldVal)
'				F.Intrinsic.String.Build("{0}0",V.Local.sGroup,V.Local.sSOLine)
'			F.Intrinsic.Control.EndIf
'			F.Data.DataView.Close("SOLINES","VLine")
		F.Intrinsic.Control.Else
			V.Local.iLineItem.Set(V.Local.sTemp.Long)
'			V.Local.sGroup.Set(V.DataTable.SOLINES(0).SO_Line!FieldVal)
'			V.Local.sGName.Set(V.DataTable.SOLINES(0).Part!FieldValTrim)
'			V.Local.sGDesc.Set(V.DataTable.SOLINES(0).Description!FieldValTrim)
'			V.Local.fPrice.Set(V.DataTable.SOLINES(0).Price!FieldValFloat)
'			V.Local.sUM.Set(V.DataTable.SOLINES(0).UM_Order!FieldVal)
'			F.Intrinsic.String.Build("{0}0",V.Local.sGroup,V.Local.sSOLine)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.If(V.DataTable.SOLINES.RowCount--,<>,-1)
			V.Local.iLineItem.Set(0)
'			V.Local.sGroup.Set(V.DataTable.SOLINES(0).SO_Line!FieldVal)
'			V.Local.sGName.Set(V.DataTable.SOLINES(0).Part!FieldValTrim)
'			V.Local.sGDesc.Set(V.DataTable.SOLINES(0).Description!FieldValTrim)
'			V.Local.fPrice.Set(V.DataTable.SOLINES(0).Price!FieldValFloat)
'			V.Local.sUM.Set(V.DataTable.SOLINES(0).UM_Order!FieldVal)
'			F.Intrinsic.String.Build("{0}0",V.Local.sGroup,V.Local.sSOLine)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf
'F.Intrinsic.Control.EndIf

'F.Intrinsic.Control.If(V.Caller.CompanyCode,=,"TST")
F.Intrinsic.String.Split(V.Screen.FormQuote!ddlGroup.Text," |~| ",V.Local.sTemp)
F.Intrinsic.String.Build("SO_Line = '{0}'",V.Local.sTemp(0).Trim,V.Local.sFilter)
F.Data.DataView.Create("SOLINES","VLine",22,V.Local.sFilter,"SO_Line")
F.Intrinsic.Control.If(V.DataView.SOLINES!VLine.RowCount--,<>,-1)
	V.Local.sGroup.Set(V.DataView.SOLINES!VLine(V.DataView.SOLINES!VLine.RowCount--).SO_Line!FieldVal)
	V.Local.sGName.Set(V.DataView.SOLINES!VLine(V.DataView.SOLINES!VLine.RowCount--).Part!FieldValTrim)
	V.Local.sGDesc.Set(V.DataView.SOLINES!VLine(V.DataView.SOLINES!VLine.RowCount--).Description!FieldValTrim)
	V.Local.fPrice.Set(V.DataView.SOLINES!VLine(V.DataView.SOLINES!VLine.RowCount--).Price!FieldValFloat)
	V.Local.sUM.Set(V.DataView.SOLINES!VLine(V.DataView.SOLINES!VLine.RowCount--).UM_Order!FieldVal)
	F.Intrinsic.String.Build("{0}0",V.Local.sTemp,V.Local.sSOLine)
F.Intrinsic.Control.Else
	V.Local.sGroup.Set(V.DataTable.SOLINES(V.DataTable.SOLINES.RowCount--).SO_Line!FieldVal)
	V.Local.sGName.Set(V.DataTable.SOLINES(V.DataTable.SOLINES.RowCount--).Part!FieldValTrim)
	V.Local.sGDesc.Set(V.DataTable.SOLINES(V.DataTable.SOLINES.RowCount--).Description!FieldValTrim)
	V.Local.fPrice.Set(V.DataTable.SOLINES(V.DataTable.SOLINES.RowCount--).Price!FieldValFloat)
	V.Local.sUM.Set(V.DataTable.SOLINES(V.DataTable.SOLINES.RowCount--).UM_Order!FieldVal)
	F.Intrinsic.String.Build("{0}0",V.Local.sTemp,V.Local.sSOLine)
F.Intrinsic.Control.EndIf
F.Data.DataView.Close("SOLINES","VLine")
'F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Top 1 Sort_1 From V_Router_Header Where ucase(Router) = '{0}'",V.Screen.FormQuote!ddlRouter.Text,V.Local.sSql)

F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sSize)

F.Intrinsic.String.Build("Select Top 1 Prod_Line From V_Router_Header Where ucase(Router) = '{0}'",V.Screen.FormQuote!ddlRouter.Text,V.Local.sSql)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPL)

'F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Router_Header Where ucase(Router) = '{0}'",V.Screen.FormQuote!ddlRouter.Text,V.Local.sSql)
'F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)

F.ODBC.Connection!Con.Close
V.Global.bOpen.Set(False)

F.Intrinsic.Control.If(V.Screen.FormQuote!txtLines.Text,>,0)
	'Getting User Fields
	F.Intrinsic.String.Build("Select * From GCG_6313_Rtr_Extra Where ucase(Router) = '{0}'",V.Screen.FormQuote!ddlRouter.Text,V.Local.sSql)
	F.ODBC.Connection!Con.OpenCompanyConnection(999)
	V.Global.bOpen.Set(True)
	F.Data.DataTable.CreateFromSQL("Ext","con",V.Local.sSql,True)
	F.ODBC.Connection!Con.Close
	V.Global.bOpen.Set(False)
	F.Intrinsic.Control.For(V.Local.i,1,V.Screen.FormQuote!txtLines.Text,1)
		F.Intrinsic.Math.Add(V.Local.iLineItem,1,V.Local.iLineItem)
		F.Intrinsic.Control.If(V.Local.sUM,=,"AS")
			F.Data.DataTable.AddRow("Quote","P_Order_Line",V.Local.sSOLine,"SF_EACH",V.Local.sSize.Float,"LINE_ITEM",V.Local.iLineItem,"Unit",1,"SIGN_ROUTER",V.Screen.FormQuote!ddlRouter.Text,"Group_No",V.Local.sGroup,"Group_Name",V.Local.sGName,"Group_Desc",V.Local.sGDesc,"PL",V.Local.sPL,"UM",V.Local.sUM.Trim,"UM_EACH",0,"SF_PRICE",V.Local.fPrice,"PROJECT",V.Screen.FormQuote!txtProj.Text,"Phase",V.Screen.FormQuote!ddlProjPhase.Value)
			F.Intrinsic.String.Build("Group_No = '{0}'",V.DataTable.Quote(V.DataTable.Quote.RowCount--).Group_No!FieldValTrim,V.Local.sFilter)
			F.Data.DataView.Create("Quote","TempUnit",22,V.Local.sFilter,"")
			F.Data.DataView.ToDataTable("QUOTE","TempUnit","Temp",True)
			F.Data.DataTable.AddExpressionColumn("Temp","SU",Float,"SF_EACH * Unit")
			F.Data.DataTable.AddExpressionColumn("Temp","SumUnit",Float,"Sum(SU)")
			V.Local.fSumUnit.Set(V.DataTable.Temp(V.DataTable.Temp.RowCount--).SumUnit!FieldValFloat)
			F.Data.DataTable.Close("Temp")
			F.Intrinsic.String.Build("SO_Line = '{0}'",V.DataTable.Quote(V.DataTable.Quote.RowCount--).Group_No!FieldValTrim,V.Local.sFilter)
			F.Data.DataView.Create("SOLINES","TempSOLINES",22,V.Local.sFilter,"")
			F.Intrinsic.Math.Mult(V.DataView.SOLINES!TempSOLINES(V.DataView.SOLINES!TempSOLINES.RowCount--).Price!FieldVal,V.DataView.SOLINES!TempSOLINES(V.DataView.SOLINES!TempSOLINES.RowCount--).Qty_Ordered!FieldVal,V.Local.fTemp)
			F.Data.DataView.Close("SOLINES","TempSOLINES")
			F.Intrinsic.Control.If(V.Local.fSumUnit,=,0)
				V.Local.fSumUnit.Set(V.Local.fTemp)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Div(V.Local.fTemp,V.Local.fSumUnit,V.Local.fSumUnit)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Math.Round(V.Local.fSumUnit,2,V.Local.fSumUnit)
			F.Data.DataView.SetValue("QUOTE","TempUnit",-1,"UM_EACH",V.Local.fSumUnit)
'			F.Intrinsic.Control.For(V.Local.iU,0,V.DataView.Quote!TempUnit.RowCount--,1)
'				F.Intrinsic.Math.Mult(V.Local.fSumUnit,V.DataView.Quote!TempUnit(V.Local.iU).Totl_SF!FieldVal,V.Local.fTemp)
'				F.Data.DataView.SetValue("QUOTE","TempUnit",V.Local.iU,"UM_EACH",V.Local.fTemp)
'			F.Intrinsic.Control.Next(V.Local.iU)
			F.Data.DataView.Close("Quote","TempUnit")
		F.Intrinsic.Control.ElseIf(V.Local.sUM,=,"SF")
			F.Data.DataTable.AddRow("Quote","P_Order_Line",V.Local.sSOLine,"SF_EACH",V.Local.sSize.Float,"LINE_ITEM",V.Local.iLineItem,"Unit",1,"SIGN_ROUTER",V.Screen.FormQuote!ddlRouter.Text,"Group_No",V.Local.sGroup,"Group_Name",V.Local.sGName,"Group_Desc",V.Local.sGDesc,"PL",V.Local.sPL,"UM",V.Local.sUM.Trim,"UM_EACH",0,"SF_PRICE",V.Local.fPrice,"PROJECT",V.Screen.FormQuote!txtProj.Text,"Phase",V.Screen.FormQuote!ddlProjPhase.Value)
'			F.Intrinsic.Math.Mult(V.DataTable.Quote(V.DataTable.Quote.RowCount--).SF_PRICE!FieldVal,V.DataTable.Quote(V.DataTable.Quote.RowCount--).TOTL_SF!FieldVal,V.Local.fTemp)
'			F.Intrinsic.Math.Div(V.Local.fTemp,V.DataTable.Quote(V.DataTable.Quote.RowCount--).Unit!FieldValfloat,V.Local.fTemp)
			F.Data.DataTable.SetValue("QUOTE",V.DataTable.Quote.RowCount--,"UM_EACH",V.Local.fPrice)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.sSize.Float,=,0)
				V.Local.fTemp.Set(V.Local.fPrice)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Div(V.Local.fPrice,V.Local.sSize.Float,V.Local.fTemp)
				F.Intrinsic.Math.Round(V.Local.fTemp,2,V.Local.fTemp)
			F.Intrinsic.Control.EndIf
			F.Data.DataTable.AddRow("Quote","P_Order_Line",V.Local.sSOLine,"SF_EACH",V.Local.sSize.Float,"LINE_ITEM",V.Local.iLineItem,"Unit",1,"SIGN_ROUTER",V.Screen.FormQuote!ddlRouter.Text,"Group_No",V.Local.sGroup,"Group_Name",V.Local.sGName,"Group_Desc",V.Local.sGDesc,"PL",V.Local.sPL,"UM",V.Local.sUM.Trim,"UM_EACH",V.Local.fTemp,"SF_PRICE",V.Local.fPrice,"PROJECT",V.Screen.FormQuote!txtProj.Text,"Phase",V.Screen.FormQuote!ddlProjPhase.Value)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataTable.Ext.RowCount--,<>,-1)
			F.Intrinsic.Control.For(V.Local.iU,1,60,1)
				F.Intrinsic.String.Build("USER{0}",V.Local.iU,V.Local.sUser)
				F.Intrinsic.Control.If(V.Local.iU,=,14,"OR",V.Local.iU,=,17)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.DataTable.Quote.RowCount--,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,19,"OR",V.Local.iU,=,21)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.DataTable.Quote.RowCount--,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,29,"OR",V.Local.iU,=,31)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.DataTable.Quote.RowCount--,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,33,"OR",V.Local.iU,=,35)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.DataTable.Quote.RowCount--,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,37,"OR",V.Local.iU,=,39)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.DataTable.Quote.RowCount--,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Data.DataTable.SetValue("QUOTE",V.DataTable.Quote.RowCount--,V.Local.sUser,V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sUser,=,"USER2")
						F.Data.DataTable.SetValue("QUOTE",V.DataTable.Quote.RowCount--,"MESSAGE",V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
	F.Data.DataTable.Close("Ext")
F.Intrinsic.Control.EndIf

Gui.FormQuote..Enabled(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdAdd_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdAdd_Click.End

Program.Sub.txtCust_KeyPressEnter.Start
F.Intrinsic.Control.SetErrorHandler("txtCust_KeyPressEnter_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sCust.Declare(String,"")

V.Local.sCust.Set(V.Screen.FormQuote!txtCust.Text)
V.Local.sCust.Set(V.Local.sCust.Trim)
F.Intrinsic.Control.If(V.Local.sCust,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Customer From V_Customer_Master Where Ucase(Customer) = '{0}'",V.Local.sCust.UCase,V.Local.sSql)

F.ODBC.Connection!con.OpenCompanyConnection
V.Global.bOpen.Set(True)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sCust)
F.Intrinsic.Control.If(V.Local.sCust,=,"")
	F.Intrinsic.UI.Msgbox("Invalid Customer Number")
	F.Intrinsic.Control.BlockEvents
	Gui.FormQuote.txtCust.Text("")
	Gui.FormQuote.txtCust.SetFocus
	F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.Close
V.Global.bOpen.Set(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtCust_KeyPressEnter_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtCust_KeyPressEnter.End

Program.Sub.txtCust_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtCust_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sCust.Declare(String,"")

V.Local.sCust.Set(V.Screen.FormQuote!txtCust.Text)
V.Local.sCust.Set(V.Local.sCust.Trim)
F.Intrinsic.Control.If(V.Local.sCust,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Customer From V_Customer_Master Where Ucase(Customer) = '{0}'",V.Local.sCust.UCase,V.Local.sSql)

F.ODBC.Connection!con.OpenCompanyConnection
V.Global.bOpen.Set(True)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sCust)
F.Intrinsic.Control.If(V.Local.sCust,=,"")
	F.Intrinsic.UI.Msgbox("Invalid Customer Number")
	F.Intrinsic.Control.BlockEvents
	Gui.FormQuote.txtCust.Text("")
	Gui.FormQuote.txtCust.SetFocus
	F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.Close
V.Global.bOpen.Set(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtCust_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtCust_LostFocus.End

Program.Sub.GsGridQuote_RowCellClick.Start
F.Intrinsic.Control.SetErrorHandler("GsGridQuote_RowCellClick_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.iRet.Declare(Long,0)
V.Local.sSql.Declare(String,"")

'removing record from grid
F.Intrinsic.Control.SelectCase(V.Args.Column.UCase)
	F.Intrinsic.Control.Case("DELETE_ROW")
		F.Intrinsic.Control.If(V.Global.bEditable)
			F.Intrinsic.UI.Msgbox("Are you sure you want to delete the row?","Attention",4,V.Local.iRet)
			F.Intrinsic.Control.If(V.Local.iRet,=,6)
				F.ODBC.Connection!Conx.OpenCompanyConnection

				F.Intrinsic.String.Build("Delete From GCG_6419_SO_Signs Where P_Order_No = '{0}' and Line_Item = '{1}'",V.DataTable.Quote(V.Args.RowIndex).P_Order_No!FieldVal,V.DataTable.Quote(V.Args.RowIndex).Line_Item!FieldVal,V.Local.sSql)
				F.ODBC.Connection!conx.Execute(V.Local.sSql)
				F.ODBC.Connection!ConX.Close

				F.Data.DataTable.DeleteRow("Quote",V.Args.RowIndex)
				F.Data.DataTable.AcceptChanges("Quote")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("GsGridQuote_RowCellClick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.GsGridQuote_RowCellClick.End

Program.Sub.GsGridQuote_CellValueChanged.Start
F.Intrinsic.Control.SetErrorHandler("GsGridQuote_RowCellClick_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSign.Declare(String,"")
V.Local.iCol.Declare(Long,0)
V.Local.sRet.Declare(String,"")
V.Local.sFilter.Declare(String,"")
V.Local.iU.Declare(Long,0)
V.Local.sUser.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sSize.Declare(String,"")
V.Local.sPL.Declare(String,"")
V.Local.fTemp.Declare(Float,0)
V.Local.fUnit.Declare(Float,0)
V.Local.sGName.Declare(String,"")
V.Local.sGDesc.Declare(String,"")
V.Local.sGPL.Declare(String,"")
V.Local.sSOLine.Declare(String,"")
V.Local.sUM.Declare(String,"")
V.Local.fPrice.Declare(Float,0)
V.Local.fSumUnit.Declare(Float,0)
V.Local.sPrevGroup.Declare(String,"")

'auto filling changes to other lines with the group
F.Intrinsic.Control.SelectCase(V.Args.Column.UCase)
	F.Intrinsic.Control.Case("SIGN_ROUTER")
		F.Intrinsic.Control.BlockEvents
		F.Intrinsic.String.Build("Select Top 1 Sort_1 From V_Router_Header Where ucase(Router) = '{0}'",V.Args.Value,V.Local.sSql)
		F.ODBC.Connection!Con.OpenCompanyConnection
		V.Global.bOpen.Set(True)
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sSize)
		F.Intrinsic.String.Build("Select Top 1 Prod_Line From V_Router_Header Where ucase(Router) = '{0}'",V.Args.Value,V.Local.sSql)
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPL)
		F.Intrinsic.String.Build("Select * From GCG_6313_Rtr_Extra Where ucase(Router) = '{0}'",V.Args.Value,V.Local.sSql)
		F.Data.DataTable.CreateFromSQL("Ext","con",V.Local.sSql,True)
		F.ODBC.Connection!Con.Close
		V.Global.bOpen.Set(False)
		F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"SF_EACH",V.Local.sSize.Float,"PL",V.Local.sPL)
		F.Intrinsic.Control.If(V.DataTable.Ext.RowCount--,<>,-1)
			F.Intrinsic.Control.For(V.Local.iU,1,60,1)
				F.Intrinsic.String.Build("USER{0}",V.Local.iU,V.Local.sUser)
				F.Intrinsic.Control.If(V.Local.iU,=,14,"OR",V.Local.iU,=,17)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,19,"OR",V.Local.iU,=,21)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,29,"OR",V.Local.iU,=,31)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,33,"OR",V.Local.iU,=,35)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,37,"OR",V.Local.iU,=,39)
					V.Local.sTemp.Set(V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sTemp.IsNumeric)
						F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Local.sTemp)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,V.Local.sUser,V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sUser,=,"USER2")
						F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"MESSAGE",V.DataTable.Ext(V.DataTable.Ext.RowCount--).[V.Local.sUser]!FieldValTrim)
					F.Intrinsic.Control.EndIf
				f.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.For(V.Local.iU,1,60,1)
				F.Intrinsic.String.Build("USER{0}",V.Local.iU,V.Local.sUser)
				F.Intrinsic.Control.If(V.Local.iU,=,14,"OR",V.Local.iU,=,17)
					F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Ambient.DBNull)
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,19,"OR",V.Local.iU,=,21)
					F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Ambient.DBNull)
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,29,"OR",V.Local.iU,=,31)
					F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Ambient.DBNull)
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,33,"OR",V.Local.iU,=,35)
					F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Ambient.DBNull)
				F.Intrinsic.Control.ElseIf(V.Local.iU,=,37,"OR",V.Local.iU,=,39)
					F.Data.DataTable.SetValue("QUOTE",V.Args.RowIndex,V.Local.sUser,V.Ambient.DBNull)
				F.Intrinsic.Control.Else
					F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,V.Local.sUser,"")
					F.Intrinsic.Control.If(V.Local.sUser,=,"USER2")
						F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"MESSAGE","")
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.Close("Ext")
		
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","UM",V.Args.RowIndex,V.Local.sUM)
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","Group_No",V.Args.RowIndex,V.Local.sRet)
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","SF_PRICE",V.Args.RowIndex,V.Local.fPrice)
		
		F.Intrinsic.String.Build("Group_No like '{0}*'",V.Local.sRet,V.Local.sFilter)
		F.Data.DataView.Create("Quote","VTEMP",22,V.Local.sFilter,"")
			
		F.Intrinsic.Control.If(V.Local.sUM,=,"SF")
			F.Intrinsic.Control.For(V.Local.iU,0,V.DataView.Quote!VTEMP.RowCount--,1)
'				F.Intrinsic.Math.Mult(V.DataView.Quote!VTEMP(V.Local.iU).SF_PRICE!FieldVal,V.DataView.Quote!VTEMP(V.Local.iU).TOTL_SF!FieldVal,V.Local.fTemp)
'				F.Intrinsic.Math.Div(V.Local.fTemp,V.DataView.Quote!VTEMP(V.Local.iU).Unit!FieldValfloat,V.Local.fTemp)
				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.DataView.Quote!VTEMP(V.Local.iU).SF_PRICE!FieldVal)
			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.ElseIf(V.Local.sUM,=,"AS")
			F.Data.DataView.ToDataTable("QUOTE","VTEMP","Temp",True)
			F.Data.DataTable.AddExpressionColumn("Temp","SU",Float,"SF_EACH * Unit")
			F.Data.DataTable.AddExpressionColumn("Temp","SumUnit",Float,"Sum(SU)")
			V.Local.fSumUnit.Set(V.DataTable.Temp(V.DataTable.Temp.RowCount--).SumUnit!FieldValFloat)
			F.Data.DataTable.Close("Temp")
			F.Intrinsic.String.Build("SO_Line = '{0}'",V.Local.sRet,V.Local.sFilter)
			F.Data.DataView.Create("SOLINES","TempSOLINES",22,V.Local.sFilter,"")
			F.Intrinsic.Math.Mult(V.DataView.SOLINES!TempSOLINES(V.DataView.SOLINES!TempSOLINES.RowCount--).Price!FieldVal,V.DataView.SOLINES!TempSOLINES(V.DataView.SOLINES!TempSOLINES.RowCount--).Qty_Ordered!FieldVal,V.Local.fTemp)
			F.Data.DataView.Close("SOLINES","TempSOLINES")
			F.Intrinsic.Math.Div(V.Local.fTemp,V.Local.fSumUnit,V.Local.fSumUnit)
			F.Intrinsic.Math.Round(V.Local.fSumUnit,2,V.Local.fSumUnit)
			F.Data.DataView.SetValue("QUOTE","VTEMP",-1,"UM_EACH",V.Local.fSumUnit)
'			F.Intrinsic.Control.For(V.Local.iU,0,V.DataView.Quote!VTEMP.RowCount--,1)
'				F.Intrinsic.Math.Mult(V.DataView.Quote!VTEMP(V.Local.iU).SF_EACH!FieldVal,V.DataView.Quote!VTEMP(V.Local.iU).Unit!FieldVal,V.Local.fTemp)
'				F.Intrinsic.Math.Mult(V.Local.fSumUnit,V.Local.fTemp,V.Local.fTemp)
'				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.Local.fTemp)
'			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.For(V.Local.iU,0,V.DataView.Quote!VTEMP.RowCount--,1)
				F.Intrinsic.Math.Div(V.DataView.Quote!VTEMP(V.Local.iU).SF_PRICE!FieldVal,V.DataView.Quote!VTEMP(V.Local.iU).SF_EACH!FieldVal,V.Local.fTemp)
				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.Local.fTemp)
			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.EndIf
		
		F.Data.DataView.Close("Quote","VTEMP")
		
		F.Intrinsic.Control.UnBlockEvents
		
	F.Intrinsic.Control.Case("GROUP_NO")

		F.Intrinsic.Control.If(V.DataTable.Quote(V.Args.RowIndex).UM!FieldValTrim,=,"AS")
			F.Intrinsic.String.Right(V.DataTable.Quote(V.Args.RowIndex).P_Order_Line!FieldValTrim,3,V.Local.sPrevGroup)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.BlockEvents
		F.Intrinsic.String.Build("SO_Line = '{0}'",V.Args.Value,V.Local.sFilter)
		F.Intrinsic.String.Build("{0}0",V.Args.Value,V.Local.sSOLine)
		F.Data.DataView.Create("SOLINES","VSOLINE",22,V.Local.sFilter,"")
		F.Intrinsic.Control.If(V.DataView.SOLINES!VSOLINE.RowCount--,<>,-1)
			V.Local.sGDesc.Set(V.DataView.SOLINES!VSOLINE(V.DataView.SOLINES!VSOLINE.RowCount--).Description!FieldValTrim)
			V.Local.sGName.Set(V.DataView.SOLINES!VSOLINE(V.DataView.SOLINES!VSOLINE.RowCount--).Part!FieldValTrim)
			V.Local.sUM.Set(V.DataView.SOLINES!VSOLINE(V.DataView.SOLINES!VSOLINE.RowCount--).Um_Order!FieldValTrim)
			V.Local.fTemp.Set(V.DataView.SOLINES!VSOLINE(V.DataView.SOLINES!VSOLINE.RowCount--).Price!FieldValFloat)
		F.Intrinsic.Control.EndIf
		F.Data.DataView.Close("SOLINES","VSOLINE")
		F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"Group_Desc",V.Local.sGDesc.Trim,"Group_Name",V.Local.sGName.Trim,"P_Order_Line",V.Local.sSOLine,"UM",V.Local.sUM,"SF_PRICE",V.Local.fTemp)
		
		F.Data.DataTable.AcceptChanges("Quote")
		
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","UM",V.Args.RowIndex,V.Local.sUM)
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","Group_No",V.Args.RowIndex,V.Local.sRet)
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","SF_PRICE",V.Args.RowIndex,V.Local.fPrice)
		
		F.Intrinsic.String.Build("Group_No like '{0}*'",V.Local.sRet,V.Local.sFilter)
		F.Data.DataView.Create("Quote","VTEMP",22,V.Local.sFilter,"")

		F.Intrinsic.Control.If(V.Local.sUM,=,"SF")
			F.Intrinsic.Control.For(V.Local.iU,0,V.DataView.Quote!VTEMP.RowCount--,1)
'				F.Intrinsic.Math.Mult(V.DataView.Quote!VTEMP(V.Local.iU).SF_PRICE!FieldVal,V.DataView.Quote!VTEMP(V.Local.iU).TOTL_SF!FieldVal,V.Local.fTemp)
'				F.Intrinsic.Math.Div(V.Local.fTemp,V.DataView.Quote!VTEMP(V.Local.iU).Unit!FieldValfloat,V.Local.fTemp)
'				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.Local.fTemp)
				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.DataView.Quote!VTEMP(V.Local.iU).SF_PRICE!FieldVal)
			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.ElseIf(V.Local.sUM,=,"AS")
			F.Data.DataView.ToDataTable("QUOTE","VTEMP","Temp",True)
			F.Data.DataTable.AddExpressionColumn("Temp","SU",Float,"SF_EACH * Unit")
			F.Data.DataTable.AddExpressionColumn("Temp","SumUnit",Float,"Sum(SU)")
			V.Local.fSumUnit.Set(V.DataTable.Temp(V.DataTable.Temp.RowCount--).SumUnit!FieldValFloat)
			F.Data.DataTable.Close("Temp")
			F.Intrinsic.String.Build("SO_Line = '{0}'",V.Local.sRet,V.Local.sFilter)
			F.Data.DataView.Create("SOLINES","TempSOLINES",22,V.Local.sFilter,"")
			F.Intrinsic.Math.Mult(V.DataView.SOLINES!TempSOLINES(V.DataView.SOLINES!TempSOLINES.RowCount--).Price!FieldVal,V.DataView.SOLINES!TempSOLINES(V.DataView.SOLINES!TempSOLINES.RowCount--).Qty_Ordered!FieldVal,V.Local.fTemp)
			F.Data.DataView.Close("SOLINES","TempSOLINES")
			F.Intrinsic.Math.Div(V.Local.fTemp,V.Local.fSumUnit,V.Local.fSumUnit)
			F.Intrinsic.Math.Round(V.Local.fSumUnit,2,V.Local.fSumUnit)
			F.Data.DataView.SetValue("QUOTE","VTEMP",-1,"UM_EACH",V.Local.fSumUnit)
'			F.Intrinsic.Control.For(V.Local.iU,0,V.DataView.Quote!VTEMP.RowCount--,1)
'				F.Intrinsic.Math.Mult(V.DataView.Quote!VTEMP(V.Local.iU).SF_EACH!FieldVal,V.DataView.Quote!VTEMP(V.Local.iU).Unit!FieldVal,V.Local.fTemp)
'				F.Intrinsic.Math.Mult(V.Local.fSumUnit,V.Local.fTemp,V.Local.fTemp)
'				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.Local.fTemp)
'			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.For(V.Local.iU,0,V.DataView.Quote!VTEMP.RowCount--,1)
				F.Intrinsic.Math.Div(V.DataView.Quote!VTEMP(V.Local.iU).SF_PRICE!FieldVal,V.DataView.Quote!VTEMP(V.Local.iU).SF_EACH!FieldVal,V.Local.fTemp)
				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.Local.fTemp)
'				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.DataView.Quote!VTEMP(V.Local.iU).SF_Price!FieldValTrim)
			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.EndIf
		
		F.Data.DataView.Close("Quote","VTEMP")
		
		F.Intrinsic.Control.If(V.Local.sPrevGroup,<>,"")
			F.Intrinsic.String.Build("Group_No like '{0}*'",V.Local.sPrevGroup,V.Local.sFilter)
			F.Intrinsic.String.Build("0{0}",V.Local.sPrevGroup,V.Local.sRet)
			F.Data.DataView.Create("Quote","VTEMP",22,V.Local.sFilter,"")
			F.Intrinsic.Control.If(V.DataView.Quote!VTEMP.RowCount--,<>,-1)
				F.Data.DataView.ToDataTable("QUOTE","VTEMP","Temp",True)
				F.Data.DataTable.AddExpressionColumn("Temp","SU",Float,"SF_EACH * Unit")
				F.Data.DataTable.AddExpressionColumn("Temp","SumUnit",Float,"Sum(SU)")
				V.Local.fSumUnit.Set(V.DataTable.Temp(V.DataTable.Temp.RowCount--).SumUnit!FieldValFloat)
				F.Data.DataTable.Close("Temp")
				F.Intrinsic.String.Build("SO_Line = '{0}'",V.Local.sRet,V.Local.sFilter)
				F.Data.DataView.Create("SOLINES","TempSOLINES",22,V.Local.sFilter,"")
				F.Intrinsic.Math.Mult(V.DataView.SOLINES!TempSOLINES(V.DataView.SOLINES!TempSOLINES.RowCount--).Price!FieldVal,V.DataView.SOLINES!TempSOLINES(V.DataView.SOLINES!TempSOLINES.RowCount--).Qty_Ordered!FieldVal,V.Local.fTemp)
				F.Data.DataView.Close("SOLINES","TempSOLINES")
				F.Intrinsic.Math.Div(V.Local.fTemp,V.Local.fSumUnit,V.Local.fSumUnit)
				F.Intrinsic.Math.Round(V.Local.fSumUnit,2,V.Local.fSumUnit)
				F.Data.DataView.SetValue("QUOTE","VTEMP",-1,"UM_EACH",V.Local.fSumUnit)
			F.Intrinsic.Control.EndIf
			F.Data.DataView.Close("Quote","VTEMP")
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.UnBlockEvents
'	F.Intrinsic.Control.Case("SF_PRICE")
'		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","Group_No",V.Args.RowIndex,V.Local.sRet)
'		F.Intrinsic.String.Build("Group_No = '{0}'",V.Local.sRet,V.Local.sFilter)
'		F.Data.DataView.Create("Quote","VTEMP",22,V.Local.sFilter,"")
'		F.Data.DataView.SetValue("Quote","VTEMP",-1,"SF_PRICE",V.Args.Value)
'		F.Intrinsic.Control.If(V.DataView.Quote!VTEMP(V.DataView.Quote!VTEMP.RowCount--).UM!FieldValTrim,=,"SF")
'			F.Data.DataView.SetValue("Quote","VTEMP",-1,"UM_EACH",V.DataView.Quote!VTEMP(V.Local.iCol).SF_Each!FieldVal)
'		F.Intrinsic.Control.EndIf
'		F.Data.DataView.Close("Quote","VTEMP")
	
	F.Intrinsic.Control.Case("UM")
		F.Intrinsic.Control.BlockEvents
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","Group_No",V.Args.RowIndex,V.Local.sRet)
		F.Intrinsic.String.Build("Group_No like '{0}*'",V.Local.sRet,V.Local.sFilter)
		F.Data.DataView.Create("Quote","VTEMP",22,V.Local.sFilter,"")
		F.Data.DataView.SetValue("Quote","VTEMP",-1,"UM",V.Args.Value)
'		F.Intrinsic.Control.If(V.Args.Value,=,"AS")
'			F.Data.DataView.SetValue("Quote","VTEMP",-1,"UM_EACH","0")
'			F.Intrinsic.UI.Msgbox("UM EACH will need to be Manually updated","Attention")
'		F.Intrinsic.Control.ElseIf(V.Args.Value,=,"SF")
'			F.Intrinsic.Control.For(V.Local.iCol,0,V.DataView.Quote!VTEMP.RowCount--,1)
'				F.Data.DataView.SetValue("Quote","VTEMP",V.Local.iCol,"UM_EACH",V.DataView.Quote!VTEMP(V.Local.iCol).SF_Each!FieldVal)
'			F.Intrinsic.Control.Next(V.Local.iCol)
'		F.Intrinsic.Control.Else
'			F.Intrinsic.Control.For(V.Local.iCol,0,V.DataView.Quote!VTEMP.RowCount--,1)
'				F.Data.DataView.SetValue("Quote","VTEMP",V.Local.iCol,"UM_EACH",V.DataView.Quote!VTEMP(V.Local.iCol).Unit!FieldVal)
'			F.Intrinsic.Control.Next(V.Local.iCol)
'		F.Intrinsic.Control.EndIf
'		F.Data.DataView.Close("Quote","VTEMP")
		
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","UM",V.Args.RowIndex,V.Local.sUM)
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","Group_No",V.Args.RowIndex,V.Local.sRet)
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","SF_PRICE",V.Args.RowIndex,V.Local.fPrice)
			
		F.Intrinsic.Control.If(V.Local.sUM,=,"SF")
			F.Intrinsic.Control.For(V.Local.iU,0,V.DataView.Quote!VTEMP.RowCount--,1)
'				F.Intrinsic.Math.Mult(V.DataView.Quote!VTEMP(V.Local.iU).SF_PRICE!FieldVal,V.DataView.Quote!VTEMP(V.Local.iU).TOTL_SF!FieldVal,V.Local.fTemp)
'				F.Intrinsic.Math.Div(V.Local.fTemp,V.DataView.Quote!VTEMP(V.Local.iU).Unit!FieldValfloat,V.Local.fTemp)
'				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.Local.fTemp)
				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.DataView.Quote!VTEMP(V.Local.iU).SF_PRICE!FieldVal)
			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.ElseIf(V.Local.sUM,=,"AS")
			F.Data.DataView.ToDataTable("QUOTE","VTEMP","Temp",True)
			F.Data.DataTable.AddExpressionColumn("Temp","SU",Float,"SF_EACH * Unit")
			F.Data.DataTable.AddExpressionColumn("Temp","SumUnit",Float,"Sum(SU)")
			V.Local.fSumUnit.Set(V.DataTable.Temp(V.DataTable.Temp.RowCount--).SumUnit!FieldValFloat)
			F.Data.DataTable.Close("Temp")
			F.Intrinsic.String.Build("SO_Line = '{0}'",V.Local.sRet,V.Local.sFilter)
			F.Data.DataView.Create("SOLINES","TempSOLINES",22,V.Local.sFilter,"")
			F.Intrinsic.Math.Mult(V.DataView.SOLINES!TempSOLINES(V.DataView.SOLINES!TempSOLINES.RowCount--).Price!FieldVal,V.DataView.SOLINES!TempSOLINES(V.DataView.SOLINES!TempSOLINES.RowCount--).Qty_Ordered!FieldVal,V.Local.fTemp)
			F.Data.DataView.Close("SOLINES","TempSOLINES")
			F.Intrinsic.Math.Div(V.Local.fTemp,V.Local.fSumUnit,V.Local.fSumUnit)
			F.Intrinsic.Math.Round(V.Local.fSumUnit,2,V.Local.fSumUnit)
			F.Data.DataView.SetValue("QUOTE","VTEMP",-1,"UM_EACH",V.Local.fSumUnit)
'			F.Intrinsic.Control.For(V.Local.iU,0,V.DataView.Quote!VTEMP.RowCount--,1)
'				F.Intrinsic.Math.Mult(V.DataView.Quote!VTEMP(V.Local.iU).SF_EACH!FieldVal,V.DataView.Quote!VTEMP(V.Local.iU).Unit!FieldVal,V.Local.fTemp)
'				F.Intrinsic.Math.Mult(V.Local.fSumUnit,V.Local.fTemp,V.Local.fTemp)
'				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.Local.fTemp)
'			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.For(V.Local.iU,0,V.DataView.Quote!VTEMP.RowCount--,1)
				F.Intrinsic.Math.Div(V.DataView.Quote!VTEMP(V.Local.iU).SF_PRICE!FieldVal,V.DataView.Quote!VTEMP(V.Local.iU).SF_EACH!FieldVal,V.Local.fTemp)
				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.Local.fTemp)
'				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.DataView.Quote!VTEMP(V.Local.iU).SF_Price!FieldValTrim)
			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.EndIf
		
		F.Data.DataView.Close("Quote","VTEMP")
		F.Intrinsic.Control.UnBlockEvents
		
	F.Intrinsic.Control.Case("PL")
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","Group_No",V.Args.RowIndex,V.Local.sRet)
		F.Intrinsic.String.Build("Group_No like '{0}*'",V.Local.sRet,V.Local.sFilter)
		F.Data.DataView.Create("Quote","VTEMP",22,V.Local.sFilter,"")
		F.Data.DataView.SetValue("Quote","VTEMP",-1,"PL",V.Args.Value)
		F.Data.DataView.Close("Quote","VTEMP")
	
	F.Intrinsic.Control.Case("PHASE")
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","Group_No",V.Args.RowIndex,V.Local.sRet)
		F.Intrinsic.String.Build("Group_No like '{0}*'",V.Local.sRet,V.Local.sFilter)
		F.Data.DataView.Create("Quote","VTEMP",22,V.Local.sFilter,"")
		F.Data.DataView.SetValue("Quote","VTEMP",-1,"PHASE",V.Args.Value)
		F.Data.DataView.Close("Quote","VTEMP")
		
	F.Intrinsic.Control.Case("UNIT")
		F.Intrinsic.Control.BlockEvents
		F.Intrinsic.Control.If(V.DataTable.Quote(V.Args.RowIndex).UM!FieldValTrim,=,"EA")
'			F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"UM_EACH",V.Args.Value,"Unit",V.Args.Value)
			F.Intrinsic.Math.Div(V.DataTable.Quote(V.Args.RowIndex).SF_PRICE!FieldVal,V.DataTable.Quote(V.Args.RowIndex).SF_EACH!FieldVal,V.Local.fTemp)
			F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"UM_EACH",V.Local.fTemp)
		F.Intrinsic.Control.ElseIf(V.DataTable.Quote(V.Args.RowIndex).UM!FieldValTrim,=,"SF")
'			F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"UM_EACH",V.DataTable.Quote(V.Args.RowIndex).SF_Each!FieldVal,"Unit",V.Args.Value)
			F.Data.DataTable.SetValue("Quote",V.Args.RowIndex,"UM_EACH",V.DataTable.Quote(V.Args.RowIndex).SF_PRICE!FieldVal)
		F.Intrinsic.Control.EndIf
		
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","UM",V.Args.RowIndex,V.Local.sUM)
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","Group_No",V.Args.RowIndex,V.Local.sRet)
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","SF_PRICE",V.Args.RowIndex,V.Local.fPrice)
		
		F.Intrinsic.String.Build("Group_No like '{0}*'",V.Local.sRet,V.Local.sFilter)
		F.Data.DataView.Create("Quote","VTEMP",22,V.Local.sFilter,"")
		F.Intrinsic.Control.If(V.Local.sUM,=,"SF")
			F.Intrinsic.Control.For(V.Local.iU,0,V.DataView.Quote!VTEMP.RowCount--,1)
'				F.Intrinsic.Math.Mult(V.DataView.Quote!VTEMP(V.Local.iU).SF_PRICE!FieldVal,V.DataView.Quote!VTEMP(V.Local.iU).TOTL_SF!FieldVal,V.Local.fTemp)
'				F.Intrinsic.Math.Div(V.Local.fTemp,V.DataView.Quote!VTEMP(V.Local.iU).Unit!FieldValfloat,V.Local.fTemp)
'				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.Local.fTemp)
				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.DataView.Quote!VTEMP(V.Local.iU).SF_PRICE!FieldVal)
			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.ElseIf(V.Local.sUM,=,"AS")	
			F.Data.DataView.ToDataTable("QUOTE","VTEMP","Temp",True)
			F.Data.DataTable.AddExpressionColumn("Temp","SU",Float,"SF_EACH * Unit")
			F.Data.DataTable.AddExpressionColumn("Temp","SumUnit",Float,"Sum(SU)")
			V.Local.fSumUnit.Set(V.DataTable.Temp(V.DataTable.Temp.RowCount--).SumUnit!FieldValFloat)
			F.Data.DataTable.Close("Temp")
			F.Intrinsic.String.Build("SO_Line = '{0}'",V.Local.sRet,V.Local.sFilter)
			F.Data.DataView.Create("SOLINES","TempSOLINES",22,V.Local.sFilter,"")
			F.Intrinsic.Math.Mult(V.DataView.SOLINES!TempSOLINES(V.DataView.SOLINES!TempSOLINES.RowCount--).Price!FieldVal,V.DataView.SOLINES!TempSOLINES(V.DataView.SOLINES!TempSOLINES.RowCount--).Qty_Ordered!FieldVal,V.Local.fTemp)
			F.Data.DataView.Close("SOLINES","TempSOLINES")
			F.Intrinsic.Math.Div(V.Local.fTemp,V.Local.fSumUnit,V.Local.fSumUnit)
			F.Intrinsic.Math.Round(V.Local.fSumUnit,2,V.Local.fSumUnit)
			F.Data.DataView.SetValue("QUOTE","VTEMP",-1,"UM_EACH",V.Local.fSumUnit)
'			F.Intrinsic.Control.For(V.Local.iU,0,V.DataView.Quote!VTEMP.RowCount--,1)
'				F.Intrinsic.Math.Mult(V.DataView.Quote!VTEMP(V.Local.iU).SF_EACH!FieldVal,V.DataView.Quote!VTEMP(V.Local.iU).Unit!FieldVal,V.Local.fTemp)
'				F.Intrinsic.Math.Mult(V.Local.fSumUnit,V.Local.fTemp,V.Local.fTemp)
'				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.Local.fTemp)
'			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.For(V.Local.iU,0,V.DataView.Quote!VTEMP.RowCount--,1)
				F.Intrinsic.Math.Div(V.DataView.Quote!VTEMP(V.Local.iU).SF_PRICE!FieldVal,V.DataView.Quote!VTEMP(V.Local.iU).SF_EACH!FieldVal,V.Local.fTemp)
				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.Local.fTemp)
'				F.Data.DataView.SetValue("QUOTE","VTEMP",V.Local.iU,"UM_EACH",V.DataView.Quote!VTEMP(V.Local.iU).SF_Price!FieldValTrim)
			F.Intrinsic.Control.Next(V.Local.iU)
		F.Intrinsic.Control.EndIf
		
		F.Data.DataView.Close("Quote","VTEMP")
		F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("GsGridQuote_RowCellClick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.GsGridQuote_CellValueChanged.End

Program.Sub.cmdSave_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdSave_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sFieldMap.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sUser.Declare(String,"")

F.Intrinsic.UI.InvokeWaitDialog("Saving SO Data.................")
Gui.FormQuote..Enabled(False)

V.Local.sFieldMap.Set("P_Order_No@!@P_Order_No*!*P_Order_Line@!@P_Order_Line*!*Customer@!@Customer*!*Line_Item@!@Line_Item*!*Unit@!@Unit*!*Sign_Router@!@Sign_Router*!*Message@!@Message*!*SF_Each@!@SF_Each*!*SF_Price@!@SF_Price*!*Group_No@!@Group_No*!*Group_Name@!@Group_Name*!*Group_Desc@!@Group_Desc*!*Order_No@!@Order_No*!*Order_Line@!@Order_Line*!*Job@!@Job*!*Suffix@!@Suffix*!*USERH1@!@USERH1*!*USERH3@!@USERH3*!*USERH4@!@USERH4*!*USERH5@!@USERH5*!*PL@!@PL*!*UM@!@UM*!*UM_EACH@!@UM_EACH")
F.Intrinsic.Control.For(V.Local.i,1,60,1)
	F.Intrinsic.String.Build("USER{0}",V.Local.i,V.Local.sUser)
	F.Intrinsic.String.Build("{0}*!*{1}@!@{1}",v.Local.sFieldMap,v.Local.sUser,V.Local.sFieldMap)
F.Intrinsic.Control.Next(V.Local.i)

'F.Intrinsic.String.Build("Delete From GCG_6419_SO_Signs Where P_Order_No = '{0}'",V.Screen.FormQuote!txtSaleOrder.Text,V.Local.sSql)
F.ODBC.Connection!con.OpenCompanyConnection
V.Global.bOpen.Set(True)
'F.ODBC.Connection!Con.Execute(V.Local.sSql)
F.Intrinsic.Control.If(V.DataTable.Quote.RowCount--,<>,-1)
	F.Data.DataTable.SetValue("Quote",-1,"P_Order_No",V.Screen.FormQuote!txtSaleOrder.Text,"Customer",V.Screen.FormQuote!txtCust.Text,"USERH1",V.Screen.FormQuote!txtUser1.Text,"USERH3",V.Screen.FormQuote!txtUser3.Text,"USERH4",V.Screen.FormQuote!txtUser4.Text,"USERH5",V.Screen.FormQuote!txtUser5.Text,"PROJECT",V.Screen.FormQuote!txtProj.Text)
	F.Data.DataTable.SaveToDB("Quote","con","GCG_6419_SO_Signs","P_Order_No*!*Line_Item",256,V.Local.sFieldMap)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.Close
V.Global.bOpen.Set(False)

F.Intrinsic.Control.If(V.DataTable.Quote(V.DataTable.Quote.RowCount--).Order_No!FieldValTrim,<>,"")
	Gui.FormQuote.ddlRouter.Enabled(False)
	Gui.FormQuote.ddlState.Enabled(False)
	Gui.FormQuote.txtCust.Enabled(False)
	Gui.FormQuote.txtLines.Enabled(False)
'	Gui.FormQuote.dtpDueDate.Enabled(False)
	Gui.FormQuote.cmdAdd.Enabled(False)
'	Gui.FormQuote.cmdCust.Enabled(False)
	Gui.FormQuote.cmdCreate.Enabled(False)
	Gui.FormQuote.cmdSave.Enabled(False)
	Gui.FormQuote.cmdOldMat.Enabled(False)
	Gui.FormQuote.cmdNewMat.Enabled(False)
	Gui.FormQuote.cmdUpMat.Enabled(False)
	V.Global.bEditable.Set(False)
F.Intrinsic.Control.EndIf

Gui.FormQuote..Enabled(True)
F.Intrinsic.UI.CloseWaitDialog

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdSave_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(False)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdSave_Click.End

Program.Sub.cmdLRout_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdLRout_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sMode.Declare(String,"")
V.Local.sRouter.Declare(STring,"")

V.Local.sRouter.Set(V.Screen.FormQuote!ddlRouter.Text)

Gui.FormQuote..Enabled(False)
F.Intrinsic.Control.If(V.Screen.FormQuote!optC.Value,=,True)
	V.Local.sMode.Set("C")
F.Intrinsic.Control.ElseIf(V.Screen.FormQuote!optE.Value,=,True)
	V.Local.sMode.Set("O")
F.Intrinsic.Control.ElseIf(V.Screen.FormQuote!optV.Value,=,True)
	V.Local.sMode.Set("V")
F.Intrinsic.Control.Else
	Gui.FormQuote..Enabled(True)
	Gui.FormQuote..AlwaysOnTop(True)
	Gui.FormQuote..AlwaysOnTop(False)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Data.DataTable.AddRow("400000","Mode",V.Local.sMode,"Router",V.Local.sRouter.Trim)

F.Intrinsic.Control.CallSub(400000Sync)

F.Intrinsic.Control.CallSub(ddlState_Change)

Gui.FormQuote.ddlRouter.Text(V.Local.sRouter.Trim)
Gui.FormQuote..Enabled(True)

Gui.FormQuote..AlwaysOnTop(True)
Gui.FormQuote..AlwaysOnTop(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdLRout_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdLRout_Click.End

Program.Sub.txtUser3_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtUser3_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtUser3.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtUser3_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtUser3_GotFocus.End

Program.Sub.txtUser4_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtUser4_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtUser4.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtUser4_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtUser4_GotFocus.End

Program.Sub.txtUser5_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtUser5_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtUser5.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtUser5_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtUser5_GotFocus.End

Program.Sub.cmdUser3_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdUser3_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")
V.Local.sRet.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.Intrinsic.String.Build("Select KEY_VALUE From OE_USER_VALUES Where (CUST = '{0}' OR CUST <= '') and HDR_FLAG = 'H' AND USER_NO = '3'",V.Screen.FormQuote!txtCust.Text,V.Local.sSql) 
V.Local.sTitles.Set("User Value")
V.Local.sWidths.Set("6250")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.ODBC.Connection!Con.OpenCompanyConnection
V.Global.bOpen.Set(True)
F.Intrinsic.UI.Browser("Select Quote","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,9000,V.Local.sRet)

F.ODBC.Connection!Con.Close
V.Global.bOpen.Set(False)	

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	Gui.FormQuote.txtUser3.Text(V.Local.sRet.Trim)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdUser3_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdUser3_Click.End

Program.Sub.cmdUser4_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdUser4_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")
V.Local.sRet.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.Intrinsic.String.Build("Select KEY_VALUE From OE_USER_VALUES Where (CUST = '{0}' OR CUST <= '') and HDR_FLAG = 'H' AND USER_NO = '4'",V.Screen.FormQuote!txtCust.Text,V.Local.sSql) 
V.Local.sTitles.Set("User Value")
V.Local.sWidths.Set("6250")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.ODBC.Connection!Con.OpenCompanyConnection
V.Global.bOpen.Set(True)
F.Intrinsic.UI.Browser("Select Quote","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,9000,V.Local.sRet)

F.ODBC.Connection!Con.Close
V.Global.bOpen.Set(False)
	
F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	Gui.FormQuote.txtUser4.Text(V.Local.sRet.Trim)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdUser4_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdUser4_Click.End

Program.Sub.cmdUser5_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdUser5_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")
V.Local.sRet.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.Intrinsic.String.Build("Select KEY_VALUE From OE_USER_VALUES Where (CUST = '{0}' OR CUST <= '') and HDR_FLAG = 'H' AND USER_NO = '5'",V.Screen.FormQuote!txtCust.Text,V.Local.sSql) 
V.Local.sTitles.Set("User Value")
V.Local.sWidths.Set("6250")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.ODBC.Connection!Con.OpenCompanyConnection
V.Global.bOpen.Set(True)
F.Intrinsic.UI.Browser("Select Quote","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,9000,V.Local.sRet)

F.ODBC.Connection!Con.Close
V.Global.bOpen.Set(False)
	
F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	Gui.FormQuote.txtUser5.Text(V.Local.sRet.Trim)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdUser5_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdUser5_Click.End

Program.Sub.txtUser1_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtUser1_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtUser1.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtUser1_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtUser1_GotFocus.End

Program.Sub.cmdUser1_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdUser1_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")
V.Local.sRet.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.Intrinsic.String.Build("Select KEY_VALUE From OE_USER_VALUES Where (CUST = '{0}' OR CUST <= '') and HDR_FLAG = 'H' AND USER_NO = '1'",V.Screen.FormQuote!txtCust.Text,V.Local.sSql) 
V.Local.sTitles.Set("User Value")
V.Local.sWidths.Set("6250")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.ODBC.Connection!Con.OpenCompanyConnection
V.Global.bOpen.Set(True)
F.Intrinsic.UI.Browser("Select Quote","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,9000,V.Local.sRet)

F.ODBC.Connection!Con.Close
V.Global.bOpen.Set(False)
F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	Gui.FormQuote.txtUser1.Text(V.Local.sRet.Trim)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdUser1_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdUser1_Click.End

Program.Sub.Create_ContextMenu.Start
F.Intrinsic.Control.SetErrorHandler("Create_ContextMenu_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote..ContextMenuCreate("CGQ")
Gui.FormQuote.GsGridQuote.ContextMenuAttach("CGQ")
Gui.FormQuote..ContextMenuAddItem("CGQ","COMMIT ROUTER",0,"Commit UFs to Other Routers")
Gui.FormQuote..ContextMenuAddItem("CGQ","PASTE MESSAGE",0,"Paste Message(s) From Excel")
Gui.FormQuote..ContextMenuAddItem("CGQ","UPDATE GUIDE",0,"Update Guide Sheet & Panel")
Gui.FormQuote..ContextMenuAddItem("CGQ","COPY LINE INFO",0,"Copy Line Info")
Gui.FormQuote..ContextMenuAddItem("CGQ","PASTE LINE INFO",0,"Paste Line Info")
'F.Intrinsic.Control.If(V.Caller.CompanyCode,=,"TST")
	Gui.FormQuote..ContextMenuAddItem("CGQ","UPDATE FLAT",0,"Update Flat Sign")
'F.Intrinsic.Control.EndIf
Gui.FormQuote..ContextMenuSetItemEventHandler("CGQ","COMMIT ROUTER","Menu_Click")
Gui.FormQuote..ContextMenuSetItemEventHandler("CGQ","PASTE MESSAGE","Menu_Click_Paste")
Gui.FormQuote..ContextMenuSetItemEventHandler("CGQ","UPDATE GUIDE","Menu_Click_Update")
Gui.FormQuote..ContextMenuSetItemEventHandler("CGQ","COPY LINE INFO","Menu_Click_Copy_Line")
Gui.FormQuote..ContextMenuSetItemEventHandler("CGQ","PASTE LINE INFO","Menu_Click_Paste_Line")
'F.Intrinsic.Control.If(V.Caller.CompanyCode,=,"TST")
	Gui.FormQuote..ContextMenuSetItemEventHandler("CGQ","UPDATE FLAT","Menu_Click_UpdateFlat")
'F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Create_ContextMenu_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Create_ContextMenu.End

Program.Sub.Menu_Click.Start
F.Intrinsic.Control.SetErrorHandler("Menu_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRow.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.iCol.Declare(Long,0)
V.Local.sSql.Declare(String,"")
V.Local.sUser.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sCaption.Declare(String,"")
V.Local.sFilter.Declare(String,"")

V.Global.bSave.Set(False)

Gui.FormQuote.GsGridQuote.GetSelectedRows("GQuote",V.Local.sRow)
Gui.FormQuote.GsGridQuote.GetColumnIndexByName("GQuote","SIGN_ROUTER",V.Local.iCol)

'bring up the userfield screen for mass update of userfield and committing to selected routers
F.Intrinsic.Control.If(V.Local.sRow,<>,"")
	Gui.FormQuote..Enabled(False)
	Gui.FormQuote.GsGridQuote.GetCellValue("GQuote",V.Local.iCol,V.Local.sRow.Long,V.Local.sRouter)
	F.Intrinsic.String.Build("SIGN_ROUTER = '{0}'",V.Local.sRouter,V.Local.sFilter)
	F.Data.DataView.Create("Quote","VQuote",22,V.Local.sFilter,"")
	V.Local.sRouter.Set(V.Local.sRouter.UCase)
	F.Data.DataTable.SetValue("UserFields",-1,"Router",V.Local.sRouter)
	
	F.Intrinsic.String.Build("Router User Fields - {0}",V.Local.sRouter,V.Local.sCaption)
	Gui.FormRouter.lblUserFields.Caption(V.Local.sCaption)
	F.ODBC.Connection!Con.OpenCompanyConnection
	V.Global.bOpen.Set(True)
	F.Intrinsic.String.Build("Select rtrim(Router) as Router From V_Router_Header where Router like '{0}%'",V.Local.sRouter.Left2,V.Local.sSql)
	F.Data.DataTable.CreateFromSQL("TempR","con",V.Local.sSql,True)
	F.Data.DataTable.Merge("TempR","Routers",False,4)
	F.Data.DataTable.Close("TempR")
	F.Data.DataTable.SetValue("Routers",-1,"Selection",False)
	F.Intrinsic.String.Build("ROUTER = '{0}'",V.Local.sRouter,V.Local.sFilter)
	F.Data.DataView.Create("Routers","VTemp",22,V.Local.sFilter,"")
	F.Data.DataView.SetValue("Routers","VTemp",-1,"SELECTION",True)
	F.Data.DataView.Close("Routers","VTemp")
	V.Local.sRouter.Set(V.Local.sRouter.Trim)
	F.Intrinsic.String.Build("Select * From GCG_6313_RTR_EXTRA where ucase(Router) = '{0}'",V.Local.sRouter.UCase,V.Local.sSql)
	F.Data.DataTable.CreateFromSQL("TempR","con",V.Local.sSql,True)
	F.Intrinsic.Control.If(V.DataTable.TempR.RowCount--,<>,-1)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.UserFields.RowCount--,1)
			F.Intrinsic.Math.Add(V.Local.i,1,V.Local.iCol)
			F.Intrinsic.String.Build("USER{0}",V.Local.iCol,V.Local.sUser)
			F.Data.DataTable.SetValue("UserFields",V.Local.i,"Value",V.DataTable.TempR(V.DataTable.TempR.RowCount--).[V.Local.sUser]!FieldValTrim)
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.EndIf
	F.Data.DataTable.Close("TempR")
	F.ODBC.Connection!Con.Close
	V.Global.bOpen.Set(False)
	Gui.FormRouter..Show

	Gui.FormRouter..WaitForDismiss
	F.Data.DataView.Close("Quote","VQuote")
	F.Intrinsic.Control.If(V.Global.bSave)
		F.Intrinsic.Control.CallSub(cmdSave_Click)
	F.Intrinsic.Control.EndIf
	Gui.FormQuote..Enabled(True)
	Gui.FormQuote..AlwaysOnTop(True)
	Gui.FormQuote..AlwaysOnTop(False)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Menu_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Menu_Click.End

Program.Sub.FormRouter_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("FormRouter_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

F.Data.DataTable.DeleteRow("Routers")
F.Data.DataTable.AcceptChanges("Routers")
F.Data.DataTable.SetValue("UserFields",-1,"Router",False,"Value","")

Gui.FormRouter..Enabled(True)

Gui.FormRouter..Visible(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormRouter_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.FormRouter_UnLoad.End

Program.Sub.cmdCommit_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdCommit_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.iR.Declare(Long,0)
V.Local.sRouter.Declare(String,"")
V.Local.sFields.Declare(String,"")
V.Local.sFieldMap.Declare(String,"")

Gui.FormRouter..Enabled(False)

'committing user field changes to the selected routers and select user fields
F.Intrinsic.Control.If(V.DataView.Routers!VRouters.RowCount--,<>,-1)
	F.Intrinsic.Control.If(V.DataView.UserFields!VUserFields.RowCount--,<>,-1)
		F.Data.DataView.ToString("UserFields","VUserFields","UserField",V.Ambient.NewLine,",",V.Local.sFields)
		F.ODBC.Connection!Con.OpenCompanyConnection
		V.Global.bOpen.Set(True)
		F.Intrinsic.Control.For(V.Local.iR,0,V.DataView.Routers!VRouters.RowCount--)
			V.Local.sRouter.Set(V.DataView.Routers!VRouters(V.Local.iR).Router!FieldValTrim)
			F.Intrinsic.String.Build("Select rtrim(Router) as Router, {0} From GCG_6313_RTR_EXTRA Where ucase(Router) = '{1}'",V.Local.sFields,V.Local.sRouter.UCase,V.Local.sSql)
			F.Data.DataTable.CreateFromSQL("Extra","con",V.Local.sSql,True)
			F.Intrinsic.Control.For(V.Local.i,0,V.DataView.UserFields!VUserFields.RowCount--,1)
				F.Intrinsic.Control.If(V.Local.i,=,0)
					F.Intrinsic.String.Build("{0}@!@!{0}",V.DataView.UserFields!VUserFields(V.Local.i).UserField!FieldValTrim,V.Local.sFieldMap)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}*!*{1}@!@!{1}",V.Local.sFieldMap,V.DataView.UserFields!VUserFields(V.Local.i).UserField!FieldValTrim,V.Local.sFieldMap)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.DataTable.Extra.RowCount--,<>,-1)
					F.Data.DataTable.SetValue("Extra",-1,V.DataView.UserFields!VUserFields(V.Local.i).UserField!FieldValTrim,V.DataView.UserFields!VUserFields(V.Local.i).Value!FieldValTrim)
				F.Intrinsic.Control.Else
					F.Data.DataTable.AddRow("Extra","Router",V.Local.sRouter,V.DataView.UserFields!VUserFields(V.Local.i).UserField!FieldValTrim,V.DataView.UserFields!VUserFields(V.Local.i).Value!FieldValTrim)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.DataView.Quote!VQuote.RowCount--,<>,-1)
					F.Data.DataView.SetValue("Quote","VQuote",-1,V.DataView.UserFields!VUserFields(V.Local.i).UserField!FieldValTrim,V.DataView.UserFields!VUserFields(V.Local.i).Value!FieldValTrim)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.i)
			F.Data.DataTable.SaveToDB("Extra","con","GCG_6313_RTR_EXTRA","Router",3)
			F.Data.DataTable.Close("Extra")
		F.Intrinsic.Control.Next(V.Local.iR)
		F.ODBC.Connection!Con.Close
		V.Global.bOpen.Set(False)
		V.Global.bSave.Set(True)
		F.Intrinsic.Control.CallSub(FormRouter_UnLoad)
	F.Intrinsic.Control.Else
		F.Intrinsic.UI.Msgbox("No User Fields have been Selected","Attention")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.DataView.UserFields!VUserFields.RowCount--,<>,-1)
		F.Intrinsic.UI.Msgbox("No Routers have been Selected","Attention")
	F.Intrinsic.Control.Else
		F.Intrinsic.UI.Msgbox("No Routers and User Fields have been Selected","Attention")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

Gui.FormRouter..Enabled(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdCommit_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdCommit_Click.End

Program.Sub.Create_SO.Start
F.Intrinsic.Control.SetErrorHandler("Create_SO_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sDueDate.Declare(String,"")
V.Local.sOrderDate.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.sWOFile.Declare(String,"")
V.Local.sDate.Declare(String,"")
V.Local.sFile.Declare(String,"")
V.Local.sLocal.Declare(String,"")
V.Local.sData.Declare(String,"")
V.Local.iC.Declare(Long,0)
V.Local.sFilter.Declare(String,"")
V.Local.fSF.Declare(Float,0)
V.Local.fTSF.Declare(Float,0)
V.Local.fSFExt.Declare(Float,0)
V.Local.fTemp.Declare(Float,0)
V.Local.sQty.Declare(String,"")
V.Local.sCost.Declare(String,"")
V.Local.fUnit.Declare(Float,0)
V.Local.sUser1.Declare(String,"")
V.Local.sUser3.Declare(String,"")
V.Local.sUser4.Declare(String,"")
V.Local.sUser5.Declare(String,"")
V.Local.sMsg.Declare(String,"")
V.Local.sTemp.Declare(String,"")
V.Local.iStart.Declare(Long,0)
V.Local.sPart.Declare(String,"")
V.Local.sRev.Declare(String,"")
V.Local.iRem.Declare(Long,0)
V.Local.sDesc.Declare(String,"")
V.Local.bImport.Declare(Boolean,False)

F.Intrinsic.Math.Add(V.Args.Index,1,V.Local.iStart)

'making sure users fields are filled out before creating so and wo's
V.Local.sUser1.Set(V.Screen.FormQuote!txtUser1.Text)
V.Local.sUser3.Set(V.Screen.FormQuote!txtUser3.Text)
V.Local.sUser4.Set(V.Screen.FormQuote!txtUser4.Text)
V.Local.sUser5.Set(V.Screen.FormQuote!txtUser5.Text)

'formating dates for so creating
F.Intrinsic.String.Format(V.Screen.FormQuote!dtpDueDate.Value,"YYYYMMDD",V.Local.sDueDate)
F.Intrinsic.String.Format(V.Ambient.Date,"YYYYMMDD",V.Local.sOrderDate)

Gui.FormQuote..Enabled(False)

F.ODBC.Connection!Con.OpenCompanyConnection
V.Global.bOpen.Set(True)
F.Intrinsic.UI.InvokeWaitDialog("Creating Sales Order.........................")

'getting custom ship to 
F.Intrinsic.String.Build("Select Name_Customer_Ship, Address_1_Ship, Address_2_Ship, Address_3_Ship, City_Ship, State_Ship, Code_Zip_Ship From V_ORDER_SHIP_TO Where Order_No = '{0}'",V.Global.sPrevQuote,V.Local.sSql)
F.Data.DataTable.CreateFromSQL("Cust","con",V.Local.sSql,True)

F.ODBC.Connection!Con.Close
V.Global.bOpen.Set(False)
F.Data.DataTable.AddRow("ORDUPL","Transaction","O","CustomerNO",V.Screen.FormQuote!txtCust.Text,"OrderDueDate",V.Local.sDueDate,"OrderDate",V.Local.sOrderDate,"CustomerPO",V.Screen.FormQuote!txtCustPO.Text,"SHIPToName",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Name_Customer_Ship!FieldValTrim,"ShipToAddress1",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Address_1_Ship!FieldValTrim,"ShipToAddress2",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Address_2_Ship!FieldValTrim,"ShipToAddress3",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Address_3_Ship!FieldValTrim,"ShipToCity",V.DataTable.Cust(V.DataTable.Cust.RowCount--).City_Ship!FieldValTrim,"ShipToState",V.DataTable.Cust(V.DataTable.Cust.RowCount--).State_Ship!FieldValTrim,"ShipToZip",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Code_Zip_Ship!FieldValTrim,"UserField1Head",V.Local.sUser1.Trim,"UserField3Head",V.Local.sUser3.Trim,"UserField4Head",V.Local.sUser4.Trim,"UserField5Head",V.Local.sUser5.Trim)

F.Data.DataView.Create("Quote","TempUnit",22,"Unit is null or Unit <= 0","")
F.Intrinsic.Control.If(V.DataView.Quote!TempUnit.RowCount--,<>,-1)
	F.Intrinsic.UI.Msgbox("Units needs to be filled out for each sign and be > 0","Attention")
	F.Data.DataView.Close("Quote","TempUnit")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
F.Data.DataView.Close("Quote","TempUnit")

F.Intrinsic.Control.For(V.Local.i,V.Local.iStart,V.DataTable.Quote.RowCount--,1)
	F.Intrinsic.Control.If(V.DataTable.ORDUPL.RowCount--,=,-1)
		F.Data.DataTable.AddRow("ORDUPL","Transaction","O","CustomerNO",V.Screen.FormQuote!txtCust.Text,"OrderDueDate",V.Local.sDueDate,"OrderDate",V.Local.sOrderDate,"CustomerPO",V.Screen.FormQuote!txtCustPO.Text,"SHIPToName",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Name_Customer_Ship!FieldValTrim,"ShipToAddress1",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Address_1_Ship!FieldValTrim,"ShipToAddress2",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Address_2_Ship!FieldValTrim,"ShipToAddress3",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Address_3_Ship!FieldValTrim,"ShipToCity",V.DataTable.Cust(V.DataTable.Cust.RowCount--).City_Ship!FieldValTrim,"ShipToState",V.DataTable.Cust(V.DataTable.Cust.RowCount--).State_Ship!FieldValTrim,"ShipToZip",V.DataTable.Cust(V.DataTable.Cust.RowCount--).Code_Zip_Ship!FieldValTrim,"UserField1Head",V.Local.sUser1.Trim,"UserField3Head",V.Local.sUser3.Trim,"UserField4Head",V.Local.sUser4.Trim,"UserField5Head",V.Local.sUser5.Trim)
	F.Intrinsic.Control.EndIf
	V.Local.sRev.Set("")
	V.Local.sPart.Set(V.DataTable.Quote(V.Local.i).Sign_Router!FieldValTrim)
	F.Intrinsic.String.IsInString(V.Local.sPart.UCase,"IMPORT",True,V.Local.bImport)
	
	F.Intrinsic.Control.If(V.Local.bImport)
		V.Local.sCost.Set("0.0000")
	F.Intrinsic.Control.Else
		f.Intrinsic.String.Format(V.DataTable.Quote(V.Local.i).UM_Each!FieldValfloat,"0.0000",V.Local.sCost)
	F.Intrinsic.Control.EndIf
	
'	F.Intrinsic.Math.Mult(V.DataTable.Quote(V.Local.i).Unit!FieldVal,10000,V.Local.sQty.Long)
	F.Intrinsic.Math.Mult(V.DataTable.Quote(V.Local.i).Totl_SF!FieldValfloat,10000,V.Local.sQty.Long)
	F.Intrinsic.Math.Mult(V.Local.sCost.Float,1000000,V.Local.sCost)
	F.Intrinsic.String.LPad(V.Local.sQty,"0",13,V.Local.sQty)
	F.Intrinsic.String.LPad(V.Local.sCost,"0",13,V.Local.sCost)
'	F.Intrinsic.Control.If(V.DataTable.Quote(V.Local.i).UM!FieldValTrim,=,"SF")
'		F.Intrinsic.Math.Mult(V.DataTable.Quote(V.Local.i).SF_PRICE!FieldVal,V.DataTable.Quote(V.Local.i).TOTL_SF!FieldVal,V.Local.fTemp)
'		F.Intrinsic.Math.Div(V.Local.fTemp,V.DataTable.Quote(V.Local.i).Unit!FieldVal,V.Local.fUnit)
'		F.Intrinsic.Math.Mult(V.DataTable.Quote(V.Local.i).Unit!FieldVal,10000,V.Local.sQty.Long)
'		F.Intrinsic.String.Format(V.Local.fUnit,"0.0000",V.Local.sCost)
'		F.Intrinsic.Math.Mult(V.Local.sCost.Float,1000000,V.Local.sCost)
'		F.Intrinsic.String.LPad(V.Local.sQty,"0",13,V.Local.sQty)
'		F.Intrinsic.String.LPad(V.Local.sCost,"0",13,V.Local.sCost)
'	F.Intrinsic.Control.ElseIf(V.DataTable.Quote(V.Local.i).UM!FieldValTrim,=,"AS")
'		F.Intrinsic.String.Build("Group_No = '{0}'",V.DataTable.Quote(V.Local.i).Group_No!FieldValTrim,V.Local.sFilter)
'		F.Data.DataView.Create("Quote","TempUnit",22,V.Local.sFilter,"")
'		F.Data.DataView.ToDataTable("QUOTE","TempUnit","Temp",True)
'		F.Data.DataTable.AddExpressionColumn("Temp","SumUnit",Float,"Sum(Unit)")
'		V.Local.fUnit.Set(V.DataTable.Temp(V.DataTable.Temp.RowCount--).SumUnit!FieldValFloat)
'		F.Data.DataTable.Close("Temp")
'		F.Data.DataView.Close("Quote","TempUnit")
'		F.Intrinsic.Math.Mult(V.DataTable.Quote(V.Local.i).Unit!FieldVal,10000,V.Local.sQty.Long)
'		F.Intrinsic.String.Format(V.Local.fUnit,"0.0000",V.Local.sCost)
'		F.Intrinsic.Math.Mult(V.Local.sCost.Float,1000000,V.Local.sCost)
'		F.Intrinsic.String.LPad(V.Local.sQty,"0",13,V.Local.sQty)
'		F.Intrinsic.String.LPad(V.Local.sCost,"0",13,V.Local.sCost)
'	F.Intrinsic.Control.Else
'		V.Local.fUnit.Set(V.DataTable.Quote(V.Local.i).SF_PRICE!FieldVal)
'		F.Intrinsic.Math.Mult(V.DataTable.Quote(V.Local.i).Unit!FieldVal,10000,V.Local.sQty.Long)
'		F.Intrinsic.String.Format(V.Local.fUnit,"0.0000",V.Local.sCost)
'		F.Intrinsic.Math.Mult(V.Local.sCost.Float,1000000,V.Local.sCost)
'		F.Intrinsic.String.LPad(V.Local.sQty,"0",13,V.Local.sQty)
'		F.Intrinsic.String.LPad(V.Local.sCost,"0",13,V.Local.sCost)
'	F.Intrinsic.Control.EndIf
	'adding so lines to sales order, these are the so line that is used for creating wo's
	
		F.Intrinsic.Control.If(V.Local.sPart.Length,>,17)
			F.Intrinsic.Math.Sub(V.Local.sPart.Length,17,V.Local.iRem)
			F.Intrinsic.String.Right(V.Local.sPart,V.Local.iRem,V.Local.sRev)
			F.Intrinsic.String.Left(V.Local.sPart,17,V.Local.sPart)
		F.Intrinsic.Control.EndIf
	V.Local.sDesc.Set(V.DataTable.Quote(V.Local.i).MESSAGE!FieldVal)
	F.Data.DataTable.AddRow("ORDUPLLines","QtyOrdered",V.Local.sQty,"UM","SF","PartNumber",V.Local.sPart,"PartRev",V.Local.sRev,"PartLoc","","QuotedPrice",V.Local.sCost,"PartDesc",V.Local.sDesc.Left30,"LineOrderDate",V.Local.sOrderDate,"PL",V.DataTable.Quote(V.Local.i).PL!FieldVal,"UserField1","","UserField5",V.DataTable.Quote(V.Local.i).Line_Item!FieldVal,"Router",V.DataTable.Quote(V.Local.i).Sign_Router!FieldVal,"LinePromiseDate",V.Local.sDueDate,"LineType","S")
	F.Intrinsic.Control.If(V.DataTable.ORDUPLLines.RowCount--,=,996,"AND",V.Local.i,<,V.DataTable.Quote.RowCount--)
		F.Intrinsic.Control.CallSub(ORDUPLCreateFile)
		F.Intrinsic.Control.CallSub(ORDUPLSync)
		F.Data.DataTable.AcceptChanges("ORDUPLExtra")
		F.Data.DataTable.AcceptChanges("ORDUPLLines")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.i)

F.Intrinsic.Control.If(V.DataTable.ORDUPL.RowCount--,<>,-1)
	F.Intrinsic.Control.CallSub(ORDUPLCreateFile)
	F.Intrinsic.Control.CallSub(ORDUPLSync)
F.Intrinsic.Control.EndIf

F.Data.DataTable.AcceptChanges("ORDUPL")
F.Data.DataTable.AcceptChanges("ORDUPLExtra")
F.Data.DataTable.AcceptChanges("ORDUPLLines")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Create_SO_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Create_SO.End

Program.Sub.Update_SO.Start
F.Intrinsic.Control.SetErrorHandler("Update_SO_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.iEnd.Declare(Long,0)
v.Local.sTemp.Declare(String,"")
v.Local.sHold.Declare(String,"")
v.Local.sParam.Declare(String,"")
v.Local.sPath.Declare(String,"")
V.Local.iLine.Declare(Long,1)
V.Local.sData.Declare(String,"")
V.Local.fTemp.Declare(Float,0)
V.Local.sDescription.Declare(String,"")
V.Local.sLine.Declare(String,"")
V.Local.sFileName.Declare(String,"")
V.Local.sUpdateLines.Declare(String,"")
V.Local.sLineTemp.Declare(String,"")
V.Local.sDueDate.Declare(String,"")
V.Local.sDate.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sRecordNo.Declare(String,"")
V.Local.sFilter.Declare(String,"")
V.Local.iStart.Declare(Long,0)
V.Local.sOrder.Declare(String,"")
V.Local.bRet.Declare(Boolean,False)
V.Local.sRouter.Declare(String,"")
V.Local.bImport.Declare(Boolean,False)

F.Intrinsic.Math.Div(V.Args.Record_No.Long,10,V.Local.iLine)
V.Local.iStart.Set(V.Args.Start.Long)

F.Intrinsic.Control.If(V.Global.bNew)
	F.Intrinsic.Control.If(V.Global.sLastLine.Trim,=,"")
		'keeping additional 5 lines availabe on org SO
		F.Intrinsic.Math.Add(V.Local.iLine,6,V.Local.iLine)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Variable.ArgExists("Order",V.Local.bRet)
	F.Intrinsic.Control.If(V.Local.bRet)
		V.Local.sOrder.Set(V.Args.Order)
		F.Intrinsic.Math.Add(V.Local.iLine,1,V.Local.iLine)
	F.Intrinsic.Control.Else
		V.Local.sOrder.Set(v.Global.sPrevQuote)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Math.Sub(995,V.Local.iLine,V.Local.iEnd)
	
F.Intrinsic.Control.Else
	F.Intrinsic.Math.Sub(995,V.Local.iLine,V.Local.iEnd)
	F.Intrinsic.Math.Add(V.Local.iLine,1,V.Local.iLine)
	F.Intrinsic.Math.Add(V.Local.iEnd,V.Local.iStart,V.Local.iEnd)
	V.Local.sOrder.Set(V.Args.Order)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.Quote.RowCount--,<,V.Local.iEnd)
	V.Local.iEnd.Set(V.DataTable.Quote.RowCount--)
F.Intrinsic.Control.EndIf
	
F.ODBC.Connection!conx.OpenCompanyConnection

F.Intrinsic.Control.For(V.Local.i,V.Local.iStart,V.Local.iEnd,1)
	V.Local.sTemp.Set("")
	'Transaction 1+7+7 "O" for Order, then Customer, Order #
	f.Intrinsic.String.Build("O{0} {1}",V.Screen.FormQuote!txtCust.Text,V.Local.sOrder,v.Local.sTemp)
	
	'Part
	f.Intrinsic.String.Build("{0}{1}",v.Local.sTemp,V.DataTable.Quote(V.Local.i).Sign_Router!FieldValTrim,v.Local.sTemp)
	V.Local.sRouter.Set(V.DataTable.Quote(V.Local.i).Sign_Router!FieldValTrim)
	F.Intrinsic.String.IsInString(V.Local.sRouter.UCase,"IMPORT",True,V.Local.bImport)
	
	'Location
	f.Intrinsic.String.RPad(v.Local.sTemp," ",53,v.Local.sTemp)
	F.Intrinsic.String.Concat(v.Local.sTemp,"  ",V.Local.sTemp)
			
	'Product line
	F.Intrinsic.String.Concat(V.Local.sTemp,V.DataTable.Quote(V.Local.i).PL!FieldValTrim,V.Local.sTemp)
		
	'Description
	f.Intrinsic.String.RPad(v.Local.sTemp," ",60,v.Local.sTemp)
	V.Local.sDescription.Set(V.DataTable.Quote(V.Local.i).Message!FieldValTrim)
	F.Intrinsic.Control.If(V.Local.sDescription.Length,>,30)
		F.Intrinsic.String.Left(V.DataTable.Quote(V.Local.i).Message!FieldValTrim,30,v.Local.sHold)
	F.Intrinsic.Control.Else
		f.Intrinsic.String.RPad(V.DataTable.Quote(V.Local.i).Message!FieldValTrim," ",30,v.Local.sHold)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.String.Concat(V.Local.sTemp,v.Local.sHold,V.Local.sTemp)
	
	'line number 001-999
	'lines that are used by the system so not using (701,702,703 Shipping),(800 Frieght)
	F.Intrinsic.Control.If(V.Local.iLine,=,701)
		V.Local.iLine.Set(704)
	F.Intrinsic.Control.ElseIF(V.Local.iLine,=,702)
		V.Local.iLine.Set(704)
	F.Intrinsic.Control.ElseIF(V.Local.iLine,=,703)
		V.Local.iLine.Set(704)
	F.Intrinsic.Control.ElseIf(V.Local.iLine,=,800)
		V.Local.iLine.Set(801)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.String.LPad(V.Local.iLine,"0",3,V.Local.sLine)
	F.Intrinsic.String.RPad(V.Local.sLine,"0",4,V.Local.sRecordNo)
	F.Intrinsic.String.Build("{0}0",V.Local.sLine,V.Local.sLineTemp)
	F.Intrinsic.Control.If(V.Local.sUpdateLines.Trim,=,"")
		V.Local.sUpdateLines.Set(V.Local.sLineTemp)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}','{1}",V.Local.sUpdateLines,V.Local.sLineTemp,V.Local.sUpdateLines)
	F.Intrinsic.Control.EndIf
			
	f.Intrinsic.String.RPad(v.Local.sTemp," ",90,v.Local.sTemp)
	F.Intrinsic.String.Concat(V.Local.sTemp,V.Local.sLine,V.Local.sTemp)
			
	'Line type			
	F.Intrinsic.String.Concat(V.Local.sTemp,"S",V.Local.sTemp)
	
	'quantity 9.4 13
	f.Intrinsic.String.RPad(v.Local.sTemp," ",94,v.Local.sTemp)
'	f.Intrinsic.String.Format(V.DataTable.Quote(V.Local.i).Unit!FieldValfloat,"0.0000",v.Local.sHold)
	F.Intrinsic.String.Format(V.DataTable.Quote(V.Local.i).Totl_SF!FieldValfloat,"0.0000",v.Local.sHold)
	f.Intrinsic.String.Replace(v.Local.sHold,".","",v.Local.sHold)
	f.Intrinsic.String.LPad(v.Local.sHold,"0",13,v.Local.sHold)
	F.Intrinsic.String.Concat(V.Local.sTemp,V.Local.sHold,V.Local.sTemp)
	
	'price
	f.Intrinsic.String.RPad(v.Local.sTemp," ",117,v.Local.sTemp)
	
	F.Intrinsic.Control.If(V.Local.bImport)
		V.Local.sHold.Set("0.000000")
	F.Intrinsic.Control.Else
		f.Intrinsic.String.Format(V.DataTable.Quote(V.Local.i).UM_Each!FieldValfloat,"0.000000",v.Local.sHold)
	F.Intrinsic.Control.EndIf
	
	f.Intrinsic.String.Replace(v.Local.sHold,".","",v.Local.sHold)
	F.Intrinsic.String.LPad(V.Local.sHold,"0",16,V.Local.sHold)
	F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sHold,V.Local.sTemp)
'	F.Intrinsic.Control.If(V.DataTable.Quote(V.Local.i).UM!FieldValTrim,=,"SF")
'		f.Intrinsic.String.RPad(v.Local.sTemp," ",117,v.Local.sTemp)
'		F.Intrinsic.Math.Mult(V.DataTable.Quote(V.Local.i).SF_PRICE!FieldVal,V.DataTable.Quote(V.Local.i).TOTL_SF!FieldVal,V.Local.fTemp)
'		F.Intrinsic.Math.Div(V.Local.fTemp,V.DataTable.Quote(V.Local.i).Unit!FieldValfloat,V.Local.fTemp)
'		f.Intrinsic.String.Format(V.Local.fTemp,"0.000000",v.Local.sHold)
'		f.Intrinsic.String.Replace(v.Local.sHold,".","",v.Local.sHold)
'		F.Intrinsic.String.LPad(V.Local.sHold,"0",16,V.Local.sHold)
'		F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sHold,V.Local.sTemp)
'	F.Intrinsic.Control.ElseIf(V.DataTable.Quote(V.Local.i).UM!FieldValTrim,=,"AS")
'		F.Intrinsic.String.Build("Group_No = '{0}'",V.DataTable.Quote(V.Local.i).Group_No!FieldValTrim,V.Local.sFilter)
'		F.Data.DataView.Create("Quote","TempUnit",22,V.Local.sFilter,"")
'		F.Data.DataView.ToDataTable("QUOTE","TempUnit","Temp",True)
'		F.Data.DataTable.AddExpressionColumn("Temp","SumUnit",Float,"Sum(Unit)")
'		V.Local.fTemp.Set(V.DataTable.Temp(V.DataTable.Temp.RowCount--).SumUnit!FieldValFloat)
'		F.Data.DataTable.Close("Temp")
'		F.Data.DataView.Close("Quote","TempUnit")
'		f.Intrinsic.String.RPad(v.Local.sTemp," ",117,v.Local.sTemp)
'		f.Intrinsic.String.Format(V.Local.fTemp,"0.000000",v.Local.sHold)
'		f.Intrinsic.String.Replace(v.Local.sHold,".","",v.Local.sHold)
'		F.Intrinsic.String.LPad(V.Local.sHold,"0",16,V.Local.sHold)
'		F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sHold,V.Local.sTemp)
'	F.Intrinsic.Control.Else
'		V.Local.fTemp.Set(V.DataTable.Quote(V.Local.i).SF_PRICE!FieldVal)
'		f.Intrinsic.String.RPad(v.Local.sTemp," ",117,v.Local.sTemp)
'		f.Intrinsic.String.Format(V.Local.fTemp,"0.000000",v.Local.sHold)
'		f.Intrinsic.String.Replace(v.Local.sHold,".","",v.Local.sHold)
'		F.Intrinsic.String.LPad(V.Local.sHold,"0",16,V.Local.sHold)
'		F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sHold,V.Local.sTemp)
'	F.Intrinsic.Control.EndIf
	
	'UserFields1-4
	V.Local.sHold.Set("")
	F.Intrinsic.String.RPad(V.Local.sHold," ",120,V.Local.sHold)
	F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sHold,V.Local.sTemp)
	'Userfield5
	V.Local.sHold.Set(V.DataTable.Quote(V.Local.i).Line_Item!FieldVal)
	F.Intrinsic.String.RPad(V.Local.sHold," ",30,V.Local.sHold)
	F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sHold,V.Local.sTemp)
	
	'UM
	F.Intrinsic.String.RPad(V.Local.sTemp," ",283,V.Local.sTemp)
	F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,"SF",V.Local.sTemp)

	F.Intrinsic.Control.If(V.Local.sData.Trim,=,"")
		V.Local.sData.Set(V.Local.sTemp)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}{1}{2}",V.Local.sData,V.Ambient.NewLine,V.Local.sTemp,V.Local.sData)
	F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Math.Add(v.Local.iLine,1,V.Local.iLine)

F.Intrinsic.Control.Next(V.Local.i)

F.ODBC.Connection!conx.Close

F.Intrinsic.Control.If(V.Local.sData.Trim,<>,"")
	F.Intrinsic.String.Build("SOLINESUPLOAD{0}{1}",V.Caller.Terminal,V.Caller.CompanyCode,V.Local.sFileName)
	F.Intrinsic.String.Concat(V.Caller.FilesDir,"\",V.Local.sFileName,V.Local.sPath)
	F.Intrinsic.File.String2File(V.Local.sPath,V.Local.sData)
	
	'Upload
	f.Intrinsic.String.Build("{0}!*!O!*!{1}",V.Local.sOrder,v.Local.sPath,v.Local.sParam)
	
	F.Global.General.CallWrapperSync(7020,v.Local.sParam)
F.Intrinsic.Control.EndIf

f.Intrinsic.String.Format(V.Screen.FormQuote!dtpDueDate.Value,"YYYYMMDD",V.Local.sDate)
F.Intrinsic.String.Format(V.Screen.FormQuote!dtpDueDate.Value,"MMDDYY",V.Local.sDueDate)

F.ODBC.Connection!conx.OpenCompanyConnection
F.Intrinsic.String.Build("Update Order_Lines Set Date_Item_Prom = '{1}', Item_Promise_Dt = '{2}' Where Order_No = '{3}' and Record_No In('{0}')",V.Local.sUpdateLines,V.Local.sDate,V.Local.sDueDate,V.Local.sOrder,V.Local.sSql)
F.ODBC.Connection!Conx.Execute(V.Local.sSql)
F.ODBC.Connection!conx.Close

F.Intrinsic.Variable.AddRV("Index",V.Local.iEnd)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Update_SO_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Update_SO.End

Program.Sub.ddlRouter_Change.Start
F.Intrinsic.Control.SetErrorHandler("ddlRouter_Change_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtLines.Text("1")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlRouter_Change_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlRouter_Change.End

Program.Sub.cmdRout_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdRout_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.sState.Declare(String,"")

V.Local.sState.Set(V.Screen.FormQuote!ddlState.Text)
F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.SetBrowserOOT(True)

F.Intrinsic.Control.If(V.Local.sState.Trim,=,"")
	F.Intrinsic.UI.Msgbox("Select a State")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

'F.Intrinsic.String.Build("Select rtrim(ucase(A.Router)), B.User2 as Message, B.User5 as Size, B.User8 as Punch From V_ROUTER_HEADER A Left Join GCG_6313_RTR_Extra B on rtrim(ucase(A.Router)) = rtrim(ucase(B.Router)) Where ucase(A.Router) like '{0}%' Order by A.Router",V.Screen.FormQuote!ddlState.Text,V.Local.sSql)
F.Intrinsic.String.Build("Select rtrim(ucase(B.Router)), B.User2 as Message, B.User5 as Size, B.User8 as Punch From GCG_6313_RTR_Extra B Where ucase(B.Router) like '{0}%' or ucase(B.Router) like '00%' Order by B.Router",V.Screen.FormQuote!ddlState.Text,V.Local.sSql)
V.Local.sTitles.Set("Router*!*Message*!*Size*!*Punch")
V.Local.sWidths.Set("1800*!*2400*!*1500*!*1500")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.ODBC.Connection!ConX.OpenCompanyConnection

F.Intrinsic.UI.Browser("Select Router","conX",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,9000,V.Local.sRet)

F.ODBC.Connection!ConX.Close
	
F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	V.Local.sRet.Set(V.Local.sRet.Trim)
	Gui.FormQuote.ddlRouter.Text(V.Local.sRet.UCase)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdRout_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdRout_Click.End

Program.Sub.Menu_Click_Paste.Start
F.Intrinsic.Control.SetErrorHandler("Menu_Click_Paste_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sMsg.Declare(String,"")
V.Local.iIndex.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.sRow.Declare(String,"")
V.Local.iCol.Declare(Long,0)
V.Local.sRouter.Declare(String,"")
V.Local.sGroup.Declare(String,"")
V.Local.sRouterTemp.Declare(String,"")
V.Local.sGroupTemp.Declare(String,"")

Gui.FormQuote.GsGridQuote.GetSelectedRows("GQuote",V.Local.sRow)
F.Intrinsic.String.Split(V.Local.sRow,"*!*",V.Local.sRow)
V.Local.iIndex.Set(V.Local.sRow.Long)

Gui.FormQuote.GsGridQuote.GetColumnIndexByName("GQuote","MESSAGE",V.Local.iCol)

Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","GROUP_NO",V.Local.iIndex,V.Local.sGroup)
Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","SIGN_ROUTER",V.Local.iIndex,V.Local.sRouter)

f.Intrinsic.UI.GetClipboardText(V.Local.sMsg)

F.Intrinsic.String.Split(V.Local.sMsg,V.Ambient.NewLine,V.Local.sMsg)

F.Intrinsic.Control.For(V.Local.i,0,V.Local.sMsg.UBound,1)
	F.Intrinsic.Control.If(V.Local.iIndex,>,V.DataTable.Quote.RowCount--)
		F.Intrinsic.Control.ExitFor(V.Local.i)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Local.i,=,0)
		Gui.FormQuote.GsGridQuote.SetCellValue("GQuote",V.Local.iCol,V.Local.iIndex,V.Local.sMsg(V.Local.i).Trim)
	F.Intrinsic.Control.Else
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","GROUP_NO",V.Local.iIndex,V.Local.sGroupTemp)
		Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","SIGN_ROUTER",V.Local.iIndex,V.Local.sRouterTemp)
		F.Intrinsic.Control.If(V.Local.sGroup.Trim,=,V.Local.sGroupTemp.Trim,"AND",V.Local.sRouter.Trim,=,V.Local.sRouterTemp.Trim)
			Gui.FormQuote.GsGridQuote.SetCellValue("GQuote",V.Local.iCol,V.Local.iIndex,V.Local.sMsg(V.Local.i).Trim)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.ExitFor(V.Local.i)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Add(V.Local.iIndex,1,V.Local.iIndex)
F.Intrinsic.Control.Next(V.Local.i)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Menu_Click_Paste_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Menu_Click_Paste.End

Program.Sub.Menu_Click_Update.Start
F.Intrinsic.Control.SetErrorHandler("Menu_Click_Update_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sGroup.Declare(String,"")
V.Local.sFilter.Declare(String,"")
V.Local.sPL.Declare(String,"")
V.Local.iIndex.Declare(Long,0)
V.Local.iRow.Declare(Long,0)
V.Local.sRow.Declare(String,"")
V.Local.sFileName.Declare(String,"")
V.Local.iRet.Declare(Long,0)
V.Local.sRouterTemp.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sDesc.Declare(String,"")
V.Local.sRun_Time.Declare(String,"")
V.Local.sComment.Declare(String,"")
V.Local.iStart.Declare(Long,0)
V.Local.bRet.Declare(Boolean,False)

Gui.FormQuote.GsGridQuote.InvokeWait("Updating Guide Signs")

Gui.FormQuote.GsGridQuote.GetSelectedRows("GQuote",V.Local.sRow)
F.Intrinsic.String.Split(V.Local.sRow,"*!*",V.Local.sRow)
V.Local.iIndex.Set(V.Local.sRow.Long)

Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","GROUP_NO",V.Local.iIndex,V.Local.sGroup)
Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","PL",V.Local.iIndex,V.Local.sPL)
Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","SIGN_ROUTER",V.Local.iIndex,V.Local.sRouterTemp)

F.Intrinsic.Control.If(V.Local.sPL,=,"GX")
	F.Intrinsic.String.Build("Group_No = '{0}'",V.Local.sGroup,V.Local.sFilter)
	F.Data.DataView.Create("Quote","VGX",22,V.Local.sFilter,"Line_Item")
	F.Intrinsic.Control.If(V.DataView.Quote!VGX.RowCount--,<>,-1)
'		F.ODBC.Connection!Con.OpenCompanyConnection
'		F.Intrinsic.String.Build("select Description_Router from V_ROUTER_HEADER Where Router = '{0}'",V.Local.sRouterTemp.Trim,V.Local.sSql)
'		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sDesc)
'		F.Intrinsic.String.Build("select Run_Time from V_ROUTER_LINE Where Router = '{0}' and Operation = 'MAT-4'",V.Local.sRouterTemp.Trim,V.Local.sSql)
'		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRun_Time)
'		F.ODBC.Connection!Con.Close
		'open a file explorer and look for an xlsx sheet
		F.Intrinsic.UI.ShowOpenFileDialog("",".xlsx",V.Local.sFileName)
		F.Intrinsic.Control.If(V.Local.sFileName,<>,"***CANCEL***")
			F.Intrinsic.File.IsFileLocked(V.Local.sFileName,V.Local.bRet)
			F.Intrinsic.Control.If(V.Local.bRet)
				F.Intrinsic.String.Build("File :{0} is Locked. Please close and attempt again",V.Local.sFileName,V.Local.sDesc)
				F.Intrinsic.UI.Msgbox(V.Local.sDesc,"Attention")
				Gui.FormQuote.GsGridQuote.HideWait
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Automation.MSExcel.CreateAppObject("MSExcel")
			F.Automation.MSExcel.OpenWorkbook("MSEXcel","Guide Tree",V.Local.sFileName)
			F.Automation.MSExcel.OpenWorksheet("Guide Tree","Guide Sheet",1)

			'get the rows of the current spreadsheet
			F.Automation.MSExcel.RowCount("Guide Sheet",V.Local.iRet)
			
			F.Automation.MSExcel.ReadRow("Guide Sheet",10,1,38,V.local.sRow)
			F.Intrinsic.String.Split(V.Local.sRow,"*!*",V.Local.sRow)
			F.Intrinsic.Control.If(V.Local.sRow(8).Trim,<>,"")
				V.Local.iStart.Set(10)
			F.Intrinsic.Control.Else
				V.Local.iStart.Set(11)
			F.Intrinsic.Control.EndIf
			V.Local.iIndex.Set(-1)
			F.Intrinsic.Control.For(V.Local.iRow,V.Local.iStart,V.Local.iRet,1)
				F.Intrinsic.Math.Add(V.Local.iIndex,1,V.Local.iIndex)
				'reads the sequence cell within the excel spreadsheet
				F.Automation.MSExcel.ReadRow("Guide Sheet",V.Local.iRow,1,38,V.local.sRow)
				'set the local variables from the excel spreadsheet
				F.Intrinsic.String.Split(V.Local.sRow,"*!*",V.Local.sRow)
				
				F.Intrinsic.Control.If(V.Local.iIndex,<=,V.DataView.Quote!VGX.RowCount--)
					F.Intrinsic.String.TrimCharL(V.Local.sRow(15).Trim," ",V.Local.sComment)
					V.Local.sComment.Set(V.Local.sComment.Left70)
					F.Data.DataView.SetValue("Quote","VGX",V.Local.iIndex,"Unit",V.Local.sRow(9).Long,"User5",V.Local.sRow(10).Trim,"User6",V.Local.sRow(11).Trim,"User8",V.Local.sRow(13).Trim)
					F.Data.DataView.SetValue("Quote","VGX",V.Local.iIndex,"User9",V.Local.sRow(14),"User10",V.Local.sComment.Trim,"User1",V.Local.sRow(16).Trim,"User54",V.Local.sRow(19).Trim,"User55",V.Local.sRow(25).Float,"User12",V.Local.sRow(20).Trim)
					F.Data.DataView.SetValue("Quote","VGX",V.Local.iIndex,"User13",V.Local.sRow(22),"SF_EACH",V.Local.sRow(25).Float,"User48",V.Local.sRow(12).Trim,"User49",V.Local.sRow(25).Float,"Message",V.Local.sRow(18).Trim,"User2",V.Local.sRow(18).Trim)
					
'					F.Intrinsic.Control.If(V.DataView.Quote!VGX(V.Local.iIndex).Message!FieldValTrim,=,"")
'						F.Data.DataView.SetValue("Quote","VGX",V.Local.iIndex,"Message",V.Local.sDesc.Trim)
'					F.Intrinsic.Control.EndIf
'					F.Intrinsic.Control.If(V.DataView.Quote!VGX(V.Local.iIndex).User2!FieldValTrim,=,"")
'						F.Data.DataView.SetValue("Quote","VGX",V.Local.iIndex,"User2",V.Local.sDesc.Trim)
'					F.Intrinsic.Control.EndIf
'					F.Intrinsic.Control.If(V.DataView.Quote!VGX(V.Local.iIndex).User55!FieldValTrim,=,"")
'						F.Data.DataView.SetValue("Quote","VGX",V.Local.iIndex,"User55",V.Local.sRun_Time.Float)
'					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.Control.ExitFor(V.Local.iRow)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iRow)
			F.Automation.MSExcel.DestroyAllObjects("MSExcel","Guide Tree","Guide Sheet")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.Data.DataView.Close("Quote","VGX")
F.Intrinsic.Control.EndIf

Gui.FormQuote.GsGridQuote.HideWait

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Menu_Click_Update_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Menu_Click_Update.End

Program.Sub.cmdOldMat_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdOldMat_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRet.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.Intrinsic.UI.Browser(105,"",V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	Gui.FormQuote.txtOldMat.Text(V.Local.sRet.Trim)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdOldMat_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdOldMat_Click.End

Program.Sub.cmdNewMat_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdNewMat_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRet.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.Intrinsic.UI.Browser(105,"",V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	Gui.FormQuote.txtNewMat.Text(V.Local.sRet.Trim)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdNewMat_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdNewMat_Click.End

Program.Sub.cmdUpMat_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdUpMat_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sOldMat.Declare(String,"")
V.Local.sNewMat.Declare(String,"")
V.Local.fSF.Declare(Float,0)
V.Local.sFilter.Declare(String,"")

'F.Intrinsic.Control.If(V.Screen.FormQuote!txtSF.Text,<>,"")
'	V.Local.fSF.Set(V.Screen.FormQuote!txtSF.Text)
'F.Intrinsic.Control.Else
'	F.Intrinsic.UI.Msgbox("The Following needs to be filled in: Material, New Material and Sq Ft","Attention")
'	F.Intrinsic.Control.ExitSub
'F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormQuote!txtOldMat.Text,<>,"")
	V.Local.sOldMat.Set(V.Screen.FormQuote!txtOldMat.Text)
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("The Following needs to be filled in: Material, New Material and Sq Ft","Attention")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormQuote!txtNewMat.Text,<>,"")
	V.Local.sNewMat.Set(V.Screen.FormQuote!txtNewMat.Text)
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("The Following needs to be filled in: Material, New Material and Sq Ft","Attention")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

Gui.FormQuote.GsGridQuote.GetGridviewProperty("GQuote","ActiveFilterString",V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
	F.Intrinsic.String.Build("{0} and [USER48] = '{1}'",V.Local.sRet,V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("[USER48] = '{0}'",V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.EndIf

F.Data.DataView.Create("Quote","VUser48",22,V.Local.sFilter,"")

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
	F.Intrinsic.String.Build("{0} and [USER50] = '{1}'",V.Local.sRet,V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("[USER50] = '{0}'",V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.EndIf

F.Data.DataView.Create("Quote","VUser50",22,V.Local.sFilter,"")

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
	F.Intrinsic.String.Build("{0} and [USER52] = '{1}'",V.Local.sRet,V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("[USER52] = '{0}'",V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.EndIf

F.Data.DataView.Create("Quote","VUser52",22,V.Local.sFilter,"")

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
	F.Intrinsic.String.Build("{0} and [USER54] = '{1}'",V.Local.sRet,V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("[USER54] = '{0}'",V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.EndIf

F.Data.DataView.Create("Quote","VUser54",22,V.Local.sFilter,"")

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
	F.Intrinsic.String.Build("{0} and [USER56] = '{1}'",V.Local.sRet,V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("[USER56] = '{0}'",V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.EndIf

F.Data.DataView.Create("Quote","VUser56",22,V.Local.sFilter,"")

F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
	F.Intrinsic.String.Build("{0} and [USER58] = '{1}'",V.Local.sRet,V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("[USER58] = '{0}'",V.Local.sOldMat,V.Local.sFilter)
F.Intrinsic.Control.EndIf

F.Data.DataView.Create("Quote","VUser58",22,V.Local.sFilter,"")

F.Intrinsic.Control.If(V.DataView.Quote!VUser48.RowCount--,<>,-1)
'	F.Data.DataView.SetValue("Quote","VUser48",-1,"User49",V.Local.fSF,"User48",V.Local.sNewMat)
	F.Data.DataView.SetValue("Quote","VUser48",-1,"User48",V.Local.sNewMat)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataView.Quote!VUser50.RowCount--,<>,-1)
'	F.Data.DataView.SetValue("Quote","VUser50",-1,"User51",V.Local.fSF,"User50",V.Local.sNewMat)
	F.Data.DataView.SetValue("Quote","VUser50",-1,"User50",V.Local.sNewMat)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataView.Quote!VUser52.RowCount--,<>,-1)
'	F.Data.DataView.SetValue("Quote","VUser52",-1,"User53",V.Local.fSF,"User52",V.Local.sNewMat)
	F.Data.DataView.SetValue("Quote","VUser52",-1,"User52",V.Local.sNewMat)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataView.Quote!VUser54.RowCount--,<>,-1)
'	F.Data.DataView.SetValue("Quote","VUser54",-1,"User55",V.Local.fSF,"User54",V.Local.sNewMat)
	F.Data.DataView.SetValue("Quote","VUser54",-1,"User54",V.Local.sNewMat)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataView.Quote!VUser56.RowCount--,<>,-1)
'	F.Data.DataView.SetValue("Quote","VUser56",-1,"User57",V.Local.fSF,"User56",V.Local.sNewMat)
	F.Data.DataView.SetValue("Quote","VUser56",-1,"User56",V.Local.sNewMat)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataView.Quote!VUser58.RowCount--,<>,-1)
'	F.Data.DataView.SetValue("Quote","VUser58",-1,"User59",V.Local.fSF,"User58",V.Local.sNewMat)
	F.Data.DataView.SetValue("Quote","VUser58",-1,"User58",V.Local.sNewMat)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("Quote","VUser48")
F.Data.DataView.Close("Quote","VUser50")
F.Data.DataView.Close("Quote","VUser52")
F.Data.DataView.Close("Quote","VUser54")
F.Data.DataView.Close("Quote","VUser56")
F.Data.DataView.Close("Quote","VUser58")

Gui.FormQuote.txtOldMat.Text("")
Gui.FormQuote.txtNewMat.Text("")
Gui.FormQuote.txtSF.Text(0)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdUpMat_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdUpMat_Click.End

Program.Sub.txtSF_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSF_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormQuote.txtSF.SelectAll

F.Intrinsic.Control.Label("txtSF_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_Cust_Quote_Gen.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSF_GotFocus.End

Program.Sub.Menu_Click_Copy_Line.Start
F.Intrinsic.Control.SetErrorHandler("Menu_Click_Copy_Line_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRow.Declare(String,"")

Gui.FormQuote.GsGridQuote.GetSelectedRows("GQuote",V.Local.sRow)
F.Intrinsic.String.Split(V.Local.sRow,"*!*",V.Local.sRow)

V.Global.iCopyIndex.Set(V.Local.sRow.Long)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Menu_Click_Copy_Line_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Menu_Click_Copy_Line.End

Program.Sub.Menu_Click_Paste_Line.Start
F.Intrinsic.Control.SetErrorHandler("Menu_Click_Paste_Line_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRow.Declare(String,"")
V.Local.iIndex.Declare(Long,0)

Gui.FormQuote.GsGridQuote.GetSelectedRows("GQuote",V.Local.sRow)
F.Intrinsic.String.Split(V.Local.sRow,"*!*",V.Local.sRow)

V.Local.iIndex.Set(V.Local.sRow.Long)

F.Intrinsic.Control.If(V.Global.iCopyIndex,<>,-1)
	F.Intrinsic.Control.BlockEvents
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User1",V.DataTable.Quote(V.Global.iCopyIndex).User1!FieldVal,"User2",V.DataTable.Quote(V.Global.iCopyIndex).User2!FieldVal,"User3",V.DataTable.Quote(V.Global.iCopyIndex).User3!FieldVal,"User4",V.DataTable.Quote(V.Global.iCopyIndex).User4!FieldVal,"User5",V.DataTable.Quote(V.Global.iCopyIndex).User5!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User6",V.DataTable.Quote(V.Global.iCopyIndex).User6!FieldVal,"User7",V.DataTable.Quote(V.Global.iCopyIndex).User7!FieldVal,"User8",V.DataTable.Quote(V.Global.iCopyIndex).User8!FieldVal,"User9",V.DataTable.Quote(V.Global.iCopyIndex).User9!FieldVal,"User10",V.DataTable.Quote(V.Global.iCopyIndex).User10!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User11",V.DataTable.Quote(V.Global.iCopyIndex).User11!FieldVal,"User12",V.DataTable.Quote(V.Global.iCopyIndex).User12!FieldVal,"User13",V.DataTable.Quote(V.Global.iCopyIndex).User13!FieldVal,"User14",V.DataTable.Quote(V.Global.iCopyIndex).User14!FieldVal,"User15",V.DataTable.Quote(V.Global.iCopyIndex).User15!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User16",V.DataTable.Quote(V.Global.iCopyIndex).User16!FieldVal,"User17",V.DataTable.Quote(V.Global.iCopyIndex).User17!FieldVal,"User18",V.DataTable.Quote(V.Global.iCopyIndex).User18!FieldVal,"User19",V.DataTable.Quote(V.Global.iCopyIndex).User19!FieldVal,"User20",V.DataTable.Quote(V.Global.iCopyIndex).User20!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User21",V.DataTable.Quote(V.Global.iCopyIndex).User21!FieldVal,"User22",V.DataTable.Quote(V.Global.iCopyIndex).User12!FieldVal,"User23",V.DataTable.Quote(V.Global.iCopyIndex).User13!FieldVal,"User24",V.DataTable.Quote(V.Global.iCopyIndex).User24!FieldVal,"User25",V.DataTable.Quote(V.Global.iCopyIndex).User25!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User26",V.DataTable.Quote(V.Global.iCopyIndex).User26!FieldVal,"User27",V.DataTable.Quote(V.Global.iCopyIndex).User17!FieldVal,"User28",V.DataTable.Quote(V.Global.iCopyIndex).User18!FieldVal,"User29",V.DataTable.Quote(V.Global.iCopyIndex).User29!FieldVal,"User30",V.DataTable.Quote(V.Global.iCopyIndex).User30!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User31",V.DataTable.Quote(V.Global.iCopyIndex).User31!FieldVal,"User32",V.DataTable.Quote(V.Global.iCopyIndex).User32!FieldVal,"User33",V.DataTable.Quote(V.Global.iCopyIndex).User33!FieldVal,"User34",V.DataTable.Quote(V.Global.iCopyIndex).User34!FieldVal,"User35",V.DataTable.Quote(V.Global.iCopyIndex).User35!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User36",V.DataTable.Quote(V.Global.iCopyIndex).User36!FieldVal,"User37",V.DataTable.Quote(V.Global.iCopyIndex).User37!FieldVal,"User38",V.DataTable.Quote(V.Global.iCopyIndex).User38!FieldVal,"User39",V.DataTable.Quote(V.Global.iCopyIndex).User39!FieldVal,"User40",V.DataTable.Quote(V.Global.iCopyIndex).User40!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User41",V.DataTable.Quote(V.Global.iCopyIndex).User41!FieldVal,"User42",V.DataTable.Quote(V.Global.iCopyIndex).User42!FieldVal,"User43",V.DataTable.Quote(V.Global.iCopyIndex).User43!FieldVal,"User44",V.DataTable.Quote(V.Global.iCopyIndex).User44!FieldVal,"User45",V.DataTable.Quote(V.Global.iCopyIndex).User45!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User46",V.DataTable.Quote(V.Global.iCopyIndex).User46!FieldVal,"User47",V.DataTable.Quote(V.Global.iCopyIndex).User47!FieldVal,"User48",V.DataTable.Quote(V.Global.iCopyIndex).User48!FieldVal,"User49",V.DataTable.Quote(V.Global.iCopyIndex).User49!FieldVal,"User50",V.DataTable.Quote(V.Global.iCopyIndex).User50!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User51",V.DataTable.Quote(V.Global.iCopyIndex).User51!FieldVal,"User52",V.DataTable.Quote(V.Global.iCopyIndex).User52!FieldVal,"User53",V.DataTable.Quote(V.Global.iCopyIndex).User53!FieldVal,"User54",V.DataTable.Quote(V.Global.iCopyIndex).User54!FieldVal,"User55",V.DataTable.Quote(V.Global.iCopyIndex).User55!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"User56",V.DataTable.Quote(V.Global.iCopyIndex).User56!FieldVal,"User57",V.DataTable.Quote(V.Global.iCopyIndex).User57!FieldVal,"User58",V.DataTable.Quote(V.Global.iCopyIndex).User58!FieldVal,"User59",V.DataTable.Quote(V.Global.iCopyIndex).User59!FieldVal,"User60",V.DataTable.Quote(V.Global.iCopyIndex).User60!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"Unit",V.DataTable.Quote(V.Global.iCopyIndex).Unit!FieldVal,"Sign_Router",V.DataTable.Quote(V.Global.iCopyIndex).Sign_Router!FieldVal,"Message",V.DataTable.Quote(V.Global.iCopyIndex).Message!FieldVal,"UM_EACH",V.DataTable.Quote(V.Global.iCopyIndex).UM_EACH!FieldVal)
	F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"SF_Each",V.DataTable.Quote(V.Global.iCopyIndex).SF_Each!FieldVal,"SF_Price",V.DataTable.Quote(V.Global.iCopyIndex).SF_Price!FieldVal,"Project",V.DataTable.Quote(V.Global.iCopyIndex).Project!FieldVal,"Phase",V.DataTable.Quote(V.Global.iCopyIndex).Phase!FieldVal)
	F.Intrinsic.Control.UnBlockEvents
	V.Global.iCopyIndex.Set(-1)
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("Need to Copy Line before Pasting","Attention")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Menu_Click_Paste_Line_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Menu_Click_Paste_Line.End

Program.Sub.Menu_Click_UpdateFlat.Start
F.Intrinsic.Control.SetErrorHandler("Menu_Click_UpdateFlat_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sGroup.Declare(String,"")
V.Local.sFilter.Declare(String,"")
V.Local.sPL.Declare(String,"")
V.Local.iIndex.Declare(Long,0)
V.Local.iRow.Declare(Long,0)
V.Local.sRow.Declare(String,"")
V.Local.sFileName.Declare(String,"")
V.Local.iRet.Declare(Long,0)
V.Local.sRouterTemp.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sDesc.Declare(String,"")
V.Local.sRun_Time.Declare(String,"")
V.Local.sComment.Declare(String,"")
V.Local.iStart.Declare(Long,0)
V.Local.bRet.Declare(Boolean,False)

Gui.FormQuote.GsGridQuote.InvokeWait("Updating Flat Signs")

Gui.FormQuote.GsGridQuote.GetSelectedRows("GQuote",V.Local.sRow)
F.Intrinsic.String.Split(V.Local.sRow,"*!*",V.Local.sRow)
V.Local.iIndex.Set(V.Local.sRow.Long)

Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","GROUP_NO",V.Local.iIndex,V.Local.sGroup)
Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","PL",V.Local.iIndex,V.Local.sPL)
Gui.FormQuote.GsGridQuote.GetCellValueByColumnName("GQuote","SIGN_ROUTER",V.Local.iIndex,V.Local.sRouterTemp)

F.Intrinsic.Control.If(V.Local.sPL,=,"FX")
'	F.Intrinsic.String.Build("Group_No = '{0}'",V.Local.sGroup,V.Local.sFilter)
'	F.Data.DataView.Create("Quote","VGX",22,V.Local.sFilter,"Line_Item")
'	F.Intrinsic.Control.If(V.DataView.Quote!VGX.RowCount--,<>,-1)
'		F.ODBC.Connection!Con.OpenCompanyConnection
'		F.ODBC.Connection!Con.Close
		'open a file explorer and look for an xlsx sheet
		F.Intrinsic.UI.ShowOpenFileDialog("",".xlsx",V.Local.sFileName)
		F.Intrinsic.Control.If(V.Local.sFileName,<>,"***CANCEL***")
			F.Intrinsic.File.IsFileLocked(V.Local.sFileName,V.Local.bRet)
			F.Intrinsic.Control.If(V.Local.bRet)
				F.Intrinsic.String.Build("File :{0} is Locked. Please close and attempt again",V.Local.sFileName,V.Local.sDesc)
				F.Intrinsic.UI.Msgbox(V.Local.sDesc,"Attention")
				Gui.FormQuote.GsGridQuote.HideWait
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
			F.Automation.MSExcel.CreateAppObject("MSExcel")
			F.Automation.MSExcel.OpenWorkbook("MSEXcel","Flat Tree",V.Local.sFileName)
			F.Automation.MSExcel.OpenWorksheet("Flat Tree","Flat Sheet",1)

			'get the rows of the current spreadsheet
			F.Automation.MSExcel.RowCount("Flat Sheet",V.Local.iRet)

			V.Local.iStart.Set(2)
			
			F.Intrinsic.Control.For(V.Local.iRow,V.Local.iStart,V.Local.iRet,1)
				'reads the sequence cell within the excel spreadsheet
				F.Automation.MSExcel.ReadRow("Flat Sheet",V.Local.iRow,1,61,V.local.sRow)
				'set the local variables from the excel spreadsheet
				F.Intrinsic.String.Split(V.Local.sRow,"*!*",V.Local.sRow)
				
				F.Intrinsic.Control.If(V.Local.iIndex,<=,V.DataTable.Quote.RowCount--)
					F.Intrinsic.Control.If(V.DataTable.Quote(V.Local.iIndex).PL!FieldValTrim,<>,"FX")
						F.Intrinsic.Control.ExitFor(V.Local.iRow)
					F.Intrinsic.Control.EndIf
					
					F.Data.DataTable.SetValue("Quote",V.Local.iIndex,"UNIT",V.Local.sRow(0),"User1",V.Local.sRow(1).Trim,"User2",V.Local.sRow(2).Left70,"MESSAGE",V.Local.sRow(2).Trim,"User3",V.Local.sRow(3).Trim)
					F.Data.DataTable.SetValue("QUOTE",V.Local.iIndex,"User4",V.Local.sRow(4).Trim,"User5",V.Local.sRow(5).Trim,"SF_EACH",V.Local.sRow(6).Float,"User6",V.Local.sRow(7).Trim,"User7",V.Local.sRow(8).Trim)
					F.Data.DataTable.SetValue("QUOTE",V.Local.iIndex,"User8",V.Local.sRow(9).Trim,"User9",V.Local.sRow(10).Trim,"User10",V.Local.sRow(11).Trim,"User11",V.Local.sRow(12).Trim,"User12",V.Local.sRow(13).Trim)
					F.Data.DataTable.SetValue("QUOTE",V.Local.iIndex,"User13",V.Local.sRow(14).Trim,"User14",V.Local.sRow(15).Float,"User15",V.Local.sRow(16).Trim,"User16",V.Local.sRow(17).Trim,"User17",V.Local.sRow(18).Float)
					F.Data.DataTable.SetValue("QUOTE",V.Local.iIndex,"User18",V.Local.sRow(19).Trim,"User19",V.Local.sRow(20).Float,"User20",V.Local.sRow(21).Trim,"User21",V.Local.sRow(22).Float,"User22",V.Local.sRow(23).Trim)
					F.Data.DataTable.SetValue("QUOTE",V.Local.iIndex,"User23",V.Local.sRow(24).Trim,"User24",V.Local.sRow(25).Trim,"User25",V.Local.sRow(26).Trim,"User26",V.Local.sRow(27).Trim,"User27",V.Local.sRow(28).Trim)
					F.Data.DataTable.SetValue("QUOTE",V.Local.iIndex,"User28",V.Local.sRow(29).Trim,"User29",V.Local.sRow(30).Float,"User30",V.Local.sRow(31).Trim,"User31",V.Local.sRow(32).Float,"User32",V.Local.sRow(33).Trim)
					F.Data.DataTable.SetValue("QUOTE",V.Local.iIndex,"User33",V.Local.sRow(34).Float,"User34",V.Local.sRow(35).Trim,"User35",V.Local.sRow(36).Float,"User36",V.Local.sRow(37).Trim,"User37",V.Local.sRow(38).Float)
					F.Data.DataTable.SetValue("QUOTE",V.Local.iIndex,"User38",V.Local.sRow(39).Trim,"User39",V.Local.sRow(40).Float,"User40",V.Local.sRow(41).Trim,"User41",V.Local.sRow(42).Trim,"User42",V.Local.sRow(43).Trim)
					F.Data.DataTable.SetValue("QUOTE",V.Local.iIndex,"User43",V.Local.sRow(44).Trim,"User44",V.Local.sRow(45).Trim,"User45",V.Local.sRow(46).Trim,"User46",V.Local.sRow(47).Trim,"User47",V.Local.sRow(48).Trim)
					F.Data.DataTable.SetValue("QUOTE",V.Local.iIndex,"User48",V.Local.sRow(49).Trim,"User49",V.Local.sRow(50).Trim,"User50",V.Local.sRow(51).Trim,"User51",V.Local.sRow(52).Trim,"User52",V.Local.sRow(53).Trim)
					F.Data.DataTable.SetValue("QUOTE",V.Local.iIndex,"User53",V.Local.sRow(54).Trim,"User54",V.Local.sRow(55).Trim,"User55",V.Local.sRow(56).Trim,"User56",V.Local.sRow(57).Trim,"User57",V.Local.sRow(58).Trim)
					F.Data.DataTable.SetValue("QUOTE",V.Local.iIndex,"User58",V.Local.sRow(59).Trim,"User59",V.Local.sRow(60).Trim,"User60",V.Local.sRow(61).Trim)
'				F.Intrinsic.Control.If(V.Local.iIndex,<=,V.DataView.Quote!VGX.RowCount--)
'					F.Intrinsic.String.TrimCharL(V.Local.sRow(15).Trim," ",V.Local.sComment)
'					V.Local.sComment.Set(V.Local.sComment.Left70)
'					F.Data.DataView.SetValue("Quote","VGX",V.Local.iIndex,"Unit",V.Local.sRow(9).Long,"User5",V.Local.sRow(10).Trim,"User6",V.Local.sRow(11).Trim,"User8",V.Local.sRow(13).Trim)
'					F.Data.DataView.SetValue("Quote","VGX",V.Local.iIndex,"User9",V.Local.sRow(14),"User10",V.Local.sComment.Trim,"User1",V.Local.sRow(16).Trim,"User54",V.Local.sRow(19).Trim,"User55",V.Local.sRow(25).Float,"User12",V.Local.sRow(20).Trim)
'					F.Data.DataView.SetValue("Quote","VGX",V.Local.iIndex,"User13",V.Local.sRow(22),"SF_EACH",V.Local.sRow(25).Float,"User48",V.Local.sRow(12).Trim,"User49",V.Local.sRow(25).Float,"Message",V.Local.sRow(18).Trim,"User2",V.Local.sRow(18).Trim)
					
				F.Intrinsic.Control.Else
					F.Intrinsic.Control.ExitFor(V.Local.iRow)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Math.Add(V.Local.iIndex,1,V.Local.iIndex)
			F.Intrinsic.Control.Next(V.Local.iRow)
			F.Automation.MSExcel.DestroyAllObjects("MSExcel","Flat Tree","Flat Sheet")
		F.Intrinsic.Control.EndIf
'	F.Intrinsic.Control.EndIf
'	F.Data.DataView.Close("Quote","VGX")
F.Intrinsic.Control.EndIf

Gui.FormQuote.GsGridQuote.HideWait

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Menu_Click_UpdateFlat_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6419_SO_Signs.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	V.Global.bError.Set(True)
	F.Intrinsic.Control.CallSub(FormQuote_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Menu_Click_UpdateFlat.End

Program.Sub.Comments.Start
${$5$}$2.0.0.0$}$2
${$6$}$rking$}$20240208073453524$}$QNdZLVy4bWuiWa9jh1ZTiPY99LydZoBNIEL/UXkTi6YjQdHGF3BdsbLUdOE7LPvRbcDiZg77bp4=
Program.Sub.Comments.End